
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{SVM on Amazon Food Reviews}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \subsubsection{SVM on Amazon food
reviews}\label{svm-on-amazon-food-reviews}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{c+c1}{\PYZsh{}importing required Modules}
        \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
        \PY{k+kn}{import} \PY{n+nn}{sqlite3}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{nltk}
        \PY{k+kn}{import} \PY{n+nn}{string}
        \PY{k+kn}{import} \PY{n+nn}{pickle}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{TfidfTransformer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{TfidfVectorizer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{CountVectorizer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{confusion\PYZus{}matrix}
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{accuracy\PYZus{}score}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{roc\PYZus{}curve}\PY{p}{,} \PY{n}{auc}
        \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{stem}\PY{n+nn}{.}\PY{n+nn}{porter} \PY{k}{import} \PY{n}{PorterStemmer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{StandardScaler}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{TimeSeriesSplit}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{precision\PYZus{}score}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{recall\PYZus{}score}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{confusion\PYZus{}matrix}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{GridSearchCV}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{RandomizedSearchCV}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{ParameterGrid}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{svm} \PY{k}{import} \PY{n}{SVC}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{SGDClassifier}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{k+kn}{import} \PY{n+nn}{warnings}
        \PY{n}{warnings}\PY{o}{.}\PY{n}{filterwarnings}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{k}{def} \PY{n+nf}{cleanpunc}\PY{p}{(}\PY{n}{sentence}\PY{p}{)}\PY{p}{:} 
            \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
        \PY{l+s+sd}{    function to clean the word of any punctuation or special characters}
        \PY{l+s+sd}{    \PYZsq{}\PYZsq{}\PYZsq{}}
            \PY{n}{cleaned} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[?|!|}\PY{l+s+se}{\PYZbs{}\PYZsq{}}\PY{l+s+s1}{|}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{|\PYZsh{}]}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{sentence}\PY{p}{)}
            \PY{n}{cleaned} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[.|,|)|(|}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{|/]}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{cleaned}\PY{p}{)}
            \PY{k}{return}  \PY{n}{cleaned}
        \PY{k}{def} \PY{n+nf}{cleanhtml}\PY{p}{(}\PY{n}{sentence}\PY{p}{)}\PY{p}{:} 
            \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
        \PY{l+s+sd}{    function to clean the word of any html\PYZhy{}tags}
        \PY{l+s+sd}{    \PYZsq{}\PYZsq{}\PYZsq{}}
            \PY{n}{cleanr} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}.*?\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{cleantext} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{n}{cleanr}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sentence}\PY{p}{)}
            \PY{k}{return} \PY{n}{cleantext}
        \PY{k}{def} \PY{n+nf}{reduce\PYZus{}lengthening}\PY{p}{(}\PY{n}{text}\PY{p}{)}\PY{p}{:}
            \PY{n}{pattern} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{(.)}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{1}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{2,\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
            \PY{k}{return} \PY{n}{pattern}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{1}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{text}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{c+c1}{\PYZsh{}getting stop words}
        \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{corpus} \PY{k}{import} \PY{n}{stopwords}
        \PY{n}{stop} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{stopwords}\PY{o}{.}\PY{n}{words}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
        \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{not}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{very}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}from autocorrect import spell}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{conn} \PY{o}{=} \PY{n}{sqlite3}\PY{o}{.}\PY{n}{connect}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}clean\PYZus{}LR.sqlite}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{final\PYZus{}review} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}sql\PYZus{}query}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{l+s+s2}{SELECT *}
         \PY{l+s+s2}{FROM Reviews\PYZus{}final}
         \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}\PY{p}{,} \PY{n}{conn}\PY{p}{)}  
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{s} \PY{o}{=} \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n}{n}\PY{o}{=}\PY{l+m+mi}{30000}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{c+c1}{\PYZsh{}SORT by time for TBS}
         \PY{n}{s} \PY{o}{=} \PY{n}{s}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{s}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 30000 entries, 431 to 339792
Data columns (total 15 columns):
level\_0                   30000 non-null int64
index                     30000 non-null int64
Id                        30000 non-null int64
ProductId                 30000 non-null object
UserId                    30000 non-null object
ProfileName               30000 non-null object
HelpfulnessNumerator      30000 non-null int64
HelpfulnessDenominator    30000 non-null int64
Score                     30000 non-null object
Time                      30000 non-null int64
Summary                   30000 non-null object
Text                      30000 non-null object
CleanedTextBow            30000 non-null object
final\_text                30000 non-null object
final\_stem\_text           30000 non-null object
dtypes: int64(6), object(9)
memory usage: 3.7+ MB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{c+c1}{\PYZsh{}changing lables to 1 or 0}
         \PY{n}{s}\PY{o}{.}\PY{n}{Score} \PY{o}{=} \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{Score}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:}
                              \PY{l+m+mi}{1} \PY{k}{if} \PY{n}{x} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{positive}\PY{l+s+s1}{\PYZsq{}} \PY{k}{else} \PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{c+c1}{\PYZsh{}Converting to int8}
         \PY{n}{s}\PY{o}{.}\PY{n}{HelpfulnessNumerator} \PY{o}{=} \PY{n}{s}\PY{o}{.}\PY{n}{HelpfulnessNumerator}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{int8}\PY{p}{)}
         \PY{n}{s}\PY{o}{.}\PY{n}{HelpfulnessDenominator} \PY{o}{=} \PY{n}{s}\PY{o}{.}\PY{n}{HelpfulnessDenominator}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{int8}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{c+c1}{\PYZsh{}Splitting Dataframe for train and test}
         \PY{n}{train\PYZus{}df} \PY{o}{=} \PY{n}{s}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n+nb}{round}\PY{p}{(}\PY{n}{s}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{test\PYZus{}df} \PY{o}{=} \PY{n}{s}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{s}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{train\PYZus{}df\PYZus{}svm.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         \PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test\PYZus{}df\PYZus{}svm.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(21000, 15)
(9000, 15)

    \end{Verbatim}

    \subsubsection{Bag of Words:}\label{bag-of-words}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{c+c1}{\PYZsh{}BoW with cleaned data and without stopwords}
         \PY{c+c1}{\PYZsh{}simple cv for train data}
         \PY{n}{scores\PYZus{}train} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{corpus} \PY{k}{import} \PY{n}{stopwords}
         \PY{n}{stop} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{stopwords}\PY{o}{.}\PY{n}{words}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{not}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{very}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}CountVectorizer for BoW}
         \PY{n}{count\PYZus{}vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stop}\PY{p}{)}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{int8}\PY{p}{)}
         \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{X\PYZus{}test\PYZus{}cv} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{final\PYZus{}counts\PYZus{}train} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}
                 \PY{n}{X\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test}
         \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
         \PY{n}{scale} \PY{o}{=}\PY{n}{StandardScaler}\PY{p}{(}\PY{n}{with\PYZus{}mean}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         \PY{n}{X\PYZus{}train\PYZus{}scale} \PY{o}{=} \PY{n}{scale}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{)}
         \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{scale}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{ParameterGrid}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.001}\PY{p}{,} \PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}\PY{p}{,}
                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+m+mf}{0.001}\PY{p}{,} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{SVC}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rbf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{gamma}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}scale}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}scale}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C 0.001 Gamma 0.01 Train Score 0.8605306122448979 Test Score 0.8275238095238096
C 0.001 Gamma 0.001 Train Score 0.8605306122448979 Test Score 0.8275238095238096
C 0.001 Gamma 0.1 Train Score 0.8605306122448979 Test Score 0.8275238095238096
C 0.001 Gamma 1 Train Score 0.8605306122448979 Test Score 0.8275238095238096
C 0.01 Gamma 0.01 Train Score 0.8605306122448979 Test Score 0.8275238095238096
C 0.01 Gamma 0.001 Train Score 0.8605306122448979 Test Score 0.8275238095238096
C 0.01 Gamma 0.1 Train Score 0.8605306122448979 Test Score 0.8275238095238096
C 0.01 Gamma 1 Train Score 0.8605306122448979 Test Score 0.8275238095238096
C 0.1 Gamma 0.01 Train Score 0.8605306122448979 Test Score 0.8275238095238096
C 0.1 Gamma 0.001 Train Score 0.8605306122448979 Test Score 0.8275238095238096
C 0.1 Gamma 0.1 Train Score 0.8605306122448979 Test Score 0.8275238095238096
C 0.1 Gamma 1 Train Score 0.8605306122448979 Test Score 0.8275238095238096
C 1 Gamma 0.01 Train Score 0.9997959183673469 Test Score 0.8253968253968254
C 1 Gamma 0.001 Train Score 0.9951700680272109 Test Score 0.8274603174603175
C 1 Gamma 0.1 Train Score 1.0 Test Score 0.8253968253968254
C 1 Gamma 1 Train Score 1.0 Test Score 0.8253968253968254
C 10 Gamma 0.01 Train Score 1.0 Test Score 0.8253968253968254
C 10 Gamma 0.001 Train Score 1.0 Test Score 0.8312698412698413
C 10 Gamma 0.1 Train Score 1.0 Test Score 0.8253968253968254
C 10 Gamma 1 Train Score 1.0 Test Score 0.8253968253968254

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{ParameterGrid}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.2}\PY{p}{,}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mf}{0.8}\PY{p}{]}\PY{p}{,}
                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+m+mf}{0.001}\PY{p}{,} \PY{l+m+mf}{0.0001}\PY{p}{,} \PY{l+m+mf}{0.005}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{SVC}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rbf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{gamma}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}scale}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}scale}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C 0.2 Gamma 0.01 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.2 Gamma 0.001 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.2 Gamma 0.0001 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.2 Gamma 0.005 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.5 Gamma 0.01 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.5 Gamma 0.001 Train Score 0.8568707482993198 Test Score 0.8253968253968254
C 0.5 Gamma 0.0001 Train Score 0.8601360544217687 Test Score 0.8271428571428572
C 0.5 Gamma 0.005 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.8 Gamma 0.01 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.8 Gamma 0.001 Train Score 0.8745578231292517 Test Score 0.8265079365079365
C 0.8 Gamma 0.0001 Train Score 0.9240136054421769 Test Score 0.8353968253968254
C 0.8 Gamma 0.005 Train Score 0.8566666666666667 Test Score 0.8253968253968254

    \end{Verbatim}

    Observed that for high C- training data is overfitting so much. for low
c. and low values of gamma is giving somewat better scores than high.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}79}]:} \PY{n}{c} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.005}\PY{p}{,}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{l+m+mf}{0.4}\PY{p}{,}\PY{l+m+mf}{0.8}\PY{p}{,}\PY{l+m+mf}{1.2}\PY{p}{]}
         \PY{n}{gamma} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.000009}\PY{p}{,}\PY{l+m+mf}{0.0008}\PY{p}{,}\PY{l+m+mf}{0.001}\PY{p}{,}\PY{l+m+mf}{0.04}\PY{p}{,}\PY{l+m+mf}{0.2}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{]}
         \PY{n}{model\PYZus{}grid\PYZus{}bow} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stop}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                                     \PY{n}{StandardScaler}\PY{p}{(}\PY{n}{with\PYZus{}mean}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{,}\PY{n}{SVC}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                      \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{c}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{gamma}\PY{p}{\PYZcb{}}\PY{p}{,}
                                     \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}grid\PYZus{}bow}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}grid\PYZus{}bow}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}grid\PYZus{}bow}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}70}]:} \PY{c+c1}{\PYZsh{}top scores wit grid search}
         \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}70}]:}         gamma      C  Test\_score  Test\_std  Train\_score
         33   0.000800  1.200    0.845207  0.019683     0.995821
         34   0.001000  1.200    0.844159  0.020326     0.996686
         32   0.000009  1.200    0.843478  0.020834     0.883865
         25   0.000800  0.800    0.843269  0.021011     0.883656
         26   0.001000  0.800    0.842902  0.021275     0.880644
         17   0.000800  0.400    0.842378  0.021622     0.869664
         18   0.001000  0.400    0.842326  0.021650     0.869558
         0    0.000009  0.005    0.842273  0.021690     0.869488
         28   0.200000  0.800    0.842273  0.021690     0.869498
         23  15.000000  0.400    0.842273  0.021690     0.869488
         24   0.000009  0.800    0.842273  0.021703     0.871792
         27   0.040000  0.800    0.842273  0.021690     0.869498
         30  10.000000  0.800    0.842273  0.021690     0.869498
         29   5.000000  0.800    0.842273  0.021690     0.869498
         21   5.000000  0.400    0.842273  0.021690     0.869488
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}63}]:} \PY{c+c1}{\PYZsh{}RandomSearch}
         \PY{n}{model\PYZus{}random\PYZus{}bow} \PY{o}{=} \PY{n}{RandomizedSearchCV}\PY{p}{(}
                             \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stop}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                             \PY{n}{StandardScaler}\PY{p}{(}\PY{n}{with\PYZus{}mean}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{,}\PY{n}{SVC}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                             \PY{n}{param\PYZus{}distributions}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{uniform}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{l+m+mf}{0.7}\PY{p}{)}\PY{p}{,}
                                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{l+m+mf}{0.01}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{,}\PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,}
                                     \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}random\PYZus{}bow}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}66}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}random\PYZus{}bow}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}bow}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}72}]:} \PY{n}{scores\PYZus{}df1}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}72}]:}        gamma         C  Test\_score  Test\_std  Train\_score
         4   0.000415  0.473474    0.842850  0.021271     0.870966
         14  0.001121  0.545602    0.842378  0.021622     0.870091
         0   0.006791  0.237241    0.842273  0.021690     0.869488
         1   0.004997  0.257014    0.842273  0.021690     0.869488
         2   0.005213  0.182690    0.842273  0.021690     0.869488
         3   0.007353  0.527309    0.842273  0.021690     0.869498
         5   0.003778  0.325648    0.842273  0.021690     0.869488
         6   0.001744  0.498052    0.842273  0.021690     0.869552
         7   0.003124  0.151355    0.842273  0.021690     0.869488
         8   0.006712  0.141517    0.842273  0.021690     0.869488
\end{Verbatim}
            
    It seems like for high C values, it is giving somewhat better cv score
but it is overfitting so much. There is a difference of
\textgreater{}15\% in train and test scores. so found that
\texttt{gamma\ =\ 0.000800\ C\ =\ 0.400} are the better params with cv
score of \texttt{0.842378}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{c+c1}{\PYZsh{}BoW with cleaned data and without stopwords and binary}
         \PY{c+c1}{\PYZsh{}simple cv for train data}
         \PY{n}{scores\PYZus{}train} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{corpus} \PY{k}{import} \PY{n}{stopwords}
         \PY{n}{stop} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{stopwords}\PY{o}{.}\PY{n}{words}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{not}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{very}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}CountVectorizer for BoW}
         \PY{n}{count\PYZus{}vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stop}\PY{p}{)}\PY{p}{,}\PY{n}{binary}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{int8}\PY{p}{)}
         \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{X\PYZus{}test\PYZus{}cv} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{final\PYZus{}counts\PYZus{}train} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}
                 \PY{n}{X\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test}
         \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{ParameterGrid}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.4}\PY{p}{,} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}\PY{p}{,}
                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.0008}\PY{p}{,}\PY{l+m+mf}{0.005}\PY{p}{,} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{SVC}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rbf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{gamma}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C 0.4 Gamma 0.0008 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.4 Gamma 0.005 Train Score 0.8725850340136054 Test Score 0.840952380952381
C 0.4 Gamma 0.1 Train Score 0.8656462585034014 Test Score 0.8284126984126984
C 0.4 Gamma 1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.8 Gamma 0.0008 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.8 Gamma 0.005 Train Score 0.9155102040816326 Test Score 0.8819047619047619
C 0.8 Gamma 0.1 Train Score 0.9710884353741497 Test Score 0.8444444444444444
C 0.8 Gamma 1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.1 Gamma 0.0008 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.1 Gamma 0.005 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.1 Gamma 0.1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.1 Gamma 1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 1 Gamma 0.0008 Train Score 0.8570748299319728 Test Score 0.8257142857142857
C 1 Gamma 0.005 Train Score 0.9269387755102041 Test Score 0.8920634920634921
C 1 Gamma 0.1 Train Score 0.9973469387755102 Test Score 0.8485714285714285
C 1 Gamma 1 Train Score 1.0 Test Score 0.8253968253968254
C 10 Gamma 0.0008 Train Score 0.9442857142857143 Test Score 0.9082539682539682
C 10 Gamma 0.005 Train Score 0.9850340136054422 Test Score 0.92
C 10 Gamma 0.1 Train Score 1.0 Test Score 0.8571428571428571
C 10 Gamma 1 Train Score 1.0 Test Score 0.8253968253968254

    \end{Verbatim}

    Tried with binary Count vectorizer and found some interesting results
with high accuracy for gamma in range of 0.001-0.01 and and c
\textgreater{} 0.8, i am getting some high test scores for the data.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}83}]:} \PY{n}{c} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.8}\PY{p}{,}\PY{l+m+mf}{0.9}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mf}{1.5}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{]}
         \PY{n}{gamma} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.0008}\PY{p}{,}\PY{l+m+mf}{0.001}\PY{p}{,}\PY{l+m+mf}{0.003}\PY{p}{,}\PY{l+m+mf}{0.005}\PY{p}{,}\PY{l+m+mf}{0.008}\PY{p}{,}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{l+m+mf}{0.05}\PY{p}{,}\PY{l+m+mf}{0.08}\PY{p}{]}
         \PY{n}{model\PYZus{}grid\PYZus{}bow\PYZus{}binary} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stop}\PY{p}{)}\PY{p}{,}\PY{n}{binary}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{,}
                                                     \PY{n}{SVC}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                      \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{c}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{gamma}\PY{p}{\PYZcb{}}\PY{p}{,}
                                     \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}grid\PYZus{}bow\PYZus{}binary}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}85}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}grid\PYZus{}bow\PYZus{}binary}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}grid\PYZus{}bow\PYZus{}binary}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df\PYZus{}bin} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}87}]:} \PY{c+c1}{\PYZsh{}top scores}
         \PY{n}{scores\PYZus{}df\PYZus{}bin}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}87}]:}     gamma     C  Test\_score  Test\_std  Train\_score
         53  0.010   7.0    0.921215  0.005992     0.993688
         61  0.010  10.0    0.920639  0.005565     0.996447
         45  0.010   5.0    0.920377  0.006399     0.989241
         60  0.008  10.0    0.920063  0.005074     0.994219
         52  0.008   7.0    0.920010  0.005494     0.990022
         59  0.005  10.0    0.919329  0.005046     0.986794
         44  0.008   5.0    0.919068  0.006339     0.984562
         51  0.005   7.0    0.918649  0.007152     0.980237
         58  0.003  10.0    0.917444  0.007297     0.975592
         37  0.010   3.0    0.916763  0.009404     0.979108
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}99}]:} \PY{c+c1}{\PYZsh{}random search}
         \PY{n}{model\PYZus{}random\PYZus{}bow\PYZus{}binary} \PY{o}{=} \PY{n}{RandomizedSearchCV}\PY{p}{(}
                             \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stop}\PY{p}{)}\PY{p}{,}\PY{n}{binary}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{,}
                                     \PY{n}{SVC}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                          \PY{n}{param\PYZus{}distributions}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{uniform}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mf}{0.003}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{l+m+mf}{0.017}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{,}\PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,}
                                     \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}random\PYZus{}bow\PYZus{}binary}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}100}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}random\PYZus{}bow\PYZus{}binary}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
              \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
              \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
              \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
              \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}bow\PYZus{}binary}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
              \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
              \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
          \PY{n}{scores\PYZus{}df1\PYZus{}bin} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}103}]:} \PY{c+c1}{\PYZsh{}top scores}
          \PY{n}{scores\PYZus{}df1\PYZus{}bin}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}103}]:}        gamma         C  Test\_score  Test\_std  Train\_score
          9   0.012632  5.387201    0.921320  0.006144     0.994085
          7   0.010988  8.434631    0.920744  0.005843     0.996239
          18  0.013324  5.211789    0.920691  0.006230     0.994289
          13  0.015818  4.657298    0.920482  0.007147     0.995270
          0   0.008742  6.182782    0.920377  0.005578     0.989817
          6   0.015201  7.367153    0.920272  0.007147     0.997701
          2   0.017782  4.186368    0.920168  0.007176     0.995562
          14  0.006675  7.241270    0.919906  0.006305     0.987144
          1   0.018738  5.846448    0.919749  0.007964     0.997884
          15  0.015909  8.272383    0.919644  0.008027     0.998387
\end{Verbatim}
            
    Comapared to Non-binary Bag of word binary bag of words score was high
and best score found at \texttt{gamma\ =\ 0.010\ ,C\ =\ 7.0} and cv mean
score is 0.921215

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{c+c1}{\PYZsh{}test scores}
         \PY{n}{scores\PYZus{}train} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{corpus} \PY{k}{import} \PY{n}{stopwords}
         \PY{n}{stop} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{stopwords}\PY{o}{.}\PY{n}{words}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{not}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{very}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}CountVectorizer for BoW}
         \PY{n}{count\PYZus{}vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stop}\PY{p}{)}\PY{p}{,}\PY{n}{binary}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{int8}\PY{p}{)}
         \PY{n}{final\PYZus{}counts\PYZus{}train} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}
                 \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test}
         \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
         \PY{n}{model} \PY{o}{=} \PY{n}{SVC}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{l+m+mi}{7}\PY{p}{,}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rbf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{gamma}\PY{o}{=}\PY{l+m+mf}{0.010}\PY{p}{)}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Predicting training data}
         \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}predict test cv}
         \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}recall}
         \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}confusion matrix}
         \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+m+mi}{7}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mf}{0.010}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C 7 gamma 0.01
Train Score 0.9915238095238095
Test Score 0.9246666666666666
Test Precision 0.9447222953408791
Test Recall 0.9653039268423884
Test ConfusionMatrix [[1144  420]
 [ 258 7178]]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{c+c1}{\PYZsh{}no of support vectrors for each class}
         \PY{n}{model}\PY{o}{.}\PY{n}{n\PYZus{}support\PYZus{}}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}22}]:} array([2245, 3591], dtype=int32)
\end{Verbatim}
            
    SGD With BoW

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}88}]:} \PY{c+c1}{\PYZsh{}random search}
         \PY{n}{model\PYZus{}random\PYZus{}bow\PYZus{}binary} \PY{o}{=} \PY{n}{RandomizedSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}
                                       \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stop}\PY{p}{)}\PY{p}{,}\PY{n}{binary}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{,}
                                        \PY{n}{SGDClassifier}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                              \PY{n}{param\PYZus{}distributions}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}penalty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mf}{0.00001}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{l+m+mf}{0.069}\PY{p}{)}\PY{p}{,}
                                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{,}
                                                         \PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,}
                                     \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}random\PYZus{}bow\PYZus{}binary}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}89}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}random\PYZus{}bow\PYZus{}binary}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}penalty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}bow\PYZus{}binary}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df1\PYZus{}bin} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1\PYZus{}rato}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{penality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}90}]:} \PY{n}{scores\PYZus{}df1\PYZus{}bin}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}90}]:}        alpha   l1\_rato penality  Test\_score  Test\_std  Train\_score
         13  0.003570  0.912537       l2    0.915977  0.007592     0.961918
         95  0.000654  0.544642       l2    0.915872  0.006177     0.980992
         38  0.000256  0.797285       l2    0.910529  0.006600     0.983756
         46  0.007463  0.314634       l2    0.906129  0.010484     0.946527
         80  0.010533  0.760320       l2    0.901414  0.010897     0.937890
         7   0.000199  0.744540       l1    0.900681  0.006887     0.962679
         63  0.011535  0.273312       l2    0.900210  0.011199     0.935924
         56  0.012332  0.480412       l2    0.898638  0.010939     0.934297
         22  0.013868  0.611535       l2    0.893557  0.009607     0.928721
         77  0.015297  0.045345       l2    0.892981  0.011083     0.926446
\end{Verbatim}
            
    Got best mean cv at alpha = 0.003570. l1\_ratio = 0.912537 and penality
l2 and corresponding mean cv test score is 0.915977

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}93}]:} \PY{c+c1}{\PYZsh{}test scores}
         \PY{n}{scores\PYZus{}train} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{corpus} \PY{k}{import} \PY{n}{stopwords}
         \PY{n}{stop} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{stopwords}\PY{o}{.}\PY{n}{words}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{not}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{very}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}CountVectorizer for BoW}
         \PY{n}{count\PYZus{}vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stop}\PY{p}{)}\PY{p}{,}\PY{n}{binary}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{int8}\PY{p}{)}
         \PY{n}{final\PYZus{}counts\PYZus{}train} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}
                 \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test}
         \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
         \PY{n}{model} \PY{o}{=} \PY{n}{SGDClassifier}\PY{p}{(}\PY{n}{penalty}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.003570}\PY{p}{,}\PY{n}{l1\PYZus{}ratio}\PY{o}{=}\PY{l+m+mf}{0.912537}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)} \PY{c+c1}{\PYZsh{}0.003570	0.912537	l2	}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Predicting training data}
         \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}predict test cv}
         \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}recall}
         \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}confusion matrix}
         \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{With SGD Classifier penalty=}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{l2}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{,alpha=0.003570,l1\PYZus{}ratio=0.912537 }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
With SGD Classifier penalty='l2',alpha=0.003570,l1\_ratio=0.912537 
Train Score 0.9445238095238095
Test Score 0.9197777777777778
Test Precision 0.930053804765565
Test Recall 0.9763313609467456
Test ConfusionMatrix [[1018  546]
 [ 176 7260]]

    \end{Verbatim}

    \subsubsection{Tf-Idf}\label{tf-idf}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{c+c1}{\PYZsh{}TFIDF with (1,2) gram with cleaned data }
         \PY{c+c1}{\PYZsh{}simple cv for train data}
         \PY{c+c1}{\PYZsh{}tfidf vec }
         \PY{n}{tf\PYZus{}idf\PYZus{}vect} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{X\PYZus{}test\PYZus{}cv} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{final\PYZus{}counts\PYZus{}train} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}
                 \PY{n}{X\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test}
         \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{ParameterGrid}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.001}\PY{p}{,}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{,}
                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.001}\PY{p}{,}\PY{l+m+mf}{0.008}\PY{p}{,}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{p}{,}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{SVC}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rbf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{gamma}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C 0.001 Gamma 0.001 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.001 Gamma 0.008 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.001 Gamma 0.01 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.001 Gamma 0.1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.001 Gamma 0.5 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.001 Gamma 1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.001 Gamma 10 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 0.001 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 0.008 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 0.01 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 0.1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 0.5 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 10 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.1 Gamma 0.001 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.1 Gamma 0.008 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.1 Gamma 0.01 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.1 Gamma 0.1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.1 Gamma 0.5 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.1 Gamma 1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.1 Gamma 10 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 1 Gamma 0.001 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 1 Gamma 0.008 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 1 Gamma 0.01 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 1 Gamma 0.1 Train Score 0.8623129251700681 Test Score 0.8311111111111111
C 1 Gamma 0.5 Train Score 0.978843537414966 Test Score 0.9011111111111111
C 1 Gamma 1 Train Score 0.9975510204081632 Test Score 0.8942857142857142
C 1 Gamma 10 Train Score 1.0 Test Score 0.8253968253968254
C 5 Gamma 0.001 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 5 Gamma 0.008 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 5 Gamma 0.01 Train Score 0.8564625850340136 Test Score 0.8253968253968254
C 5 Gamma 0.1 Train Score 0.9954421768707483 Test Score 0.9288888888888889
C 5 Gamma 0.5 Train Score 1.0 Test Score 0.93
C 5 Gamma 1 Train Score 1.0 Test Score 0.9146031746031746
C 5 Gamma 10 Train Score 1.0 Test Score 0.8253968253968254
C 10 Gamma 0.001 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 10 Gamma 0.008 Train Score 0.8604081632653061 Test Score 0.8293650793650794
C 10 Gamma 0.01 Train Score 0.8687074829931973 Test Score 0.8380952380952381
C 10 Gamma 0.1 Train Score 0.9999319727891156 Test Score 0.9382539682539682
C 10 Gamma 0.5 Train Score 1.0 Test Score 0.93
C 10 Gamma 1 Train Score 1.0 Test Score 0.9146031746031746
C 10 Gamma 10 Train Score 1.0 Test Score 0.8253968253968254

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}66}]:} \PY{n}{c} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{,}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mf}{0.8}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{]}
         \PY{n}{gamma} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.008}\PY{p}{,}\PY{l+m+mf}{0.007}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{p}{,}\PY{l+m+mf}{0.3}\PY{p}{,}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{]}
         \PY{n}{model\PYZus{}grid\PYZus{}tfidf} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                                     \PY{n}{SVC}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                      \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{c}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{gamma}\PY{p}{\PYZcb{}}\PY{p}{,}
                                     \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}grid\PYZus{}tfidf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}67}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}grid\PYZus{}tfidf}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}grid\PYZus{}tfidf}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}71}]:} \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}71}]:}     gamma     C  Test\_score  Test\_std  Train\_score
         50    0.1  10.0    0.925982  0.013537     0.999961
         58    0.1  20.0    0.925930  0.013911     1.000000
         42    0.1   7.0    0.922263  0.014279     0.999523
         35    0.3   5.0    0.922263  0.014587     1.000000
         51    0.3  10.0    0.922211  0.014668     1.000000
         43    0.3   7.0    0.922211  0.014668     1.000000
         59    0.3  20.0    0.922211  0.014668     1.000000
         36    0.5   5.0    0.918806  0.014783     1.000000
         52    0.5  10.0    0.918806  0.014783     1.000000
         44    0.5   7.0    0.918806  0.014783     1.000000
\end{Verbatim}
            
    for high values of c model is overfitting to train data and for each c
with reasonable gamma is giving good score than low or high gamma.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{model\PYZus{}random\PYZus{}tfidf} \PY{o}{=} \PY{n}{RandomizedSearchCV}\PY{p}{(}
                               \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{SVC}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                               \PY{n}{param\PYZus{}distributions}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{,}
                                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{l+m+mf}{0.7}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{,}
                                     \PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}random\PYZus{}tfidf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}random\PYZus{}tfidf}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}tfidf}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{c+c1}{\PYZsh{}top scores with random search}
         \PY{n}{scores\PYZus{}df1}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}17}]:}        gamma          C  Test\_score  Test\_std  Train\_score
         13  0.175194   7.107109    0.924987  0.014313     1.000000
         4   0.205345   7.555669    0.924620  0.014065     1.000000
         0   0.192857   4.893355    0.923258  0.014181     0.999950
         8   0.266751   8.332227    0.923206  0.014551     1.000000
         11  0.324423   5.865958    0.922001  0.014653     1.000000
         15  0.311839  10.320605    0.921896  0.014627     1.000000
         18  0.273510   3.244258    0.921320  0.014689     0.999898
         19  0.347285   9.050680    0.921163  0.014763     1.000000
         6   0.430498  11.934278    0.920430  0.014574     1.000000
         14  0.068950   8.277344    0.919958  0.015449     0.998265
\end{Verbatim}
            
    From 10 fold cv got high mean cv at
\texttt{gamma\ \ =\ 0.175194,\ C\ =\ 7.107109} and mean cv is 0.924987

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{c+c1}{\PYZsh{}test scores}
         \PY{c+c1}{\PYZsh{}TFIDF with (1,2) gram with cleaned data }
         \PY{c+c1}{\PYZsh{}tfidf vec }
         \PY{n}{tf\PYZus{}idf\PYZus{}vect} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         \PY{n}{final\PYZus{}counts\PYZus{}train} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}
                 \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test}
         \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
         \PY{n}{model} \PY{o}{=} \PY{n}{SVC}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{l+m+mf}{7.107109}\PY{p}{,}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rbf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{gamma}\PY{o}{=}\PY{l+m+mf}{0.175194}\PY{p}{)}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Predicting training data}
         \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}predict test cv}
         \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}recall}
         \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}confusion matrix}
         \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+m+mi}{7}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mf}{0.175194}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of support vectors for each class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{model}\PY{o}{.}\PY{n}{n\PYZus{}support\PYZus{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C 7 gamma 0.175194
Train Score 1.0
Test Score 0.9415555555555556
Test Precision 0.9508089770354906
Test Recall 0.9799623453469607
Test ConfusionMatrix [[1187  377]
 [ 149 7287]]
No of support vectors for each class [2810 6720]

    \end{Verbatim}

    SGD Classifier

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{model\PYZus{}random\PYZus{}tfidf} \PY{o}{=} \PY{n}{RandomizedSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                                     \PY{n}{SGDClassifier}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                      \PY{n}{param\PYZus{}distributions}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}penalty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mf}{0.00001}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{l+m+mf}{0.069}\PY{p}{)}\PY{p}{,}
                                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{,}\PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{300}
                                                 \PY{p}{,}\PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}random\PYZus{}tfidf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}random\PYZus{}tfidf}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}penalty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}tfidf}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{penality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{scores\PYZus{}df1}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}19}]:}         alpha  l1\_ratio penality  Test\_score  Test\_std  Train\_score
         206  0.000116  0.738118       l2    0.912729  0.007599     0.983543
         263  0.000233  0.550213       l2    0.878104  0.017691     0.935960
         153  0.000264  0.305034       l2    0.870875  0.019746     0.925270
         184  0.000207  0.538170       l1    0.865008  0.015358     0.885320
         29   0.000437  0.431934       l2    0.847564  0.023918     0.886908
         268  0.000545  0.509713       l2    0.843426  0.022213     0.879669
         179  0.000690  0.546427       l2    0.842326  0.021736     0.873685
         202  0.043333  0.990595       l1    0.842273  0.021690     0.869488
         201  0.025632  0.245308       l1    0.842273  0.021690     0.869488
         200  0.016020  0.509449       l1    0.842273  0.021690     0.869488
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{ParameterGrid}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.00005}\PY{p}{,}\PY{l+m+mf}{0.00008}\PY{p}{,}\PY{l+m+mf}{0.0001}\PY{p}{,}\PY{l+m+mf}{0.00012}\PY{p}{,}\PY{l+m+mf}{0.00018}\PY{p}{,}\PY{l+m+mf}{0.00023}\PY{p}{]}\PY{p}{,}
                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mf}{0.03}\PY{p}{,}\PY{l+m+mf}{0.05}\PY{p}{,}\PY{l+m+mf}{0.08}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{p}{,}\PY{l+m+mf}{0.15}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{,}\PY{l+m+mf}{0.35}\PY{p}{,}\PY{l+m+mf}{0.45}\PY{p}{,}\PY{l+m+mf}{0.55}\PY{p}{,}\PY{l+m+mf}{0.65}\PY{p}{,}\PY{l+m+mf}{0.75}\PY{p}{,}\PY{l+m+mf}{0.85}\PY{p}{,}\PY{l+m+mf}{0.95}\PY{p}{]}\PY{p}{,}
                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{penality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{SGDClassifier}\PY{p}{(}\PY{n}{penalty}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{penality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{alpha}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{l1\PYZus{}ratio}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Penality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{penality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                   \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Alpha 5e-05 l1\_ratio 0 Penality l1 Train Score 0.9470748299319728 Test Score 0.9303174603174603
Alpha 5e-05 l1\_ratio 0 Penality l2 Train Score 0.998639455782313 Test Score 0.9344444444444444
Alpha 5e-05 l1\_ratio 0.03 Penality l1 Train Score 0.9455102040816327 Test Score 0.927936507936508
Alpha 5e-05 l1\_ratio 0.03 Penality l2 Train Score 0.9984353741496599 Test Score 0.9350793650793651
Alpha 5e-05 l1\_ratio 0.05 Penality l1 Train Score 0.9473469387755102 Test Score 0.9280952380952381
Alpha 5e-05 l1\_ratio 0.05 Penality l2 Train Score 0.9985034013605442 Test Score 0.9350793650793651
Alpha 5e-05 l1\_ratio 0.08 Penality l1 Train Score 0.9428571428571428 Test Score 0.9244444444444444
Alpha 5e-05 l1\_ratio 0.08 Penality l2 Train Score 0.998639455782313 Test Score 0.9326984126984127
Alpha 5e-05 l1\_ratio 0.1 Penality l1 Train Score 0.9444897959183673 Test Score 0.9287301587301587
Alpha 5e-05 l1\_ratio 0.1 Penality l2 Train Score 0.998639455782313 Test Score 0.9357142857142857
Alpha 5e-05 l1\_ratio 0.15 Penality l1 Train Score 0.9457142857142857 Test Score 0.9271428571428572
Alpha 5e-05 l1\_ratio 0.15 Penality l2 Train Score 0.9985714285714286 Test Score 0.933968253968254
Alpha 5e-05 l1\_ratio 0.25 Penality l1 Train Score 0.9439455782312925 Test Score 0.9246031746031746
Alpha 5e-05 l1\_ratio 0.25 Penality l2 Train Score 0.9985714285714286 Test Score 0.9355555555555556
Alpha 5e-05 l1\_ratio 0.35 Penality l1 Train Score 0.9451020408163265 Test Score 0.9257142857142857
Alpha 5e-05 l1\_ratio 0.35 Penality l2 Train Score 0.9983673469387755 Test Score 0.9328571428571428
Alpha 5e-05 l1\_ratio 0.45 Penality l1 Train Score 0.9470748299319728 Test Score 0.9284126984126985
Alpha 5e-05 l1\_ratio 0.45 Penality l2 Train Score 0.998639455782313 Test Score 0.9368253968253968
Alpha 5e-05 l1\_ratio 0.55 Penality l1 Train Score 0.9471428571428572 Test Score 0.9295238095238095
Alpha 5e-05 l1\_ratio 0.55 Penality l2 Train Score 0.998639455782313 Test Score 0.9350793650793651
Alpha 5e-05 l1\_ratio 0.65 Penality l1 Train Score 0.9452380952380952 Test Score 0.9266666666666666
Alpha 5e-05 l1\_ratio 0.65 Penality l2 Train Score 0.9983673469387755 Test Score 0.9325396825396826
Alpha 5e-05 l1\_ratio 0.75 Penality l1 Train Score 0.9455102040816327 Test Score 0.9265079365079365
Alpha 5e-05 l1\_ratio 0.75 Penality l2 Train Score 0.9984353741496599 Test Score 0.9358730158730159
Alpha 5e-05 l1\_ratio 0.85 Penality l1 Train Score 0.947687074829932 Test Score 0.9298412698412698
Alpha 5e-05 l1\_ratio 0.85 Penality l2 Train Score 0.9985034013605442 Test Score 0.9336507936507936
Alpha 5e-05 l1\_ratio 0.95 Penality l1 Train Score 0.9448979591836735 Test Score 0.9252380952380952
Alpha 5e-05 l1\_ratio 0.95 Penality l2 Train Score 0.9985714285714286 Test Score 0.936984126984127
Alpha 8e-05 l1\_ratio 0 Penality l1 Train Score 0.9295918367346939 Test Score 0.9147619047619048
Alpha 8e-05 l1\_ratio 0 Penality l2 Train Score 0.9891836734693877 Test Score 0.9268253968253968
Alpha 8e-05 l1\_ratio 0.03 Penality l1 Train Score 0.9272789115646258 Test Score 0.9141269841269841
Alpha 8e-05 l1\_ratio 0.03 Penality l2 Train Score 0.9894557823129252 Test Score 0.926984126984127
Alpha 8e-05 l1\_ratio 0.05 Penality l1 Train Score 0.9251700680272109 Test Score 0.9125396825396825
Alpha 8e-05 l1\_ratio 0.05 Penality l2 Train Score 0.9907482993197279 Test Score 0.9280952380952381
Alpha 8e-05 l1\_ratio 0.08 Penality l1 Train Score 0.9274829931972789 Test Score 0.9130158730158731
Alpha 8e-05 l1\_ratio 0.08 Penality l2 Train Score 0.9907482993197279 Test Score 0.927936507936508
Alpha 8e-05 l1\_ratio 0.1 Penality l1 Train Score 0.9248979591836735 Test Score 0.913968253968254
Alpha 8e-05 l1\_ratio 0.1 Penality l2 Train Score 0.988843537414966 Test Score 0.9247619047619048
Alpha 8e-05 l1\_ratio 0.15 Penality l1 Train Score 0.9279591836734694 Test Score 0.9128571428571428
Alpha 8e-05 l1\_ratio 0.15 Penality l2 Train Score 0.988843537414966 Test Score 0.9255555555555556
Alpha 8e-05 l1\_ratio 0.25 Penality l1 Train Score 0.9262585034013605 Test Score 0.9096825396825396
Alpha 8e-05 l1\_ratio 0.25 Penality l2 Train Score 0.9885034013605443 Test Score 0.9266666666666666
Alpha 8e-05 l1\_ratio 0.35 Penality l1 Train Score 0.9283673469387755 Test Score 0.9153968253968254
Alpha 8e-05 l1\_ratio 0.35 Penality l2 Train Score 0.9893877551020408 Test Score 0.926031746031746
Alpha 8e-05 l1\_ratio 0.45 Penality l1 Train Score 0.9261224489795918 Test Score 0.9114285714285715
Alpha 8e-05 l1\_ratio 0.45 Penality l2 Train Score 0.9889795918367347 Test Score 0.9247619047619048
Alpha 8e-05 l1\_ratio 0.55 Penality l1 Train Score 0.9268027210884354 Test Score 0.9123809523809524
Alpha 8e-05 l1\_ratio 0.55 Penality l2 Train Score 0.9903401360544217 Test Score 0.9285714285714286
Alpha 8e-05 l1\_ratio 0.65 Penality l1 Train Score 0.9248979591836735 Test Score 0.9084126984126984
Alpha 8e-05 l1\_ratio 0.65 Penality l2 Train Score 0.9908163265306122 Test Score 0.9293650793650794
Alpha 8e-05 l1\_ratio 0.75 Penality l1 Train Score 0.9285034013605442 Test Score 0.9136507936507936
Alpha 8e-05 l1\_ratio 0.75 Penality l2 Train Score 0.9907482993197279 Test Score 0.9287301587301587
Alpha 8e-05 l1\_ratio 0.85 Penality l1 Train Score 0.926734693877551 Test Score 0.9125396825396825
Alpha 8e-05 l1\_ratio 0.85 Penality l2 Train Score 0.9890476190476191 Test Score 0.9249206349206349
Alpha 8e-05 l1\_ratio 0.95 Penality l1 Train Score 0.9276190476190476 Test Score 0.9119047619047619
Alpha 8e-05 l1\_ratio 0.95 Penality l2 Train Score 0.991156462585034 Test Score 0.93
Alpha 0.0001 l1\_ratio 0 Penality l1 Train Score 0.9206122448979592 Test Score 0.9082539682539682
Alpha 0.0001 l1\_ratio 0 Penality l2 Train Score 0.976326530612245 Test Score 0.9174603174603174
Alpha 0.0001 l1\_ratio 0.03 Penality l1 Train Score 0.9180272108843538 Test Score 0.9038095238095238
Alpha 0.0001 l1\_ratio 0.03 Penality l2 Train Score 0.9778231292517007 Test Score 0.9179365079365079
Alpha 0.0001 l1\_ratio 0.05 Penality l1 Train Score 0.9162585034013605 Test Score 0.9028571428571428
Alpha 0.0001 l1\_ratio 0.05 Penality l2 Train Score 0.9795918367346939 Test Score 0.9193650793650794
Alpha 0.0001 l1\_ratio 0.08 Penality l1 Train Score 0.9176190476190477 Test Score 0.9042857142857142
Alpha 0.0001 l1\_ratio 0.08 Penality l2 Train Score 0.9795918367346939 Test Score 0.9206349206349206
Alpha 0.0001 l1\_ratio 0.1 Penality l1 Train Score 0.9201360544217687 Test Score 0.9066666666666666
Alpha 0.0001 l1\_ratio 0.1 Penality l2 Train Score 0.9780952380952381 Test Score 0.9193650793650794
Alpha 0.0001 l1\_ratio 0.15 Penality l1 Train Score 0.9177551020408163 Test Score 0.9052380952380953
Alpha 0.0001 l1\_ratio 0.15 Penality l2 Train Score 0.9774149659863945 Test Score 0.9184126984126985
Alpha 0.0001 l1\_ratio 0.25 Penality l1 Train Score 0.916530612244898 Test Score 0.902063492063492
Alpha 0.0001 l1\_ratio 0.25 Penality l2 Train Score 0.9759183673469388 Test Score 0.9161904761904762
Alpha 0.0001 l1\_ratio 0.35 Penality l1 Train Score 0.9171428571428571 Test Score 0.905079365079365
Alpha 0.0001 l1\_ratio 0.35 Penality l2 Train Score 0.9795238095238096 Test Score 0.9215873015873016
Alpha 0.0001 l1\_ratio 0.45 Penality l1 Train Score 0.917687074829932 Test Score 0.9047619047619048
Alpha 0.0001 l1\_ratio 0.45 Penality l2 Train Score 0.9797959183673469 Test Score 0.9207936507936508
Alpha 0.0001 l1\_ratio 0.55 Penality l1 Train Score 0.9180952380952381 Test Score 0.9047619047619048
Alpha 0.0001 l1\_ratio 0.55 Penality l2 Train Score 0.98 Test Score 0.9203174603174603
Alpha 0.0001 l1\_ratio 0.65 Penality l1 Train Score 0.9184353741496598 Test Score 0.9055555555555556
Alpha 0.0001 l1\_ratio 0.65 Penality l2 Train Score 0.9772789115646259 Test Score 0.916984126984127
Alpha 0.0001 l1\_ratio 0.75 Penality l1 Train Score 0.9205442176870748 Test Score 0.9071428571428571
Alpha 0.0001 l1\_ratio 0.75 Penality l2 Train Score 0.9800680272108844 Test Score 0.922063492063492
Alpha 0.0001 l1\_ratio 0.85 Penality l1 Train Score 0.9163945578231293 Test Score 0.9012698412698412
Alpha 0.0001 l1\_ratio 0.85 Penality l2 Train Score 0.9791836734693877 Test Score 0.9214285714285714
Alpha 0.0001 l1\_ratio 0.95 Penality l1 Train Score 0.9194557823129251 Test Score 0.9061904761904762
Alpha 0.0001 l1\_ratio 0.95 Penality l2 Train Score 0.9761224489795919 Test Score 0.9180952380952381
Alpha 0.00012 l1\_ratio 0 Penality l1 Train Score 0.9089795918367347 Test Score 0.8968253968253969
Alpha 0.00012 l1\_ratio 0 Penality l2 Train Score 0.9679591836734693 Test Score 0.9117460317460317
Alpha 0.00012 l1\_ratio 0.03 Penality l1 Train Score 0.9079591836734694 Test Score 0.8942857142857142
Alpha 0.00012 l1\_ratio 0.03 Penality l2 Train Score 0.9718367346938775 Test Score 0.913968253968254
Alpha 0.00012 l1\_ratio 0.05 Penality l1 Train Score 0.9091156462585034 Test Score 0.896984126984127
Alpha 0.00012 l1\_ratio 0.05 Penality l2 Train Score 0.9671428571428572 Test Score 0.9101587301587302
Alpha 0.00012 l1\_ratio 0.08 Penality l1 Train Score 0.9091836734693878 Test Score 0.8949206349206349
Alpha 0.00012 l1\_ratio 0.08 Penality l2 Train Score 0.9682312925170068 Test Score 0.912063492063492
Alpha 0.00012 l1\_ratio 0.1 Penality l1 Train Score 0.9068707482993197 Test Score 0.8947619047619048
Alpha 0.00012 l1\_ratio 0.1 Penality l2 Train Score 0.9696598639455782 Test Score 0.9123809523809524
Alpha 0.00012 l1\_ratio 0.15 Penality l1 Train Score 0.9097278911564626 Test Score 0.8973015873015873
Alpha 0.00012 l1\_ratio 0.15 Penality l2 Train Score 0.9698639455782313 Test Score 0.9144444444444444
Alpha 0.00012 l1\_ratio 0.25 Penality l1 Train Score 0.9082993197278911 Test Score 0.895079365079365
Alpha 0.00012 l1\_ratio 0.25 Penality l2 Train Score 0.9674829931972789 Test Score 0.9119047619047619
Alpha 0.00012 l1\_ratio 0.35 Penality l1 Train Score 0.9074829931972789 Test Score 0.8949206349206349
Alpha 0.00012 l1\_ratio 0.35 Penality l2 Train Score 0.969047619047619 Test Score 0.9122222222222223
Alpha 0.00012 l1\_ratio 0.45 Penality l1 Train Score 0.9074829931972789 Test Score 0.8947619047619048
Alpha 0.00012 l1\_ratio 0.45 Penality l2 Train Score 0.9695238095238096 Test Score 0.9131746031746032
Alpha 0.00012 l1\_ratio 0.55 Penality l1 Train Score 0.9112925170068027 Test Score 0.8987301587301587
Alpha 0.00012 l1\_ratio 0.55 Penality l2 Train Score 0.9710884353741497 Test Score 0.9125396825396825
Alpha 0.00012 l1\_ratio 0.65 Penality l1 Train Score 0.9098639455782312 Test Score 0.8979365079365079
Alpha 0.00012 l1\_ratio 0.65 Penality l2 Train Score 0.968843537414966 Test Score 0.9117460317460317
Alpha 0.00012 l1\_ratio 0.75 Penality l1 Train Score 0.9104081632653062 Test Score 0.8977777777777778
Alpha 0.00012 l1\_ratio 0.75 Penality l2 Train Score 0.9705442176870749 Test Score 0.9144444444444444
Alpha 0.00012 l1\_ratio 0.85 Penality l1 Train Score 0.9074149659863946 Test Score 0.895079365079365
Alpha 0.00012 l1\_ratio 0.85 Penality l2 Train Score 0.9674149659863945 Test Score 0.9111111111111111
Alpha 0.00012 l1\_ratio 0.95 Penality l1 Train Score 0.9091836734693878 Test Score 0.8965079365079365
Alpha 0.00012 l1\_ratio 0.95 Penality l2 Train Score 0.9676190476190476 Test Score 0.9114285714285715
Alpha 0.00018 l1\_ratio 0 Penality l1 Train Score 0.8865306122448979 Test Score 0.8715873015873016
Alpha 0.00018 l1\_ratio 0 Penality l2 Train Score 0.9310884353741496 Test Score 0.8846031746031746
Alpha 0.00018 l1\_ratio 0.03 Penality l1 Train Score 0.8848979591836734 Test Score 0.8677777777777778
Alpha 0.00018 l1\_ratio 0.03 Penality l2 Train Score 0.937891156462585 Test Score 0.8911111111111111
Alpha 0.00018 l1\_ratio 0.05 Penality l1 Train Score 0.8859183673469387 Test Score 0.8695238095238095
Alpha 0.00018 l1\_ratio 0.05 Penality l2 Train Score 0.9338095238095238 Test Score 0.8876190476190476
Alpha 0.00018 l1\_ratio 0.08 Penality l1 Train Score 0.8852380952380953 Test Score 0.8690476190476191
Alpha 0.00018 l1\_ratio 0.08 Penality l2 Train Score 0.9357823129251701 Test Score 0.8888888888888888
Alpha 0.00018 l1\_ratio 0.1 Penality l1 Train Score 0.8846938775510204 Test Score 0.8684126984126984
Alpha 0.00018 l1\_ratio 0.1 Penality l2 Train Score 0.9347619047619048 Test Score 0.888095238095238
Alpha 0.00018 l1\_ratio 0.15 Penality l1 Train Score 0.8858503401360545 Test Score 0.8707936507936508
Alpha 0.00018 l1\_ratio 0.15 Penality l2 Train Score 0.9362585034013605 Test Score 0.8911111111111111
Alpha 0.00018 l1\_ratio 0.25 Penality l1 Train Score 0.8900680272108844 Test Score 0.8741269841269841
Alpha 0.00018 l1\_ratio 0.25 Penality l2 Train Score 0.932312925170068 Test Score 0.8857142857142857
Alpha 0.00018 l1\_ratio 0.35 Penality l1 Train Score 0.8859863945578231 Test Score 0.8703174603174603
Alpha 0.00018 l1\_ratio 0.35 Penality l2 Train Score 0.9297278911564626 Test Score 0.8838095238095238
Alpha 0.00018 l1\_ratio 0.45 Penality l1 Train Score 0.8850340136054422 Test Score 0.8679365079365079
Alpha 0.00018 l1\_ratio 0.45 Penality l2 Train Score 0.9336734693877551 Test Score 0.888095238095238
Alpha 0.00018 l1\_ratio 0.55 Penality l1 Train Score 0.886734693877551 Test Score 0.871904761904762
Alpha 0.00018 l1\_ratio 0.55 Penality l2 Train Score 0.936734693877551 Test Score 0.8904761904761904
Alpha 0.00018 l1\_ratio 0.65 Penality l1 Train Score 0.8866666666666667 Test Score 0.8711111111111111
Alpha 0.00018 l1\_ratio 0.65 Penality l2 Train Score 0.9308843537414966 Test Score 0.8849206349206349
Alpha 0.00018 l1\_ratio 0.75 Penality l1 Train Score 0.8862585034013606 Test Score 0.8698412698412699
Alpha 0.00018 l1\_ratio 0.75 Penality l2 Train Score 0.934625850340136 Test Score 0.8884126984126984
Alpha 0.00018 l1\_ratio 0.85 Penality l1 Train Score 0.8873469387755102 Test Score 0.8707936507936508
Alpha 0.00018 l1\_ratio 0.85 Penality l2 Train Score 0.9358503401360544 Test Score 0.89
Alpha 0.00018 l1\_ratio 0.95 Penality l1 Train Score 0.886734693877551 Test Score 0.8715873015873016
Alpha 0.00018 l1\_ratio 0.95 Penality l2 Train Score 0.9342176870748299 Test Score 0.8879365079365079
Alpha 0.00023 l1\_ratio 0 Penality l1 Train Score 0.872312925170068 Test Score 0.8519047619047619
Alpha 0.00023 l1\_ratio 0 Penality l2 Train Score 0.9082993197278911 Test Score 0.8690476190476191
Alpha 0.00023 l1\_ratio 0.03 Penality l1 Train Score 0.8717006802721089 Test Score 0.8496825396825397
Alpha 0.00023 l1\_ratio 0.03 Penality l2 Train Score 0.9046258503401361 Test Score 0.8663492063492063
Alpha 0.00023 l1\_ratio 0.05 Penality l1 Train Score 0.8714965986394558 Test Score 0.8496825396825397
Alpha 0.00023 l1\_ratio 0.05 Penality l2 Train Score 0.9078231292517007 Test Score 0.8684126984126984
Alpha 0.00023 l1\_ratio 0.08 Penality l1 Train Score 0.8709523809523809 Test Score 0.8509523809523809
Alpha 0.00023 l1\_ratio 0.08 Penality l2 Train Score 0.9056462585034014 Test Score 0.8665079365079366
Alpha 0.00023 l1\_ratio 0.1 Penality l1 Train Score 0.867482993197279 Test Score 0.8452380952380952
Alpha 0.00023 l1\_ratio 0.1 Penality l2 Train Score 0.9051020408163265 Test Score 0.8668253968253968
Alpha 0.00023 l1\_ratio 0.15 Penality l1 Train Score 0.8693197278911564 Test Score 0.8471428571428572
Alpha 0.00023 l1\_ratio 0.15 Penality l2 Train Score 0.9060544217687074 Test Score 0.8673015873015874
Alpha 0.00023 l1\_ratio 0.25 Penality l1 Train Score 0.8701360544217687 Test Score 0.8471428571428572
Alpha 0.00023 l1\_ratio 0.25 Penality l2 Train Score 0.9053061224489796 Test Score 0.8668253968253968
Alpha 0.00023 l1\_ratio 0.35 Penality l1 Train Score 0.8735374149659864 Test Score 0.8526984126984127
Alpha 0.00023 l1\_ratio 0.35 Penality l2 Train Score 0.906734693877551 Test Score 0.8680952380952381
Alpha 0.00023 l1\_ratio 0.45 Penality l1 Train Score 0.8731972789115646 Test Score 0.8522222222222222
Alpha 0.00023 l1\_ratio 0.45 Penality l2 Train Score 0.9056462585034014 Test Score 0.8666666666666667
Alpha 0.00023 l1\_ratio 0.55 Penality l1 Train Score 0.8721088435374149 Test Score 0.8514285714285714
Alpha 0.00023 l1\_ratio 0.55 Penality l2 Train Score 0.9038095238095238 Test Score 0.8652380952380953
Alpha 0.00023 l1\_ratio 0.65 Penality l1 Train Score 0.8682312925170068 Test Score 0.8476190476190476
Alpha 0.00023 l1\_ratio 0.65 Penality l2 Train Score 0.904421768707483 Test Score 0.8661904761904762
Alpha 0.00023 l1\_ratio 0.75 Penality l1 Train Score 0.8731292517006802 Test Score 0.8533333333333334
Alpha 0.00023 l1\_ratio 0.75 Penality l2 Train Score 0.9059183673469388 Test Score 0.8665079365079366
Alpha 0.00023 l1\_ratio 0.85 Penality l1 Train Score 0.871156462585034 Test Score 0.8492063492063492
Alpha 0.00023 l1\_ratio 0.85 Penality l2 Train Score 0.9070068027210885 Test Score 0.8673015873015874
Alpha 0.00023 l1\_ratio 0.95 Penality l1 Train Score 0.8695918367346939 Test Score 0.849047619047619
Alpha 0.00023 l1\_ratio 0.95 Penality l2 Train Score 0.9082312925170068 Test Score 0.8695238095238095

    \end{Verbatim}

    In Random search i didnt got some results wit high l1 ratio and l2
peanality so i dicided to try some low l1 ratios wit same learning rate
range and l1 penality. i sisnt get this case in random search. so did
some initial investigation above and got some good scores without
varince problem also.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}69}]:} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}penalty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.00003}\PY{p}{,}\PY{l+m+mf}{0.00005}\PY{p}{,}\PY{l+m+mf}{0.00007}\PY{p}{,}\PY{l+m+mf}{0.00008}\PY{p}{,}\PY{l+m+mf}{0.0001}\PY{p}{,}
                                    \PY{l+m+mf}{0.00012}\PY{p}{,}\PY{l+m+mf}{0.00018}\PY{p}{,}\PY{l+m+mf}{0.00023}\PY{p}{]}\PY{p}{,}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mf}{0.03}\PY{p}{,}\PY{l+m+mf}{0.05}\PY{p}{,}\PY{l+m+mf}{0.08}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{p}{,}\PY{l+m+mf}{0.15}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{,}\PY{l+m+mf}{0.35}\PY{p}{,}\PY{l+m+mf}{0.45}\PY{p}{,}
                                    \PY{l+m+mf}{0.55}\PY{p}{,}\PY{l+m+mf}{0.65}\PY{p}{,}\PY{l+m+mf}{0.75}\PY{p}{,}\PY{l+m+mf}{0.85}\PY{p}{,}\PY{l+m+mf}{0.95}\PY{p}{]}
                             \PY{p}{\PYZcb{}}
         \PY{n}{model\PYZus{}grid\PYZus{}tfidf} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                                     \PY{n}{SGDClassifier}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                         \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,}\PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}grid\PYZus{}tfidf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}70}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}grid\PYZus{}tfidf}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}penalty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}grid\PYZus{}tfidf}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{penality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}72}]:} \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}72}]:}       alpha  l1\_ratio penality  Test\_score  Test\_std  Train\_score
         10  0.00003      0.15       l1    0.929282  0.008460     0.976729
         0   0.00003      0.00       l1    0.929178  0.010054     0.976633
         2   0.00003      0.03       l1    0.929125  0.010393     0.976605
         4   0.00003      0.05       l1    0.929073  0.008819     0.976753
         12  0.00003      0.25       l1    0.928968  0.008937     0.976537
         8   0.00003      0.10       l1    0.928968  0.007552     0.976478
         6   0.00003      0.08       l1    0.928916  0.008576     0.976547
         16  0.00003      0.45       l1    0.928759  0.008902     0.976561
         18  0.00003      0.55       l1    0.928654  0.008387     0.976760
         24  0.00003      0.85       l1    0.928444  0.007099     0.977262
\end{Verbatim}
            
    Got best scores at alpha = 0.00003, l1\_ratio = 0.15, penalty = l1 and
mean cv score is 0.929282

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}88}]:} \PY{c+c1}{\PYZsh{}test scores}
         \PY{c+c1}{\PYZsh{}TFIDF with (1,2) gram with cleaned data }
         \PY{c+c1}{\PYZsh{}tfidf vec }
         \PY{n}{tf\PYZus{}idf\PYZus{}vect} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         \PY{n}{final\PYZus{}counts\PYZus{}train} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}
                 \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test}
         \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
         \PY{n}{model} \PY{o}{=} \PY{n}{SGDClassifier}\PY{p}{(}\PY{n}{penalty}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.00003}\PY{p}{,}\PY{n}{l1\PYZus{}ratio}\PY{o}{=}\PY{l+m+mf}{0.15}\PY{p}{)}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Predicting training data}
         \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}predict test cv}
         \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}recall}
         \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}confusion matrix}
         \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{penalty=}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{l1}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{,alpha=0.00003,l1\PYZus{}ratio=0.15}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
penalty='l1',alpha=0.00003,l1\_ratio=0.15
Train Score 0.9569047619047619
Test Score 0.9355555555555556
Test Precision 0.9517659462308908
Test Recall 0.9712210866057019
Test ConfusionMatrix [[1198  366]
 [ 214 7222]]

    \end{Verbatim}

    \subsubsection{Word2Vec}\label{word2vec}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{c+c1}{\PYZsh{}importing}
         \PY{k+kn}{from} \PY{n+nn}{gensim}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Word2Vec}
         \PY{k+kn}{from} \PY{n+nn}{gensim}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{KeyedVectors}
         \PY{k+kn}{import} \PY{n+nn}{pickle}
         \PY{k+kn}{import} \PY{n+nn}{gensim}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{k+kn}{import} \PY{n+nn}{gensim}
         \PY{n}{list\PYZus{}of\PYZus{}sent}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{o}{.}\PY{n}{values}\PY{p}{:}
             \PY{n}{list\PYZus{}of\PYZus{}sent}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{c+c1}{\PYZsh{}word2vec model with 50 dim vector}
         \PY{n}{w2v\PYZus{}model\PYZus{}50}\PY{o}{=}\PY{n}{gensim}\PY{o}{.}\PY{n}{models}\PY{o}{.}\PY{n}{Word2Vec}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{,}\PY{n}{min\PYZus{}count}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{50}\PY{p}{,} \PY{n}{workers}\PY{o}{=}\PY{l+m+mi}{8}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}word2vec model with 100 dim vector}
         \PY{n}{w2v\PYZus{}model\PYZus{}100}\PY{o}{=}\PY{n}{gensim}\PY{o}{.}\PY{n}{models}\PY{o}{.}\PY{n}{Word2Vec}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{,}\PY{n}{min\PYZus{}count}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{workers}\PY{o}{=}\PY{l+m+mi}{8}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}word2vec model with 300 dim vector}
         \PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{o}{=}\PY{n}{gensim}\PY{o}{.}\PY{n}{models}\PY{o}{.}\PY{n}{Word2Vec}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{,}\PY{n}{min\PYZus{}count}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{,} \PY{n}{workers}\PY{o}{=}\PY{l+m+mi}{8}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{c+c1}{\PYZsh{}saving to disk}
         \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}50}\PY{p}{,}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w2v\PYZus{}model\PYZus{}svm\PYZus{}50.p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}100}\PY{p}{,}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w2v\PYZus{}model\PYZus{}svm\PYZus{}100.p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{,}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w2v\PYZus{}model\PYZus{}svm\PYZus{}300.p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{c+c1}{\PYZsh{}loading from disk}
         \PY{n}{w2v\PYZus{}model\PYZus{}100} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w2v\PYZus{}model\PYZus{}svm\PYZus{}100.p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{w2v\PYZus{}model\PYZus{}50} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w2v\PYZus{}model\PYZus{}svm\PYZus{}50.p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{w2v\PYZus{}model\PYZus{}300} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w2v\PYZus{}model\PYZus{}svm\PYZus{}300.p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \paragraph{Avg Word2Vec}\label{avg-word2vec}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{c+c1}{\PYZsh{} the avg\PYZhy{}w2v for each sentence/review is stored in this list}
         \PY{k}{def} \PY{n+nf}{avg\PYZus{}w2v}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{,}\PY{n}{model}\PY{p}{,}\PY{n}{d}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
         \PY{l+s+sd}{    Returns average of word vectors for }
         \PY{l+s+sd}{    each sentance with dimension of model given}
         \PY{l+s+sd}{    \PYZsq{}\PYZsq{}\PYZsq{}}
             \PY{n}{sent\PYZus{}vectors} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{:} \PY{c+c1}{\PYZsh{} for each review/sentence}
                 \PY{n}{doc} \PY{o}{=} \PY{p}{[}\PY{n}{word} \PY{k}{for} \PY{n}{word} \PY{o+ow}{in} \PY{n}{sent} \PY{k}{if} \PY{n}{word} \PY{o+ow}{in} \PY{n}{model}\PY{o}{.}\PY{n}{wv}\PY{o}{.}\PY{n}{vocab}\PY{p}{]}
                 \PY{k}{if} \PY{n}{doc}\PY{p}{:}
                     \PY{n}{sent\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{wv}\PY{p}{[}\PY{n}{doc}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{sent\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{d}\PY{p}{)}
                 \PY{n}{sent\PYZus{}vectors}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent\PYZus{}vec}\PY{p}{)}
             \PY{k}{return} \PY{n}{sent\PYZus{}vectors}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{o}{.}\PY{n}{values}\PY{p}{:}
             \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{c+c1}{\PYZsh{}avg word2vec for }
         \PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{avg\PYZus{}w2v}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{p}{,}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}stacking columns}
         \PY{n}{train\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}
                     \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{column} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}\PY{p}{)}
         \PY{n}{column}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{train\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{n}{column}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{c+c1}{\PYZsh{}CountVectorizer for BoW}
         \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{X\PYZus{}test\PYZus{}cv} \PY{o}{=} \PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{scale} \PY{o}{=} \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}
         \PY{n}{X\PYZus{}train\PYZus{}sc} \PY{o}{=} \PY{n}{scale}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{n}{X\PYZus{}test\PYZus{}cv\PYZus{}sc} \PY{o}{=} \PY{n}{scale}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{ParameterGrid}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.001}\PY{p}{,}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{,}
                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.001}\PY{p}{,}\PY{l+m+mf}{0.008}\PY{p}{,}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{p}{,}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{SVC}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rbf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{gamma}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}sc}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}sc}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv\PYZus{}sc}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C 0.001 Gamma 0.001 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.001 Gamma 0.008 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.001 Gamma 0.01 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.001 Gamma 0.1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.001 Gamma 0.5 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.001 Gamma 1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.001 Gamma 10 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 0.001 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 0.008 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 0.01 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 0.1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 0.5 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 10 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.1 Gamma 0.001 Train Score 0.9078231292517007 Test Score 0.8917460317460317
C 0.1 Gamma 0.008 Train Score 0.8776190476190476 Test Score 0.8468253968253968
C 0.1 Gamma 0.01 Train Score 0.8648299319727891 Test Score 0.8352380952380952
C 0.1 Gamma 0.1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.1 Gamma 0.5 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.1 Gamma 1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.1 Gamma 10 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 1 Gamma 0.001 Train Score 0.9448299319727891 Test Score 0.9274603174603174
C 1 Gamma 0.008 Train Score 0.98578231292517 Test Score 0.9068253968253969
C 1 Gamma 0.01 Train Score 0.9902721088435374 Test Score 0.8960317460317461
C 1 Gamma 0.1 Train Score 1.0 Test Score 0.8253968253968254
C 1 Gamma 0.5 Train Score 1.0 Test Score 0.8253968253968254
C 1 Gamma 1 Train Score 1.0 Test Score 0.8253968253968254
C 1 Gamma 10 Train Score 1.0 Test Score 0.8253968253968254
C 5 Gamma 0.001 Train Score 0.9637414965986395 Test Score 0.936031746031746
C 5 Gamma 0.008 Train Score 1.0 Test Score 0.9119047619047619
C 5 Gamma 0.01 Train Score 1.0 Test Score 0.9014285714285715
C 5 Gamma 0.1 Train Score 1.0 Test Score 0.8253968253968254
C 5 Gamma 0.5 Train Score 1.0 Test Score 0.8253968253968254
C 5 Gamma 1 Train Score 1.0 Test Score 0.8253968253968254
C 5 Gamma 10 Train Score 1.0 Test Score 0.8253968253968254

    \end{Verbatim}

    We can observe that for low values of c we ave ig bias in model and for
high values of c we are overfitting to the train data. and for some
values of gamma(0.001) and C(1-10) the cv score are better than the
others. we do have some generalization error if we are regularizing max
also so my be with moderate High C wit low gamma be better for this
data.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300\PYZus{}svm.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{n}{c} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.8}\PY{p}{,}\PY{l+m+mf}{0.9}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mf}{1.5}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{]}
         \PY{n}{gamma} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.0005}\PY{p}{,}\PY{l+m+mf}{0.0008}\PY{p}{,}\PY{l+m+mf}{0.00095}\PY{p}{,}\PY{l+m+mf}{0.001}\PY{p}{,}\PY{l+m+mf}{0.003}\PY{p}{,}\PY{l+m+mf}{0.005}\PY{p}{,}\PY{l+m+mf}{0.008}\PY{p}{]}
         \PY{n}{model\PYZus{}grid\PYZus{}avgw2v} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{p}{,}
                                                     \PY{n}{SVC}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                     \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{c}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{gamma}\PY{p}{\PYZcb{}}\PY{p}{,}
                                 \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}grid\PYZus{}avgw2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}grid\PYZus{}avgw2v}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}grid\PYZus{}avgw2v}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}41}]:}       gamma     C  Test\_score  Test\_std  Train\_score
         52  0.00100  10.0    0.933630  0.006818     0.978743
         51  0.00095  10.0    0.933578  0.006756     0.977413
         50  0.00080  10.0    0.932897  0.006800     0.973149
         45  0.00100   7.0    0.932216  0.006664     0.973193
         43  0.00080   7.0    0.932006  0.007466     0.968160
         44  0.00095   7.0    0.931797  0.007015     0.971904
         38  0.00100   5.0    0.931797  0.007716     0.968227
         37  0.00095   5.0    0.931744  0.007464     0.967187
         49  0.00050  10.0    0.931640  0.006226     0.962913
         39  0.00300   5.0    0.931535  0.004997     0.993881
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}50}]:} \PY{n}{c} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{70}\PY{p}{,}\PY{l+m+mi}{80}\PY{p}{,}\PY{l+m+mi}{90}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{]}
         \PY{n}{gamma} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.00095}\PY{p}{,}\PY{l+m+mf}{0.001}\PY{p}{]}
         \PY{n}{model\PYZus{}grid\PYZus{}avgw2v2} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{p}{,}
                                                     \PY{n}{SVC}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                      \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{c}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{gamma}\PY{p}{\PYZcb{}}\PY{p}{,}
                                     \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}grid\PYZus{}avgw2v2}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}51}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}grid\PYZus{}avgw2v2}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}grid\PYZus{}avgw2v2}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df2} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{n}{scores\PYZus{}df2}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}53}]:}      gamma   C  Test\_score  Test\_std  Train\_score
         1  0.00100  10    0.933630  0.006818     0.978743
         0  0.00095  10    0.933578  0.006756     0.977413
         3  0.00100  20    0.932111  0.006485     0.987762
         2  0.00095  20    0.931640  0.007013     0.986663
         5  0.00100  30    0.931221  0.006858     0.992037
         4  0.00095  30    0.931116  0.006455     0.991255
         6  0.00095  40    0.930906  0.006735     0.993642
         7  0.00100  40    0.930592  0.007110     0.994460
         8  0.00095  50    0.930016  0.007068     0.995593
         9  0.00100  50    0.929387  0.006629     0.996349
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}76}]:} \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{uniform}
         \PY{n}{model\PYZus{}random\PYZus{}avgw2v} \PY{o}{=} \PY{n}{RandomizedSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{SVC}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                              \PY{n}{param\PYZus{}distributions}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{uniform}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{l+m+mi}{13}\PY{p}{)}\PY{p}{,}
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mf}{0.0008}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{l+m+mf}{0.004}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{,}\PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{,}
                                     \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}random\PYZus{}avgw2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}77}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}random\PYZus{}avgw2v}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}avgw2v}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}78}]:} \PY{n}{scores\PYZus{}df1}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}78}]:}        gamma          C  Test\_score  Test\_std  Train\_score
         0   0.001337   7.135116    0.932792  0.006643     0.980713
         21  0.001729   6.847431    0.932740  0.006190     0.986392
         5   0.001961   4.655458    0.932635  0.006548     0.983589
         19  0.001799   6.445765    0.932583  0.006304     0.986443
         22  0.001156  12.931930    0.932478  0.006379     0.985614
         13  0.001583  10.511907    0.932373  0.006640     0.990104
         1   0.002504   3.154084    0.932216  0.006163     0.983583
         12  0.002473   5.143757    0.932163  0.006208     0.990524
         18  0.001417  12.460012    0.932111  0.006425     0.989660
         16  0.002093   2.559956    0.931954  0.006908     0.975369
\end{Verbatim}
            
    Best cv score for 10 fold cv got at
\texttt{gamma\ =\ 0.00100,\ C\ =\ 10} and mean cv score is
\texttt{0.933630}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}82}]:} \PY{c+c1}{\PYZsh{}testscore}
         \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{o}{.}\PY{n}{values}\PY{p}{:}
             \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}avg word2vec for }
         \PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{avg\PYZus{}w2v}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{p}{,}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}stacking columns}
         \PY{n}{train\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}
                     \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{column} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}\PY{p}{)}
         \PY{n}{column}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{train\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{n}{column}\PY{p}{)}
         
         
         \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}test}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{o}{.}\PY{n}{values}\PY{p}{:}
             \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}test}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}avg word2vec for }
         \PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300\PYZus{}test} \PY{o}{=} \PY{n}{avg\PYZus{}w2v}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}test}\PY{p}{,}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}stacking columns}
         \PY{n}{test\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300\PYZus{}test}\PY{p}{,}
                     \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{column} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}\PY{p}{)}
         \PY{n}{column}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{test\PYZus{}df\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{test\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{n}{column}\PY{p}{)}
         
         
         \PY{n}{scale} \PY{o}{=} \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}
         \PY{n}{X\PYZus{}train\PYZus{}sc} \PY{o}{=} \PY{n}{scale}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{n}{X\PYZus{}test\PYZus{}cv\PYZus{}sc} \PY{o}{=} \PY{n}{scale}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         
         
         \PY{n}{model} \PY{o}{=} \PY{n}{SVC}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rbf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{gamma}\PY{o}{=}\PY{l+m+mf}{0.00100}\PY{p}{)}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}sc}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Predicting training data}
         \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}sc}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}predict test cv}
         \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv\PYZus{}sc}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}recall}
         \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}confusion matrix}
         \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mf}{0.00100}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of support vectors for each class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{model}\PY{o}{.}\PY{n}{n\PYZus{}support\PYZus{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C 10 gamma 0.001
Train Score 0.9725714285714285
Test Score 0.9332222222222222
Test Precision 0.9459741615555266
Test Recall 0.9748520710059172
Test ConfusionMatrix [[1150  414]
 [ 187 7249]]
No of support vectors for each class [1693 2078]

    \end{Verbatim}

    \subparagraph{SGD Classifier}\label{sgd-classifier}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{ParameterGrid}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.00005}\PY{p}{,}\PY{l+m+mf}{0.00008}\PY{p}{,}\PY{l+m+mf}{0.0001}\PY{p}{,}\PY{l+m+mf}{0.00012}\PY{p}{]}\PY{p}{,}
                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mf}{0.03}\PY{p}{,}\PY{l+m+mf}{0.05}\PY{p}{,}\PY{l+m+mf}{0.08}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{p}{,}\PY{l+m+mf}{0.15}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{,}\PY{l+m+mf}{0.35}\PY{p}{,}
                                            \PY{l+m+mf}{0.45}\PY{p}{,}\PY{l+m+mf}{0.55}\PY{p}{,}\PY{l+m+mf}{0.65}\PY{p}{,}\PY{l+m+mf}{0.75}\PY{p}{,}\PY{l+m+mf}{0.85}\PY{p}{,}\PY{l+m+mf}{0.95}\PY{p}{]}\PY{p}{,}
                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{penality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{elasticnet}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{SGDClassifier}\PY{p}{(}\PY{n}{penalty}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{penality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{alpha}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{l1\PYZus{}ratio}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}sc}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}sc}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv\PYZus{}sc}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Penality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{penality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                   \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Alpha 5e-05 l1\_ratio 0 Penality l1 Train Score 0.9415646258503402 Test Score 0.9293650793650794
Alpha 5e-05 l1\_ratio 0 Penality l2 Train Score 0.9393197278911565 Test Score 0.927936507936508
Alpha 5e-05 l1\_ratio 0 Penality elasticnet Train Score 0.9393197278911565 Test Score 0.927936507936508
Alpha 5e-05 l1\_ratio 0.03 Penality l1 Train Score 0.9415646258503402 Test Score 0.9293650793650794
Alpha 5e-05 l1\_ratio 0.03 Penality l2 Train Score 0.9393197278911565 Test Score 0.927936507936508
Alpha 5e-05 l1\_ratio 0.03 Penality elasticnet Train Score 0.9377551020408164 Test Score 0.9250793650793651
Alpha 5e-05 l1\_ratio 0.05 Penality l1 Train Score 0.9415646258503402 Test Score 0.9293650793650794
Alpha 5e-05 l1\_ratio 0.05 Penality l2 Train Score 0.9393197278911565 Test Score 0.927936507936508
Alpha 5e-05 l1\_ratio 0.05 Penality elasticnet Train Score 0.9386394557823129 Test Score 0.9258730158730158
Alpha 5e-05 l1\_ratio 0.08 Penality l1 Train Score 0.9415646258503402 Test Score 0.9293650793650794
Alpha 5e-05 l1\_ratio 0.08 Penality l2 Train Score 0.9393197278911565 Test Score 0.927936507936508
Alpha 5e-05 l1\_ratio 0.08 Penality elasticnet Train Score 0.9385034013605442 Test Score 0.9255555555555556
Alpha 5e-05 l1\_ratio 0.1 Penality l1 Train Score 0.9415646258503402 Test Score 0.9293650793650794
Alpha 5e-05 l1\_ratio 0.1 Penality l2 Train Score 0.9393197278911565 Test Score 0.927936507936508
Alpha 5e-05 l1\_ratio 0.1 Penality elasticnet Train Score 0.9387074829931973 Test Score 0.9277777777777778
Alpha 5e-05 l1\_ratio 0.15 Penality l1 Train Score 0.9415646258503402 Test Score 0.9293650793650794
Alpha 5e-05 l1\_ratio 0.15 Penality l2 Train Score 0.9393197278911565 Test Score 0.927936507936508
Alpha 5e-05 l1\_ratio 0.15 Penality elasticnet Train Score 0.9374829931972789 Test Score 0.9230158730158731
Alpha 5e-05 l1\_ratio 0.25 Penality l1 Train Score 0.9415646258503402 Test Score 0.9293650793650794
Alpha 5e-05 l1\_ratio 0.25 Penality l2 Train Score 0.9393197278911565 Test Score 0.927936507936508
Alpha 5e-05 l1\_ratio 0.25 Penality elasticnet Train Score 0.939047619047619 Test Score 0.9261904761904762
Alpha 5e-05 l1\_ratio 0.35 Penality l1 Train Score 0.9415646258503402 Test Score 0.9293650793650794
Alpha 5e-05 l1\_ratio 0.35 Penality l2 Train Score 0.9393197278911565 Test Score 0.927936507936508
Alpha 5e-05 l1\_ratio 0.35 Penality elasticnet Train Score 0.9387074829931973 Test Score 0.9265079365079365
Alpha 5e-05 l1\_ratio 0.45 Penality l1 Train Score 0.9415646258503402 Test Score 0.9293650793650794
Alpha 5e-05 l1\_ratio 0.45 Penality l2 Train Score 0.9393197278911565 Test Score 0.927936507936508
Alpha 5e-05 l1\_ratio 0.45 Penality elasticnet Train Score 0.9392517006802721 Test Score 0.9273015873015873
Alpha 5e-05 l1\_ratio 0.55 Penality l1 Train Score 0.9415646258503402 Test Score 0.9293650793650794
Alpha 5e-05 l1\_ratio 0.55 Penality l2 Train Score 0.9393197278911565 Test Score 0.927936507936508
Alpha 5e-05 l1\_ratio 0.55 Penality elasticnet Train Score 0.941156462585034 Test Score 0.9298412698412698
Alpha 5e-05 l1\_ratio 0.65 Penality l1 Train Score 0.9415646258503402 Test Score 0.9293650793650794
Alpha 5e-05 l1\_ratio 0.65 Penality l2 Train Score 0.9393197278911565 Test Score 0.927936507936508
Alpha 5e-05 l1\_ratio 0.65 Penality elasticnet Train Score 0.9406802721088435 Test Score 0.9263492063492064
Alpha 5e-05 l1\_ratio 0.75 Penality l1 Train Score 0.9415646258503402 Test Score 0.9293650793650794
Alpha 5e-05 l1\_ratio 0.75 Penality l2 Train Score 0.9393197278911565 Test Score 0.927936507936508
Alpha 5e-05 l1\_ratio 0.75 Penality elasticnet Train Score 0.9422448979591836 Test Score 0.9292063492063493
Alpha 5e-05 l1\_ratio 0.85 Penality l1 Train Score 0.9415646258503402 Test Score 0.9293650793650794
Alpha 5e-05 l1\_ratio 0.85 Penality l2 Train Score 0.9393197278911565 Test Score 0.927936507936508
Alpha 5e-05 l1\_ratio 0.85 Penality elasticnet Train Score 0.9417006802721088 Test Score 0.929047619047619
Alpha 5e-05 l1\_ratio 0.95 Penality l1 Train Score 0.9415646258503402 Test Score 0.9293650793650794
Alpha 5e-05 l1\_ratio 0.95 Penality l2 Train Score 0.9393197278911565 Test Score 0.927936507936508
Alpha 5e-05 l1\_ratio 0.95 Penality elasticnet Train Score 0.943469387755102 Test Score 0.9274603174603174
Alpha 8e-05 l1\_ratio 0 Penality l1 Train Score 0.9438095238095238 Test Score 0.9285714285714286
Alpha 8e-05 l1\_ratio 0 Penality l2 Train Score 0.9384353741496598 Test Score 0.9246031746031746
Alpha 8e-05 l1\_ratio 0 Penality elasticnet Train Score 0.9384353741496598 Test Score 0.9246031746031746
Alpha 8e-05 l1\_ratio 0.03 Penality l1 Train Score 0.9438095238095238 Test Score 0.9285714285714286
Alpha 8e-05 l1\_ratio 0.03 Penality l2 Train Score 0.9384353741496598 Test Score 0.9246031746031746
Alpha 8e-05 l1\_ratio 0.03 Penality elasticnet Train Score 0.937687074829932 Test Score 0.9236507936507936
Alpha 8e-05 l1\_ratio 0.05 Penality l1 Train Score 0.9438095238095238 Test Score 0.9285714285714286
Alpha 8e-05 l1\_ratio 0.05 Penality l2 Train Score 0.9384353741496598 Test Score 0.9246031746031746
Alpha 8e-05 l1\_ratio 0.05 Penality elasticnet Train Score 0.9385034013605442 Test Score 0.9246031746031746
Alpha 8e-05 l1\_ratio 0.08 Penality l1 Train Score 0.9438095238095238 Test Score 0.9285714285714286
Alpha 8e-05 l1\_ratio 0.08 Penality l2 Train Score 0.9384353741496598 Test Score 0.9246031746031746
Alpha 8e-05 l1\_ratio 0.08 Penality elasticnet Train Score 0.9373469387755102 Test Score 0.9233333333333333
Alpha 8e-05 l1\_ratio 0.1 Penality l1 Train Score 0.9438095238095238 Test Score 0.9285714285714286
Alpha 8e-05 l1\_ratio 0.1 Penality l2 Train Score 0.9384353741496598 Test Score 0.9246031746031746
Alpha 8e-05 l1\_ratio 0.1 Penality elasticnet Train Score 0.9389115646258503 Test Score 0.923968253968254
Alpha 8e-05 l1\_ratio 0.15 Penality l1 Train Score 0.9438095238095238 Test Score 0.9285714285714286
Alpha 8e-05 l1\_ratio 0.15 Penality l2 Train Score 0.9384353741496598 Test Score 0.9246031746031746
Alpha 8e-05 l1\_ratio 0.15 Penality elasticnet Train Score 0.9386394557823129 Test Score 0.923968253968254
Alpha 8e-05 l1\_ratio 0.25 Penality l1 Train Score 0.9438095238095238 Test Score 0.9285714285714286
Alpha 8e-05 l1\_ratio 0.25 Penality l2 Train Score 0.9384353741496598 Test Score 0.9246031746031746
Alpha 8e-05 l1\_ratio 0.25 Penality elasticnet Train Score 0.939047619047619 Test Score 0.9257142857142857
Alpha 8e-05 l1\_ratio 0.35 Penality l1 Train Score 0.9438095238095238 Test Score 0.9285714285714286
Alpha 8e-05 l1\_ratio 0.35 Penality l2 Train Score 0.9384353741496598 Test Score 0.9246031746031746
Alpha 8e-05 l1\_ratio 0.35 Penality elasticnet Train Score 0.9385714285714286 Test Score 0.9255555555555556
Alpha 8e-05 l1\_ratio 0.45 Penality l1 Train Score 0.9438095238095238 Test Score 0.9285714285714286
Alpha 8e-05 l1\_ratio 0.45 Penality l2 Train Score 0.9384353741496598 Test Score 0.9246031746031746
Alpha 8e-05 l1\_ratio 0.45 Penality elasticnet Train Score 0.9403401360544218 Test Score 0.9265079365079365
Alpha 8e-05 l1\_ratio 0.55 Penality l1 Train Score 0.9438095238095238 Test Score 0.9285714285714286
Alpha 8e-05 l1\_ratio 0.55 Penality l2 Train Score 0.9384353741496598 Test Score 0.9246031746031746
Alpha 8e-05 l1\_ratio 0.55 Penality elasticnet Train Score 0.9396598639455782 Test Score 0.926984126984127
Alpha 8e-05 l1\_ratio 0.65 Penality l1 Train Score 0.9438095238095238 Test Score 0.9285714285714286
Alpha 8e-05 l1\_ratio 0.65 Penality l2 Train Score 0.9384353741496598 Test Score 0.9246031746031746
Alpha 8e-05 l1\_ratio 0.65 Penality elasticnet Train Score 0.9417006802721088 Test Score 0.9280952380952381
Alpha 8e-05 l1\_ratio 0.75 Penality l1 Train Score 0.9438095238095238 Test Score 0.9285714285714286
Alpha 8e-05 l1\_ratio 0.75 Penality l2 Train Score 0.9384353741496598 Test Score 0.9246031746031746
Alpha 8e-05 l1\_ratio 0.75 Penality elasticnet Train Score 0.9415646258503402 Test Score 0.929047619047619
Alpha 8e-05 l1\_ratio 0.85 Penality l1 Train Score 0.9438095238095238 Test Score 0.9285714285714286
Alpha 8e-05 l1\_ratio 0.85 Penality l2 Train Score 0.9384353741496598 Test Score 0.9246031746031746
Alpha 8e-05 l1\_ratio 0.85 Penality elasticnet Train Score 0.9398639455782313 Test Score 0.9280952380952381
Alpha 8e-05 l1\_ratio 0.95 Penality l1 Train Score 0.9438095238095238 Test Score 0.9285714285714286
Alpha 8e-05 l1\_ratio 0.95 Penality l2 Train Score 0.9384353741496598 Test Score 0.9246031746031746
Alpha 8e-05 l1\_ratio 0.95 Penality elasticnet Train Score 0.9425850340136055 Test Score 0.9273015873015873
Alpha 0.0001 l1\_ratio 0 Penality l1 Train Score 0.9437414965986395 Test Score 0.927936507936508
Alpha 0.0001 l1\_ratio 0 Penality l2 Train Score 0.9366666666666666 Test Score 0.9228571428571428
Alpha 0.0001 l1\_ratio 0 Penality elasticnet Train Score 0.9366666666666666 Test Score 0.9228571428571428
Alpha 0.0001 l1\_ratio 0.03 Penality l1 Train Score 0.9437414965986395 Test Score 0.927936507936508
Alpha 0.0001 l1\_ratio 0.03 Penality l2 Train Score 0.9366666666666666 Test Score 0.9228571428571428
Alpha 0.0001 l1\_ratio 0.03 Penality elasticnet Train Score 0.9374829931972789 Test Score 0.9223809523809524
Alpha 0.0001 l1\_ratio 0.05 Penality l1 Train Score 0.9437414965986395 Test Score 0.927936507936508
Alpha 0.0001 l1\_ratio 0.05 Penality l2 Train Score 0.9366666666666666 Test Score 0.9228571428571428
Alpha 0.0001 l1\_ratio 0.05 Penality elasticnet Train Score 0.9378231292517006 Test Score 0.9241269841269841
Alpha 0.0001 l1\_ratio 0.08 Penality l1 Train Score 0.9437414965986395 Test Score 0.927936507936508
Alpha 0.0001 l1\_ratio 0.08 Penality l2 Train Score 0.9366666666666666 Test Score 0.9228571428571428
Alpha 0.0001 l1\_ratio 0.08 Penality elasticnet Train Score 0.9373469387755102 Test Score 0.9233333333333333
Alpha 0.0001 l1\_ratio 0.1 Penality l1 Train Score 0.9437414965986395 Test Score 0.927936507936508
Alpha 0.0001 l1\_ratio 0.1 Penality l2 Train Score 0.9366666666666666 Test Score 0.9228571428571428
Alpha 0.0001 l1\_ratio 0.1 Penality elasticnet Train Score 0.9380272108843537 Test Score 0.9236507936507936
Alpha 0.0001 l1\_ratio 0.15 Penality l1 Train Score 0.9437414965986395 Test Score 0.927936507936508
Alpha 0.0001 l1\_ratio 0.15 Penality l2 Train Score 0.9366666666666666 Test Score 0.9228571428571428
Alpha 0.0001 l1\_ratio 0.15 Penality elasticnet Train Score 0.9380272108843537 Test Score 0.9238095238095239
Alpha 0.0001 l1\_ratio 0.25 Penality l1 Train Score 0.9437414965986395 Test Score 0.927936507936508
Alpha 0.0001 l1\_ratio 0.25 Penality l2 Train Score 0.9366666666666666 Test Score 0.9228571428571428
Alpha 0.0001 l1\_ratio 0.25 Penality elasticnet Train Score 0.9382993197278912 Test Score 0.9242857142857143
Alpha 0.0001 l1\_ratio 0.35 Penality l1 Train Score 0.9437414965986395 Test Score 0.927936507936508
Alpha 0.0001 l1\_ratio 0.35 Penality l2 Train Score 0.9366666666666666 Test Score 0.9228571428571428
Alpha 0.0001 l1\_ratio 0.35 Penality elasticnet Train Score 0.9391836734693878 Test Score 0.9238095238095239
Alpha 0.0001 l1\_ratio 0.45 Penality l1 Train Score 0.9437414965986395 Test Score 0.927936507936508
Alpha 0.0001 l1\_ratio 0.45 Penality l2 Train Score 0.9366666666666666 Test Score 0.9228571428571428
Alpha 0.0001 l1\_ratio 0.45 Penality elasticnet Train Score 0.940204081632653 Test Score 0.9255555555555556
Alpha 0.0001 l1\_ratio 0.55 Penality l1 Train Score 0.9437414965986395 Test Score 0.927936507936508
Alpha 0.0001 l1\_ratio 0.55 Penality l2 Train Score 0.9366666666666666 Test Score 0.9228571428571428
Alpha 0.0001 l1\_ratio 0.55 Penality elasticnet Train Score 0.9401360544217687 Test Score 0.9274603174603174
Alpha 0.0001 l1\_ratio 0.65 Penality l1 Train Score 0.9437414965986395 Test Score 0.927936507936508
Alpha 0.0001 l1\_ratio 0.65 Penality l2 Train Score 0.9366666666666666 Test Score 0.9228571428571428
Alpha 0.0001 l1\_ratio 0.65 Penality elasticnet Train Score 0.9406802721088435 Test Score 0.926984126984127
Alpha 0.0001 l1\_ratio 0.75 Penality l1 Train Score 0.9437414965986395 Test Score 0.927936507936508
Alpha 0.0001 l1\_ratio 0.75 Penality l2 Train Score 0.9366666666666666 Test Score 0.9228571428571428
Alpha 0.0001 l1\_ratio 0.75 Penality elasticnet Train Score 0.9400680272108843 Test Score 0.927936507936508
Alpha 0.0001 l1\_ratio 0.85 Penality l1 Train Score 0.9437414965986395 Test Score 0.927936507936508
Alpha 0.0001 l1\_ratio 0.85 Penality l2 Train Score 0.9366666666666666 Test Score 0.9228571428571428
Alpha 0.0001 l1\_ratio 0.85 Penality elasticnet Train Score 0.9415646258503402 Test Score 0.927936507936508
Alpha 0.0001 l1\_ratio 0.95 Penality l1 Train Score 0.9437414965986395 Test Score 0.927936507936508
Alpha 0.0001 l1\_ratio 0.95 Penality l2 Train Score 0.9366666666666666 Test Score 0.9228571428571428
Alpha 0.0001 l1\_ratio 0.95 Penality elasticnet Train Score 0.9410884353741497 Test Score 0.9266666666666666
Alpha 0.00012 l1\_ratio 0 Penality l1 Train Score 0.9426530612244898 Test Score 0.9273015873015873
Alpha 0.00012 l1\_ratio 0 Penality l2 Train Score 0.9385714285714286 Test Score 0.923968253968254
Alpha 0.00012 l1\_ratio 0 Penality elasticnet Train Score 0.9385714285714286 Test Score 0.923968253968254
Alpha 0.00012 l1\_ratio 0.03 Penality l1 Train Score 0.9426530612244898 Test Score 0.9273015873015873
Alpha 0.00012 l1\_ratio 0.03 Penality l2 Train Score 0.9385714285714286 Test Score 0.923968253968254
Alpha 0.00012 l1\_ratio 0.03 Penality elasticnet Train Score 0.9372789115646258 Test Score 0.9225396825396825
Alpha 0.00012 l1\_ratio 0.05 Penality l1 Train Score 0.9426530612244898 Test Score 0.9273015873015873
Alpha 0.00012 l1\_ratio 0.05 Penality l2 Train Score 0.9385714285714286 Test Score 0.923968253968254
Alpha 0.00012 l1\_ratio 0.05 Penality elasticnet Train Score 0.9374149659863945 Test Score 0.9222222222222223
Alpha 0.00012 l1\_ratio 0.08 Penality l1 Train Score 0.9426530612244898 Test Score 0.9273015873015873
Alpha 0.00012 l1\_ratio 0.08 Penality l2 Train Score 0.9385714285714286 Test Score 0.923968253968254
Alpha 0.00012 l1\_ratio 0.08 Penality elasticnet Train Score 0.9379591836734694 Test Score 0.9234920634920635
Alpha 0.00012 l1\_ratio 0.1 Penality l1 Train Score 0.9426530612244898 Test Score 0.9273015873015873
Alpha 0.00012 l1\_ratio 0.1 Penality l2 Train Score 0.9385714285714286 Test Score 0.923968253968254
Alpha 0.00012 l1\_ratio 0.1 Penality elasticnet Train Score 0.9379591836734694 Test Score 0.9231746031746032
Alpha 0.00012 l1\_ratio 0.15 Penality l1 Train Score 0.9426530612244898 Test Score 0.9273015873015873
Alpha 0.00012 l1\_ratio 0.15 Penality l2 Train Score 0.9385714285714286 Test Score 0.923968253968254
Alpha 0.00012 l1\_ratio 0.15 Penality elasticnet Train Score 0.9386394557823129 Test Score 0.9231746031746032
Alpha 0.00012 l1\_ratio 0.25 Penality l1 Train Score 0.9426530612244898 Test Score 0.9273015873015873
Alpha 0.00012 l1\_ratio 0.25 Penality l2 Train Score 0.9385714285714286 Test Score 0.923968253968254
Alpha 0.00012 l1\_ratio 0.25 Penality elasticnet Train Score 0.9379591836734694 Test Score 0.923968253968254
Alpha 0.00012 l1\_ratio 0.35 Penality l1 Train Score 0.9426530612244898 Test Score 0.9273015873015873
Alpha 0.00012 l1\_ratio 0.35 Penality l2 Train Score 0.9385714285714286 Test Score 0.923968253968254
Alpha 0.00012 l1\_ratio 0.35 Penality elasticnet Train Score 0.9382993197278912 Test Score 0.9242857142857143
Alpha 0.00012 l1\_ratio 0.45 Penality l1 Train Score 0.9426530612244898 Test Score 0.9273015873015873
Alpha 0.00012 l1\_ratio 0.45 Penality l2 Train Score 0.9385714285714286 Test Score 0.923968253968254
Alpha 0.00012 l1\_ratio 0.45 Penality elasticnet Train Score 0.9382993197278912 Test Score 0.9253968253968254
Alpha 0.00012 l1\_ratio 0.55 Penality l1 Train Score 0.9426530612244898 Test Score 0.9273015873015873
Alpha 0.00012 l1\_ratio 0.55 Penality l2 Train Score 0.9385714285714286 Test Score 0.923968253968254
Alpha 0.00012 l1\_ratio 0.55 Penality elasticnet Train Score 0.9393197278911565 Test Score 0.9263492063492064
Alpha 0.00012 l1\_ratio 0.65 Penality l1 Train Score 0.9426530612244898 Test Score 0.9273015873015873
Alpha 0.00012 l1\_ratio 0.65 Penality l2 Train Score 0.9385714285714286 Test Score 0.923968253968254
Alpha 0.00012 l1\_ratio 0.65 Penality elasticnet Train Score 0.9402721088435374 Test Score 0.9276190476190476
Alpha 0.00012 l1\_ratio 0.75 Penality l1 Train Score 0.9426530612244898 Test Score 0.9273015873015873
Alpha 0.00012 l1\_ratio 0.75 Penality l2 Train Score 0.9385714285714286 Test Score 0.923968253968254
Alpha 0.00012 l1\_ratio 0.75 Penality elasticnet Train Score 0.9406122448979591 Test Score 0.9280952380952381
Alpha 0.00012 l1\_ratio 0.85 Penality l1 Train Score 0.9426530612244898 Test Score 0.9273015873015873
Alpha 0.00012 l1\_ratio 0.85 Penality l2 Train Score 0.9385714285714286 Test Score 0.923968253968254
Alpha 0.00012 l1\_ratio 0.85 Penality elasticnet Train Score 0.9415646258503402 Test Score 0.9261904761904762
Alpha 0.00012 l1\_ratio 0.95 Penality l1 Train Score 0.9426530612244898 Test Score 0.9273015873015873
Alpha 0.00012 l1\_ratio 0.95 Penality l2 Train Score 0.9385714285714286 Test Score 0.923968253968254
Alpha 0.00012 l1\_ratio 0.95 Penality elasticnet Train Score 0.9427210884353742 Test Score 0.9282539682539682

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}penalty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{elasticnet}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.00003}\PY{p}{,}\PY{l+m+mf}{0.00005}\PY{p}{,}\PY{l+m+mf}{0.00007}\PY{p}{,}\PY{l+m+mf}{0.00008}\PY{p}{,}\PY{l+m+mf}{0.0001}\PY{p}{,}
                                             \PY{l+m+mf}{0.00012}\PY{p}{,}\PY{l+m+mf}{0.00018}\PY{p}{,}\PY{l+m+mf}{0.00023}\PY{p}{]}\PY{p}{,}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mf}{0.03}\PY{p}{,}\PY{l+m+mf}{0.05}\PY{p}{,}\PY{l+m+mf}{0.08}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{p}{,}\PY{l+m+mf}{0.15}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{,}\PY{l+m+mf}{0.35}\PY{p}{,}
                                        \PY{l+m+mf}{0.45}\PY{p}{,}\PY{l+m+mf}{0.55}\PY{p}{,}\PY{l+m+mf}{0.65}\PY{p}{,}\PY{l+m+mf}{0.75}\PY{p}{,}\PY{l+m+mf}{0.85}\PY{p}{,}\PY{l+m+mf}{0.95}\PY{p}{]}\PY{p}{\PYZcb{}}
         \PY{n}{model\PYZus{}grid\PYZus{}avgw2v} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{p}{,}
                                                 \PY{n}{SGDClassifier}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                                    \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,}
                                          \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}
                                                               \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}grid\PYZus{}avgw2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}grid\PYZus{}avgw2v}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}penalty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}grid\PYZus{}avgw2v}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{penalty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}49}]:}        alpha  l1\_ratio     penalty  Test\_score  Test\_std  Train\_score
         228  0.00012      0.25          l1    0.925406  0.005465     0.949701
         231  0.00012      0.35          l1    0.925354  0.008048     0.949089
         251  0.00012      0.95  elasticnet    0.925039  0.007527     0.948532
         213  0.00012      0.03          l1    0.924987  0.006550     0.948186
         66   0.00005      0.45          l1    0.924935  0.005871     0.949894
         234  0.00012      0.45          l1    0.924830  0.006851     0.948310
         186  0.00010      0.25          l1    0.924725  0.006626     0.948830
         138  0.00008      0.10          l1    0.924673  0.004765     0.950189
         177  0.00010      0.08          l1    0.924515  0.005506     0.948358
         79   0.00005      0.85          l2    0.924463  0.005463     0.943389
\end{Verbatim}
            
    Got best cv mean score at alpha = 0.00012,l1\_ratio= 0.25 penlty = l1
and mean cv score is 0.925406

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}68}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{With SGD}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}testscore}
         \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{o}{.}\PY{n}{values}\PY{p}{:}
             \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}avg word2vec for }
         \PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{avg\PYZus{}w2v}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{p}{,}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}stacking columns}
         \PY{n}{train\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}
                     \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{column} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}\PY{p}{)}
         \PY{n}{column}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{train\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{n}{column}\PY{p}{)}
         
         
         \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}test}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{o}{.}\PY{n}{values}\PY{p}{:}
             \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}test}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}avg word2vec for }
         \PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300\PYZus{}test} \PY{o}{=} \PY{n}{avg\PYZus{}w2v}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}test}\PY{p}{,}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}stacking columns}
         \PY{n}{test\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300\PYZus{}test}\PY{p}{,}
                     \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{column} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}\PY{p}{)}
         \PY{n}{column}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{test\PYZus{}df\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{test\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{n}{column}\PY{p}{)}
         
         
         \PY{n}{scale} \PY{o}{=} \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}
         \PY{n}{X\PYZus{}train\PYZus{}sc} \PY{o}{=} \PY{n}{scale}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{n}{X\PYZus{}test\PYZus{}cv\PYZus{}sc} \PY{o}{=} \PY{n}{scale}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         
         
         \PY{n}{model} \PY{o}{=}  \PY{n}{SGDClassifier}\PY{p}{(}\PY{n}{penalty}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.00012}\PY{p}{,}\PY{n}{l1\PYZus{}ratio}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}sc}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Predicting training data}
         \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}sc}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}predict test cv}
         \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv\PYZus{}sc}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}recall}
         \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}confusion matrix}
         \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{penalty=}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{l1}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{,alpha=0.00012,l1\PYZus{}ratio=0.25}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
With SGD
penalty='l1',alpha=0.00012,l1\_ratio=0.25
Train Score 0.9392380952380952
Test Score 0.9287777777777778
Test Precision 0.9474516001580403
Test Recall 0.9674556213017751
Test ConfusionMatrix [[1165  399]
 [ 242 7194]]

    \end{Verbatim}

    \subsubsection{Tf-Idf Word2Vec}\label{tf-idf-word2vec}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{base} \PY{k}{import} \PY{n}{BaseEstimator}\PY{p}{,} \PY{n}{TransformerMixin}
         
         \PY{k}{class} \PY{n+nc}{TfidfWeightedWord2Vec}\PY{p}{(}\PY{n}{BaseEstimator}\PY{p}{,} \PY{n}{TransformerMixin}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
         \PY{l+s+sd}{    Class for Tfidf Weighted Word2Vec Calculations}
         \PY{l+s+sd}{    \PYZsq{}\PYZsq{}\PYZsq{}}
             \PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{word2vec}\PY{p}{)}\PY{p}{:}
                 \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{word2vec} \PY{o}{=} \PY{n}{word2vec}
                 \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{word2weight} \PY{o}{=} \PY{k+kc}{None}
                 \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dim} \PY{o}{=} \PY{n}{word2vec}\PY{o}{.}\PY{n}{vector\PYZus{}size}
                 \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tfidf} \PY{o}{=} \PY{k+kc}{None}
         
             \PY{k}{def} \PY{n+nf}{fit}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
                 \PY{n}{tfidf} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{p}{)}
                 \PY{n}{tfidf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tfidf} \PY{o}{=} \PY{n}{tfidf}
                 \PY{c+c1}{\PYZsh{}print(self.word2vec.wv.vocab.keys())}
                 \PY{k}{return} \PY{n+nb+bp}{self}
             
             \PY{k}{def} \PY{n+nf}{tf\PYZus{}idf\PYZus{}W2V}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,}\PY{n}{feature\PYZus{}names}\PY{p}{,}\PY{n}{tf\PYZus{}idf\PYZus{}trans\PYZus{}arr}\PY{p}{,}\PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{)}\PY{p}{:}
                 \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
         \PY{l+s+sd}{        tfidf weighted word2vec calculation}
         \PY{l+s+sd}{        \PYZsq{}\PYZsq{}\PYZsq{}}
                 \PY{k+kn}{import} \PY{n+nn}{operator}
                 \PY{n}{dict\PYZus{}tfidf} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{k}\PY{p}{:} \PY{n}{v} \PY{k}{for} \PY{n}{v}\PY{p}{,} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{)}\PY{p}{\PYZcb{}}
                 \PY{n}{sent\PYZus{}vectors} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                 \PY{n}{i} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{:} \PY{c+c1}{\PYZsh{} for each review/sentence}
                     \PY{n}{doc} \PY{o}{=} \PY{p}{[}\PY{n}{word} \PY{k}{for} \PY{n}{word} \PY{o+ow}{in} \PY{n}{sent} \PY{k}{if} \PY{n}{word} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{word2vec}\PY{o}{.}\PY{n}{wv}\PY{o}{.}\PY{n}{vocab}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{]}
                     \PY{k}{if} \PY{n}{doc}\PY{p}{:}
                         \PY{c+c1}{\PYZsh{}itemgetter}
                         \PY{n}{f} \PY{o}{=} \PY{n}{operator}\PY{o}{.}\PY{n}{itemgetter}\PY{p}{(}\PY{o}{*}\PY{n}{doc}\PY{p}{)}
                         \PY{k}{try}\PY{p}{:}
                             \PY{c+c1}{\PYZsh{}itemgetter from dict}
                             \PY{n}{final} \PY{o}{=} \PY{n}{f}\PY{p}{(}\PY{n}{dict\PYZus{}tfidf}\PY{p}{)}
                             \PY{n}{final} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}trans\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{n}{final}\PY{p}{]}
                             \PY{c+c1}{\PYZsh{}converting to dense}
                             \PY{n}{final} \PY{o}{=} \PY{n}{final}\PY{o}{.}\PY{n}{toarray}\PY{p}{(}\PY{p}{)}
                             \PY{c+c1}{\PYZsh{}converting to diagnol matrix for multiplication}
                             \PY{n}{final}\PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{diag}\PY{p}{(}\PY{n}{final}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                             \PY{n}{sent\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{final}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{word2vec}\PY{o}{.}\PY{n}{wv}\PY{p}{[}\PY{n}{doc}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                             \PY{c+c1}{\PYZsh{}tfidf weighted word to vec}
                             \PY{n}{sent\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{sent\PYZus{}vec}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)} \PY{o}{/} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{final}\PY{p}{)}
                         \PY{k}{except}\PY{p}{:}
                             \PY{n}{sent\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dim}\PY{p}{)}             
                     \PY{k}{else}\PY{p}{:}
                         \PY{n}{sent\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dim}\PY{p}{)}
                     \PY{n}{sent\PYZus{}vectors}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent\PYZus{}vec}\PY{p}{)}
                     \PY{n}{i} \PY{o}{=} \PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}
                 \PY{k}{return} \PY{n}{sent\PYZus{}vectors}
         
             \PY{k}{def} \PY{n+nf}{transform}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{X}\PY{p}{)}\PY{p}{:}
                 \PY{c+c1}{\PYZsh{}transform data}
                 \PY{n}{tf\PYZus{}idf\PYZus{}trans\PYZus{}arr} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tfidf}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                 \PY{n}{feature\PYZus{}names} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tfidf}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
                 \PY{n}{list\PYZus{}of\PYZus{}sent} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                 \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}
                     \PY{n}{list\PYZus{}of\PYZus{}sent}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
                 \PY{n}{temp\PYZus{}vec} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tf\PYZus{}idf\PYZus{}W2V}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{,}\PY{n}{tf\PYZus{}idf\PYZus{}trans\PYZus{}arr}\PY{p}{,}\PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{)}
                 \PY{n}{temp\PYZus{}vec}\PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{temp\PYZus{}vec}\PY{p}{,}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                 \PY{k}{return} \PY{n}{temp\PYZus{}vec}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{c+c1}{\PYZsh{} For simple cv}
         \PY{c+c1}{\PYZsh{}Train data}
         \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{X\PYZus{}test\PYZus{}cv} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}transforming to tfidf weighted word2vec}
         \PY{n}{tfidfvect\PYZus{}w2v} \PY{o}{=} \PY{n}{TfidfWeightedWord2Vec}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{)}
         \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{X\PYZus{}train\PYZus{}tfw2v} \PY{o}{=} \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{X\PYZus{}cv\PYZus{}tfw2v} \PY{o}{=} \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{c+c1}{\PYZsh{}scaling the data}
         \PY{n}{scale} \PY{o}{=} \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}
         \PY{n}{X\PYZus{}train\PYZus{}sc} \PY{o}{=} \PY{n}{scale}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{)}
         \PY{n}{X\PYZus{}test\PYZus{}cv\PYZus{}sc} \PY{o}{=} \PY{n}{scale}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}cv\PYZus{}tfw2v}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{ParameterGrid}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{]}\PY{p}{,}
                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.001}\PY{p}{,}\PY{l+m+mf}{0.008}\PY{p}{,}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{p}{,}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{SVC}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rbf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{gamma}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}sc}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}sc}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv\PYZus{}sc}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C 1 Gamma 0.001 Train Score 0.9242857142857143 Test Score 0.8833333333333333
C 1 Gamma 0.008 Train Score 0.9641496598639456 Test Score 0.8671428571428571
C 1 Gamma 0.01 Train Score 0.9679591836734693 Test Score 0.8611111111111112
C 1 Gamma 0.1 Train Score 0.9785714285714285 Test Score 0.8268253968253968
C 1 Gamma 0.5 Train Score 0.9789795918367347 Test Score 0.8287301587301588
C 1 Gamma 1 Train Score 0.9792517006802721 Test Score 0.829047619047619
C 1 Gamma 10 Train Score 0.9814285714285714 Test Score 0.8323809523809523
C 5 Gamma 0.001 Train Score 0.9479591836734694 Test Score 0.8898412698412699
C 5 Gamma 0.008 Train Score 0.9782993197278912 Test Score 0.87
C 5 Gamma 0.01 Train Score 0.9786394557823129 Test Score 0.8653968253968254
C 5 Gamma 0.1 Train Score 0.978843537414966 Test Score 0.8274603174603175
C 5 Gamma 0.5 Train Score 0.9793877551020408 Test Score 0.8282539682539682
C 5 Gamma 1 Train Score 0.9798639455782313 Test Score 0.8304761904761905
C 5 Gamma 10 Train Score 0.9821768707482993 Test Score 0.8320634920634921
C 7 Gamma 0.001 Train Score 0.9527210884353742 Test Score 0.8895238095238095
C 7 Gamma 0.008 Train Score 0.9785714285714285 Test Score 0.8701587301587301
C 7 Gamma 0.01 Train Score 0.9785034013605443 Test Score 0.8653968253968254
C 7 Gamma 0.1 Train Score 0.9787755102040816 Test Score 0.8274603174603175
C 7 Gamma 0.5 Train Score 0.9795238095238096 Test Score 0.8284126984126984
C 7 Gamma 1 Train Score 0.980204081632653 Test Score 0.8314285714285714
C 7 Gamma 10 Train Score 0.9823129251700681 Test Score 0.8319047619047619

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{ParameterGrid}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.001}\PY{p}{,}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{p}{]}\PY{p}{,}
                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.001}\PY{p}{,}\PY{l+m+mf}{0.008}\PY{p}{,}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{p}{,}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{SVC}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rbf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{gamma}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}sc}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}sc}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv\PYZus{}sc}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C 0.001 Gamma 0.001 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.001 Gamma 0.008 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.001 Gamma 0.01 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.001 Gamma 0.1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.001 Gamma 0.5 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.001 Gamma 1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.001 Gamma 10 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 0.001 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 0.008 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 0.01 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 0.1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 0.5 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.01 Gamma 10 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.1 Gamma 0.001 Train Score 0.8851020408163265 Test Score 0.8536507936507937
C 0.1 Gamma 0.008 Train Score 0.8639455782312925 Test Score 0.8319047619047619
C 0.1 Gamma 0.01 Train Score 0.8584353741496599 Test Score 0.8273015873015873
C 0.1 Gamma 0.1 Train Score 0.8563945578231292 Test Score 0.8253968253968254
C 0.1 Gamma 0.5 Train Score 0.8571428571428571 Test Score 0.8258730158730159
C 0.1 Gamma 1 Train Score 0.8572789115646259 Test Score 0.8257142857142857
C 0.1 Gamma 10 Train Score 0.8565986394557823 Test Score 0.8257142857142857


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{c} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{10.5}\PY{p}{,}\PY{l+m+mf}{0.85}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mf}{2.5}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{]}
         \PY{n}{gamma} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.00095}\PY{p}{,}\PY{l+m+mf}{0.001}\PY{p}{,}\PY{l+m+mf}{0.0013}\PY{p}{,}\PY{l+m+mf}{0.0015}\PY{p}{,}\PY{l+m+mf}{0.0024}\PY{p}{,}\PY{l+m+mf}{0.007}\PY{p}{,}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{]}
         \PY{n}{model\PYZus{}grid\PYZus{}tfidfw2v} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}
                                     \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{TfidfWeightedWord2Vec}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{)}\PY{p}{,}
                                     \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{SVC}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                      \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{c}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{gamma}\PY{p}{\PYZcb{}}\PY{p}{,}
                                     \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)} 
         \PY{n}{model\PYZus{}grid\PYZus{}tfidfw2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                     \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}grid\PYZus{}tfidfw2v}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}grid\PYZus{}tfidfw2v}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}25}]:}       gamma     C  Test\_score  Test\_std  Train\_score
         64  0.00100  20.0    0.892457  0.004307     0.972534
         63  0.00095  20.0    0.892404  0.004359     0.971365
         54  0.00095  12.0    0.892142  0.005162     0.964579
         47  0.00130  10.0    0.892090  0.005534     0.969587
         55  0.00100  12.0    0.892090  0.005008     0.965825
         2   0.00130  10.5    0.892038  0.005365     0.970219
         56  0.00130  12.0    0.892038  0.005081     0.971907
         1   0.00100  10.5    0.891933  0.006247     0.963971
         0   0.00095  10.5    0.891776  0.005768     0.962865
         45  0.00095  10.0    0.891776  0.006028     0.961995
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{n}{model\PYZus{}random\PYZus{}tfidfw2v} \PY{o}{=} \PY{n}{RandomizedSearchCV}\PY{p}{(}
                                 \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{TfidfWeightedWord2Vec}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{)}\PY{p}{,}
                                     \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{SVC}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                 \PY{n}{param\PYZus{}distributions}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{uniform}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{l+m+mf}{3.5}\PY{p}{)}\PY{p}{,}
                                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mf}{0.0008}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{l+m+mf}{0.004}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{,}\PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,}
                                     \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)} 
         \PY{n}{model\PYZus{}random\PYZus{}tfidfw2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}random\PYZus{}tfidfw2v}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svc\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}tfidfw2v}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}39}]:}        gamma         C  Test\_score  Test\_std  Train\_score
         5   0.002625  2.978150    0.889314  0.006145     0.968132
         11  0.002274  2.929955    0.889104  0.005996     0.964255
         10  0.003434  3.078954    0.887742  0.006286     0.974421
         4   0.003403  2.501247    0.887690  0.006506     0.971187
         12  0.003382  3.446907    0.887533  0.006390     0.975409
         6   0.002573  1.670520    0.887218  0.006713     0.955952
         9   0.003608  2.015362    0.886695  0.006492     0.968607
         7   0.003702  2.062496    0.886433  0.006320     0.969583
         14  0.003818  2.920594    0.886276  0.006151     0.975324
         0   0.004238  2.525873    0.885961  0.006509     0.975278
\end{Verbatim}
            
    best cv score for tfidf word2vec got at gamma = 0.00100 C = 20.0 and
mean cv score is 0.892457

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{c+c1}{\PYZsh{}testscore}
         \PY{c+c1}{\PYZsh{} For simple cv}
         \PY{c+c1}{\PYZsh{}transforming to tfidf weighted word2vec}
         \PY{n}{tfidfvect\PYZus{}w2v} \PY{o}{=} \PY{n}{TfidfWeightedWord2Vec}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{)}
         \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{X\PYZus{}train\PYZus{}tfw2v} \PY{o}{=} \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{X\PYZus{}cv\PYZus{}tfw2v} \PY{o}{=} \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}scaling the data}
         \PY{n}{scale} \PY{o}{=} \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}
         \PY{n}{X\PYZus{}train\PYZus{}sc} \PY{o}{=} \PY{n}{scale}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{)}
         \PY{n}{X\PYZus{}test\PYZus{}cv\PYZus{}sc} \PY{o}{=} \PY{n}{scale}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}cv\PYZus{}tfw2v}\PY{p}{)}
         
         \PY{n}{model} \PY{o}{=} \PY{n}{SVC}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rbf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{gamma}\PY{o}{=}\PY{l+m+mf}{0.00100}\PY{p}{)}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}sc}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Predicting training data}
         \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}sc}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}predict test cv}
         \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv\PYZus{}sc}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}recall}
         \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}confusion matrix}
         \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mf}{0.00100}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of support vectors for each class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{model}\PY{o}{.}\PY{n}{n\PYZus{}support\PYZus{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
C 20 gamma 0.001
Train Score 0.9643809523809523
Test Score 0.8904444444444445
Test Precision 0.8969719350073855
Test Recall 0.9799623453469607
Test ConfusionMatrix [[ 727  837]
 [ 149 7287]]
No of support vectors for each class [2031 2750]

    \end{Verbatim}

    \subparagraph{SGD Classifier}\label{sgd-classifier}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}58}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{ParameterGrid}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.00005}\PY{p}{,}\PY{l+m+mf}{0.00008}\PY{p}{,}\PY{l+m+mf}{0.0001}\PY{p}{,}\PY{l+m+mf}{0.00012}\PY{p}{]}\PY{p}{,}
                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mf}{0.03}\PY{p}{,}\PY{l+m+mf}{0.05}\PY{p}{,}\PY{l+m+mf}{0.08}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{p}{,}\PY{l+m+mf}{0.15}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{,}\PY{l+m+mf}{0.35}\PY{p}{,}
                                            \PY{l+m+mf}{0.45}\PY{p}{,}\PY{l+m+mf}{0.55}\PY{p}{,}\PY{l+m+mf}{0.65}\PY{p}{,}\PY{l+m+mf}{0.75}\PY{p}{,}\PY{l+m+mf}{0.85}\PY{p}{,}\PY{l+m+mf}{0.95}\PY{p}{]}\PY{p}{,}
                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{penality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{elasticnet}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{SGDClassifier}\PY{p}{(}\PY{n}{penalty}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{penality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{alpha}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                   \PY{n}{l1\PYZus{}ratio}\PY{o}{=}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}sc}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}sc}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv\PYZus{}sc}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Penality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{penality}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                   \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Alpha 5e-05 l1\_ratio 0 Penality l1 Train Score 0.9236734693877551 Test Score 0.8922222222222222
Alpha 5e-05 l1\_ratio 0 Penality l2 Train Score 0.9210884353741496 Test Score 0.8890476190476191
Alpha 5e-05 l1\_ratio 0 Penality elasticnet Train Score 0.9210884353741496 Test Score 0.8890476190476191
Alpha 5e-05 l1\_ratio 0.03 Penality l1 Train Score 0.9236734693877551 Test Score 0.8922222222222222
Alpha 5e-05 l1\_ratio 0.03 Penality l2 Train Score 0.9210884353741496 Test Score 0.8890476190476191
Alpha 5e-05 l1\_ratio 0.03 Penality elasticnet Train Score 0.9169387755102041 Test Score 0.8917460317460317
Alpha 5e-05 l1\_ratio 0.05 Penality l1 Train Score 0.9236734693877551 Test Score 0.8922222222222222
Alpha 5e-05 l1\_ratio 0.05 Penality l2 Train Score 0.9210884353741496 Test Score 0.8890476190476191
Alpha 5e-05 l1\_ratio 0.05 Penality elasticnet Train Score 0.9196598639455782 Test Score 0.8933333333333333
Alpha 5e-05 l1\_ratio 0.08 Penality l1 Train Score 0.9236734693877551 Test Score 0.8922222222222222
Alpha 5e-05 l1\_ratio 0.08 Penality l2 Train Score 0.9210884353741496 Test Score 0.8890476190476191
Alpha 5e-05 l1\_ratio 0.08 Penality elasticnet Train Score 0.9186394557823129 Test Score 0.8884126984126984
Alpha 5e-05 l1\_ratio 0.1 Penality l1 Train Score 0.9236734693877551 Test Score 0.8922222222222222
Alpha 5e-05 l1\_ratio 0.1 Penality l2 Train Score 0.9210884353741496 Test Score 0.8890476190476191
Alpha 5e-05 l1\_ratio 0.1 Penality elasticnet Train Score 0.9102040816326531 Test Score 0.8865079365079365
Alpha 5e-05 l1\_ratio 0.15 Penality l1 Train Score 0.9236734693877551 Test Score 0.8922222222222222
Alpha 5e-05 l1\_ratio 0.15 Penality l2 Train Score 0.9210884353741496 Test Score 0.8890476190476191
Alpha 5e-05 l1\_ratio 0.15 Penality elasticnet Train Score 0.9124489795918367 Test Score 0.8831746031746032
Alpha 5e-05 l1\_ratio 0.25 Penality l1 Train Score 0.9236734693877551 Test Score 0.8922222222222222
Alpha 5e-05 l1\_ratio 0.25 Penality l2 Train Score 0.9210884353741496 Test Score 0.8890476190476191
Alpha 5e-05 l1\_ratio 0.25 Penality elasticnet Train Score 0.9208163265306123 Test Score 0.8923809523809524
Alpha 5e-05 l1\_ratio 0.35 Penality l1 Train Score 0.9236734693877551 Test Score 0.8922222222222222
Alpha 5e-05 l1\_ratio 0.35 Penality l2 Train Score 0.9210884353741496 Test Score 0.8890476190476191
Alpha 5e-05 l1\_ratio 0.35 Penality elasticnet Train Score 0.9231972789115647 Test Score 0.8953968253968254
Alpha 5e-05 l1\_ratio 0.45 Penality l1 Train Score 0.9236734693877551 Test Score 0.8922222222222222
Alpha 5e-05 l1\_ratio 0.45 Penality l2 Train Score 0.9210884353741496 Test Score 0.8890476190476191
Alpha 5e-05 l1\_ratio 0.45 Penality elasticnet Train Score 0.922312925170068 Test Score 0.8933333333333333
Alpha 5e-05 l1\_ratio 0.55 Penality l1 Train Score 0.9236734693877551 Test Score 0.8922222222222222
Alpha 5e-05 l1\_ratio 0.55 Penality l2 Train Score 0.9210884353741496 Test Score 0.8890476190476191
Alpha 5e-05 l1\_ratio 0.55 Penality elasticnet Train Score 0.9128571428571428 Test Score 0.883968253968254
Alpha 5e-05 l1\_ratio 0.65 Penality l1 Train Score 0.9236734693877551 Test Score 0.8922222222222222
Alpha 5e-05 l1\_ratio 0.65 Penality l2 Train Score 0.9210884353741496 Test Score 0.8890476190476191
Alpha 5e-05 l1\_ratio 0.65 Penality elasticnet Train Score 0.9136734693877551 Test Score 0.8855555555555555
Alpha 5e-05 l1\_ratio 0.75 Penality l1 Train Score 0.9236734693877551 Test Score 0.8922222222222222
Alpha 5e-05 l1\_ratio 0.75 Penality l2 Train Score 0.9210884353741496 Test Score 0.8890476190476191
Alpha 5e-05 l1\_ratio 0.75 Penality elasticnet Train Score 0.9219727891156463 Test Score 0.8926984126984127
Alpha 5e-05 l1\_ratio 0.85 Penality l1 Train Score 0.9236734693877551 Test Score 0.8922222222222222
Alpha 5e-05 l1\_ratio 0.85 Penality l2 Train Score 0.9210884353741496 Test Score 0.8890476190476191
Alpha 5e-05 l1\_ratio 0.85 Penality elasticnet Train Score 0.9263945578231293 Test Score 0.8974603174603175
Alpha 5e-05 l1\_ratio 0.95 Penality l1 Train Score 0.9236734693877551 Test Score 0.8922222222222222
Alpha 5e-05 l1\_ratio 0.95 Penality l2 Train Score 0.9210884353741496 Test Score 0.8890476190476191
Alpha 5e-05 l1\_ratio 0.95 Penality elasticnet Train Score 0.9259863945578232 Test Score 0.8965079365079365
Alpha 8e-05 l1\_ratio 0 Penality l1 Train Score 0.9240136054421769 Test Score 0.8949206349206349
Alpha 8e-05 l1\_ratio 0 Penality l2 Train Score 0.9206122448979592 Test Score 0.8920634920634921
Alpha 8e-05 l1\_ratio 0 Penality elasticnet Train Score 0.9206122448979592 Test Score 0.8920634920634921
Alpha 8e-05 l1\_ratio 0.03 Penality l1 Train Score 0.9240136054421769 Test Score 0.8949206349206349
Alpha 8e-05 l1\_ratio 0.03 Penality l2 Train Score 0.9206122448979592 Test Score 0.8920634920634921
Alpha 8e-05 l1\_ratio 0.03 Penality elasticnet Train Score 0.9195238095238095 Test Score 0.8931746031746032
Alpha 8e-05 l1\_ratio 0.05 Penality l1 Train Score 0.9240136054421769 Test Score 0.8949206349206349
Alpha 8e-05 l1\_ratio 0.05 Penality l2 Train Score 0.9206122448979592 Test Score 0.8920634920634921
Alpha 8e-05 l1\_ratio 0.05 Penality elasticnet Train Score 0.9224489795918367 Test Score 0.8944444444444445
Alpha 8e-05 l1\_ratio 0.08 Penality l1 Train Score 0.9240136054421769 Test Score 0.8949206349206349
Alpha 8e-05 l1\_ratio 0.08 Penality l2 Train Score 0.9206122448979592 Test Score 0.8920634920634921
Alpha 8e-05 l1\_ratio 0.08 Penality elasticnet Train Score 0.9149659863945578 Test Score 0.8860317460317461
Alpha 8e-05 l1\_ratio 0.1 Penality l1 Train Score 0.9240136054421769 Test Score 0.8949206349206349
Alpha 8e-05 l1\_ratio 0.1 Penality l2 Train Score 0.9206122448979592 Test Score 0.8920634920634921
Alpha 8e-05 l1\_ratio 0.1 Penality elasticnet Train Score 0.9220408163265306 Test Score 0.893015873015873
Alpha 8e-05 l1\_ratio 0.15 Penality l1 Train Score 0.9240136054421769 Test Score 0.8949206349206349
Alpha 8e-05 l1\_ratio 0.15 Penality l2 Train Score 0.9206122448979592 Test Score 0.8920634920634921
Alpha 8e-05 l1\_ratio 0.15 Penality elasticnet Train Score 0.9148979591836734 Test Score 0.8853968253968254
Alpha 8e-05 l1\_ratio 0.25 Penality l1 Train Score 0.9240136054421769 Test Score 0.8949206349206349
Alpha 8e-05 l1\_ratio 0.25 Penality l2 Train Score 0.9206122448979592 Test Score 0.8920634920634921
Alpha 8e-05 l1\_ratio 0.25 Penality elasticnet Train Score 0.9210884353741496 Test Score 0.8936507936507937
Alpha 8e-05 l1\_ratio 0.35 Penality l1 Train Score 0.9240136054421769 Test Score 0.8949206349206349
Alpha 8e-05 l1\_ratio 0.35 Penality l2 Train Score 0.9206122448979592 Test Score 0.8920634920634921
Alpha 8e-05 l1\_ratio 0.35 Penality elasticnet Train Score 0.9227210884353741 Test Score 0.8946031746031746
Alpha 8e-05 l1\_ratio 0.45 Penality l1 Train Score 0.9240136054421769 Test Score 0.8949206349206349
Alpha 8e-05 l1\_ratio 0.45 Penality l2 Train Score 0.9206122448979592 Test Score 0.8920634920634921
Alpha 8e-05 l1\_ratio 0.45 Penality elasticnet Train Score 0.9160544217687074 Test Score 0.8896825396825396
Alpha 8e-05 l1\_ratio 0.55 Penality l1 Train Score 0.9240136054421769 Test Score 0.8949206349206349
Alpha 8e-05 l1\_ratio 0.55 Penality l2 Train Score 0.9206122448979592 Test Score 0.8920634920634921
Alpha 8e-05 l1\_ratio 0.55 Penality elasticnet Train Score 0.9230612244897959 Test Score 0.8961904761904762
Alpha 8e-05 l1\_ratio 0.65 Penality l1 Train Score 0.9240136054421769 Test Score 0.8949206349206349
Alpha 8e-05 l1\_ratio 0.65 Penality l2 Train Score 0.9206122448979592 Test Score 0.8920634920634921
Alpha 8e-05 l1\_ratio 0.65 Penality elasticnet Train Score 0.9244897959183673 Test Score 0.8957142857142857
Alpha 8e-05 l1\_ratio 0.75 Penality l1 Train Score 0.9240136054421769 Test Score 0.8949206349206349
Alpha 8e-05 l1\_ratio 0.75 Penality l2 Train Score 0.9206122448979592 Test Score 0.8920634920634921
Alpha 8e-05 l1\_ratio 0.75 Penality elasticnet Train Score 0.925578231292517 Test Score 0.8942857142857142
Alpha 8e-05 l1\_ratio 0.85 Penality l1 Train Score 0.9240136054421769 Test Score 0.8949206349206349
Alpha 8e-05 l1\_ratio 0.85 Penality l2 Train Score 0.9206122448979592 Test Score 0.8920634920634921
Alpha 8e-05 l1\_ratio 0.85 Penality elasticnet Train Score 0.923265306122449 Test Score 0.8968253968253969
Alpha 8e-05 l1\_ratio 0.95 Penality l1 Train Score 0.9240136054421769 Test Score 0.8949206349206349
Alpha 8e-05 l1\_ratio 0.95 Penality l2 Train Score 0.9206122448979592 Test Score 0.8920634920634921
Alpha 8e-05 l1\_ratio 0.95 Penality elasticnet Train Score 0.9178231292517007 Test Score 0.8874603174603175
Alpha 0.0001 l1\_ratio 0 Penality l1 Train Score 0.9182312925170067 Test Score 0.89
Alpha 0.0001 l1\_ratio 0 Penality l2 Train Score 0.9231292517006803 Test Score 0.893968253968254
Alpha 0.0001 l1\_ratio 0 Penality elasticnet Train Score 0.9231292517006803 Test Score 0.893968253968254
Alpha 0.0001 l1\_ratio 0.03 Penality l1 Train Score 0.9182312925170067 Test Score 0.89
Alpha 0.0001 l1\_ratio 0.03 Penality l2 Train Score 0.9231292517006803 Test Score 0.893968253968254
Alpha 0.0001 l1\_ratio 0.03 Penality elasticnet Train Score 0.921156462585034 Test Score 0.8931746031746032
Alpha 0.0001 l1\_ratio 0.05 Penality l1 Train Score 0.9182312925170067 Test Score 0.89
Alpha 0.0001 l1\_ratio 0.05 Penality l2 Train Score 0.9231292517006803 Test Score 0.893968253968254
Alpha 0.0001 l1\_ratio 0.05 Penality elasticnet Train Score 0.921156462585034 Test Score 0.8928571428571429
Alpha 0.0001 l1\_ratio 0.08 Penality l1 Train Score 0.9182312925170067 Test Score 0.89
Alpha 0.0001 l1\_ratio 0.08 Penality l2 Train Score 0.9231292517006803 Test Score 0.893968253968254
Alpha 0.0001 l1\_ratio 0.08 Penality elasticnet Train Score 0.9155102040816326 Test Score 0.8863492063492063
Alpha 0.0001 l1\_ratio 0.1 Penality l1 Train Score 0.9182312925170067 Test Score 0.89
Alpha 0.0001 l1\_ratio 0.1 Penality l2 Train Score 0.9231292517006803 Test Score 0.893968253968254
Alpha 0.0001 l1\_ratio 0.1 Penality elasticnet Train Score 0.9214965986394558 Test Score 0.8934920634920634
Alpha 0.0001 l1\_ratio 0.15 Penality l1 Train Score 0.9182312925170067 Test Score 0.89
Alpha 0.0001 l1\_ratio 0.15 Penality l2 Train Score 0.9231292517006803 Test Score 0.893968253968254
Alpha 0.0001 l1\_ratio 0.15 Penality elasticnet Train Score 0.9210884353741496 Test Score 0.8934920634920634
Alpha 0.0001 l1\_ratio 0.25 Penality l1 Train Score 0.9182312925170067 Test Score 0.89
Alpha 0.0001 l1\_ratio 0.25 Penality l2 Train Score 0.9231292517006803 Test Score 0.893968253968254
Alpha 0.0001 l1\_ratio 0.25 Penality elasticnet Train Score 0.9206122448979592 Test Score 0.895079365079365
Alpha 0.0001 l1\_ratio 0.35 Penality l1 Train Score 0.9182312925170067 Test Score 0.89
Alpha 0.0001 l1\_ratio 0.35 Penality l2 Train Score 0.9231292517006803 Test Score 0.893968253968254
Alpha 0.0001 l1\_ratio 0.35 Penality elasticnet Train Score 0.9197278911564626 Test Score 0.8884126984126984
Alpha 0.0001 l1\_ratio 0.45 Penality l1 Train Score 0.9182312925170067 Test Score 0.89
Alpha 0.0001 l1\_ratio 0.45 Penality l2 Train Score 0.9231292517006803 Test Score 0.893968253968254
Alpha 0.0001 l1\_ratio 0.45 Penality elasticnet Train Score 0.9230612244897959 Test Score 0.8938095238095238
Alpha 0.0001 l1\_ratio 0.55 Penality l1 Train Score 0.9182312925170067 Test Score 0.89
Alpha 0.0001 l1\_ratio 0.55 Penality l2 Train Score 0.9231292517006803 Test Score 0.893968253968254
Alpha 0.0001 l1\_ratio 0.55 Penality elasticnet Train Score 0.9242857142857143 Test Score 0.8953968253968254
Alpha 0.0001 l1\_ratio 0.65 Penality l1 Train Score 0.9182312925170067 Test Score 0.89
Alpha 0.0001 l1\_ratio 0.65 Penality l2 Train Score 0.9231292517006803 Test Score 0.893968253968254
Alpha 0.0001 l1\_ratio 0.65 Penality elasticnet Train Score 0.92421768707483 Test Score 0.8949206349206349
Alpha 0.0001 l1\_ratio 0.75 Penality l1 Train Score 0.9182312925170067 Test Score 0.89
Alpha 0.0001 l1\_ratio 0.75 Penality l2 Train Score 0.9231292517006803 Test Score 0.893968253968254
Alpha 0.0001 l1\_ratio 0.75 Penality elasticnet Train Score 0.9238095238095239 Test Score 0.8952380952380953
Alpha 0.0001 l1\_ratio 0.85 Penality l1 Train Score 0.9182312925170067 Test Score 0.89
Alpha 0.0001 l1\_ratio 0.85 Penality l2 Train Score 0.9231292517006803 Test Score 0.893968253968254
Alpha 0.0001 l1\_ratio 0.85 Penality elasticnet Train Score 0.9238775510204081 Test Score 0.8952380952380953
Alpha 0.0001 l1\_ratio 0.95 Penality l1 Train Score 0.9182312925170067 Test Score 0.89
Alpha 0.0001 l1\_ratio 0.95 Penality l2 Train Score 0.9231292517006803 Test Score 0.893968253968254
Alpha 0.0001 l1\_ratio 0.95 Penality elasticnet Train Score 0.9229251700680272 Test Score 0.8953968253968254
Alpha 0.00012 l1\_ratio 0 Penality l1 Train Score 0.9231972789115647 Test Score 0.8946031746031746
Alpha 0.00012 l1\_ratio 0 Penality l2 Train Score 0.9166666666666666 Test Score 0.8884126984126984
Alpha 0.00012 l1\_ratio 0 Penality elasticnet Train Score 0.9166666666666666 Test Score 0.8884126984126984
Alpha 0.00012 l1\_ratio 0.03 Penality l1 Train Score 0.9231972789115647 Test Score 0.8946031746031746
Alpha 0.00012 l1\_ratio 0.03 Penality l2 Train Score 0.9166666666666666 Test Score 0.8884126984126984
Alpha 0.00012 l1\_ratio 0.03 Penality elasticnet Train Score 0.9204761904761904 Test Score 0.8949206349206349
Alpha 0.00012 l1\_ratio 0.05 Penality l1 Train Score 0.9231972789115647 Test Score 0.8946031746031746
Alpha 0.00012 l1\_ratio 0.05 Penality l2 Train Score 0.9166666666666666 Test Score 0.8884126984126984
Alpha 0.00012 l1\_ratio 0.05 Penality elasticnet Train Score 0.9219727891156463 Test Score 0.8934920634920634
Alpha 0.00012 l1\_ratio 0.08 Penality l1 Train Score 0.9231972789115647 Test Score 0.8946031746031746
Alpha 0.00012 l1\_ratio 0.08 Penality l2 Train Score 0.9166666666666666 Test Score 0.8884126984126984
Alpha 0.00012 l1\_ratio 0.08 Penality elasticnet Train Score 0.9227210884353741 Test Score 0.8919047619047619
Alpha 0.00012 l1\_ratio 0.1 Penality l1 Train Score 0.9231972789115647 Test Score 0.8946031746031746
Alpha 0.00012 l1\_ratio 0.1 Penality l2 Train Score 0.9166666666666666 Test Score 0.8884126984126984
Alpha 0.00012 l1\_ratio 0.1 Penality elasticnet Train Score 0.9228571428571428 Test Score 0.8941269841269841
Alpha 0.00012 l1\_ratio 0.15 Penality l1 Train Score 0.9231972789115647 Test Score 0.8946031746031746
Alpha 0.00012 l1\_ratio 0.15 Penality l2 Train Score 0.9166666666666666 Test Score 0.8884126984126984
Alpha 0.00012 l1\_ratio 0.15 Penality elasticnet Train Score 0.9222448979591836 Test Score 0.8911111111111111
Alpha 0.00012 l1\_ratio 0.25 Penality l1 Train Score 0.9231972789115647 Test Score 0.8946031746031746
Alpha 0.00012 l1\_ratio 0.25 Penality l2 Train Score 0.9166666666666666 Test Score 0.8884126984126984
Alpha 0.00012 l1\_ratio 0.25 Penality elasticnet Train Score 0.921156462585034 Test Score 0.8938095238095238
Alpha 0.00012 l1\_ratio 0.35 Penality l1 Train Score 0.9231972789115647 Test Score 0.8946031746031746
Alpha 0.00012 l1\_ratio 0.35 Penality l2 Train Score 0.9166666666666666 Test Score 0.8884126984126984
Alpha 0.00012 l1\_ratio 0.35 Penality elasticnet Train Score 0.924625850340136 Test Score 0.893015873015873
Alpha 0.00012 l1\_ratio 0.45 Penality l1 Train Score 0.9231972789115647 Test Score 0.8946031746031746
Alpha 0.00012 l1\_ratio 0.45 Penality l2 Train Score 0.9166666666666666 Test Score 0.8884126984126984
Alpha 0.00012 l1\_ratio 0.45 Penality elasticnet Train Score 0.9231292517006803 Test Score 0.8946031746031746
Alpha 0.00012 l1\_ratio 0.55 Penality l1 Train Score 0.9231972789115647 Test Score 0.8946031746031746
Alpha 0.00012 l1\_ratio 0.55 Penality l2 Train Score 0.9166666666666666 Test Score 0.8884126984126984
Alpha 0.00012 l1\_ratio 0.55 Penality elasticnet Train Score 0.9229931972789116 Test Score 0.8949206349206349
Alpha 0.00012 l1\_ratio 0.65 Penality l1 Train Score 0.9231972789115647 Test Score 0.8946031746031746
Alpha 0.00012 l1\_ratio 0.65 Penality l2 Train Score 0.9166666666666666 Test Score 0.8884126984126984
Alpha 0.00012 l1\_ratio 0.65 Penality elasticnet Train Score 0.9238775510204081 Test Score 0.8965079365079365
Alpha 0.00012 l1\_ratio 0.75 Penality l1 Train Score 0.9231972789115647 Test Score 0.8946031746031746
Alpha 0.00012 l1\_ratio 0.75 Penality l2 Train Score 0.9166666666666666 Test Score 0.8884126984126984
Alpha 0.00012 l1\_ratio 0.75 Penality elasticnet Train Score 0.9242857142857143 Test Score 0.8947619047619048
Alpha 0.00012 l1\_ratio 0.85 Penality l1 Train Score 0.9231972789115647 Test Score 0.8946031746031746
Alpha 0.00012 l1\_ratio 0.85 Penality l2 Train Score 0.9166666666666666 Test Score 0.8884126984126984
Alpha 0.00012 l1\_ratio 0.85 Penality elasticnet Train Score 0.9204081632653062 Test Score 0.8917460317460317
Alpha 0.00012 l1\_ratio 0.95 Penality l1 Train Score 0.9231972789115647 Test Score 0.8946031746031746
Alpha 0.00012 l1\_ratio 0.95 Penality l2 Train Score 0.9166666666666666 Test Score 0.8884126984126984
Alpha 0.00012 l1\_ratio 0.95 Penality elasticnet Train Score 0.9236054421768708 Test Score 0.8958730158730158

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n}{model\PYZus{}random\PYZus{}tfidfw2v} \PY{o}{=} \PY{n}{RandomizedSearchCV}\PY{p}{(}
                             \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{TfidfWeightedWord2Vec}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{)}\PY{p}{,}
                             \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{SGDClassifier}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                             \PY{n}{param\PYZus{}distributions}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}penalty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mf}{0.00001}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{l+m+mf}{0.0049}\PY{p}{)}\PY{p}{,}
                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{scale}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{,}\PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{40}\PY{p}{,}
                               \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)} 
         \PY{n}{model\PYZus{}random\PYZus{}tfidfw2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}random\PYZus{}tfidfw2v}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sgdclassifier\PYZus{}\PYZus{}penalty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}tfidfw2v}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1\PYZus{}ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{penalty}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}29}]:}        alpha  l1\_ratio penalty  Test\_score  Test\_std  Train\_score
         25  0.000823  0.464483      l1    0.892981  0.008003     0.924661
         16  0.000456  0.864083      l1    0.892823  0.007788     0.926553
         29  0.000856  0.372678      l1    0.891881  0.008156     0.924244
         36  0.000393  0.995435      l1    0.891828  0.007841     0.928939
         31  0.000906  0.480030      l1    0.891671  0.005621     0.924880
         37  0.000734  0.360432      l1    0.891566  0.007266     0.926045
         15  0.000525  0.521241      l1    0.891409  0.008473     0.927267
         19  0.000608  0.692168      l1    0.891252  0.007907     0.926134
         4   0.000154  0.842079      l2    0.891200  0.007756     0.925755
         14  0.000231  0.884751      l2    0.890676  0.006560     0.924619
\end{Verbatim}
            
    Got best cv scores at alpha = 0.000823 l1\_ratio = 0.464483 penalty = l1
and mean cv score is 0.892981.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{c+c1}{\PYZsh{}testscore}
         \PY{c+c1}{\PYZsh{}transforming to tfidf weighted word2vec}
         \PY{n}{tfidfvect\PYZus{}w2v} \PY{o}{=} \PY{n}{TfidfWeightedWord2Vec}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{)}
         \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{X\PYZus{}train\PYZus{}tfw2v} \PY{o}{=} \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{X\PYZus{}cv\PYZus{}tfw2v} \PY{o}{=} \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}scaling the data}
         \PY{n}{scale} \PY{o}{=} \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}
         \PY{n}{X\PYZus{}train\PYZus{}sc} \PY{o}{=} \PY{n}{scale}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{)}
         \PY{n}{X\PYZus{}test\PYZus{}cv\PYZus{}sc} \PY{o}{=} \PY{n}{scale}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}cv\PYZus{}tfw2v}\PY{p}{)}
         
         \PY{n}{model} \PY{o}{=} \PY{n}{SGDClassifier}\PY{p}{(}\PY{n}{penalty}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.000823}\PY{p}{,}\PY{n}{l1\PYZus{}ratio}\PY{o}{=}\PY{l+m+mf}{0.464483}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}sc}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Predicting training data}
         \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}sc}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}predict test cv}
         \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv\PYZus{}sc}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}recall}
         \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}confusion matrix}
         \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{penalty=}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{l1}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{,alpha=0.000823,l1\PYZus{}ratio=0.464483}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
penalty='l1',alpha=0.000823,l1\_ratio=0.464483
Train Score 0.9137142857142857
Test Score 0.889
Test Precision 0.9022622172228472
Test Recall 0.9708176438945669
Test ConfusionMatrix [[ 782  782]
 [ 217 7219]]

    \end{Verbatim}

    \paragraph{\texorpdfstring{Observations:}{Observations: }}\label{observations}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  For Binary Bag of Words got high mean cv at
  \texttt{gamma\ =\ 0.010\ ,C\ =\ 7.0} and cv mean score is
  \texttt{0.921215}

  \begin{itemize}
  \tightlist
  \item
    Train Score \texttt{0.9915238095238095}
  \item
    Test Score \texttt{0.9246666666666666}
  \item
    Test Precision \texttt{0.9447222953408791}
  \item
    Test Recall \texttt{0.9653039268423884}
  \item
    No of support vectors for each class \texttt{{[}2245,\ 3591{]}}
  \item
    Test Confusion Matrix

    \begin{equation}
    \begin{bmatrix}
    & 1144 & 420 &  \\
    & 258 & 7287 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\item
  SGD: For Binary bagof words wit SGD got best cv score at
  \texttt{alpha\ =\ 0.003570,\ l1\_ratio\ =\ 0.912537,\ penalty\ l2} and
  corresponding mean cv test score is \texttt{0.915977}

  \begin{itemize}
  \tightlist
  \item
    Train Score \texttt{0.9445238095238095}
  \item
    Test Score \texttt{0.9197777777777778}
  \item
    Test Precision \texttt{0.930053804765565}
  \item
    Test Recall \texttt{0.9763313609467456}
  \item
    Test Confusion Matrix

    \begin{equation}
    \begin{bmatrix}
    & 1018 & 546 &  \\
    & 176 & 7260 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\item
  For Tf-Idf got high mean cv at
  \texttt{gamma\ \ =\ 0.175194,\ C\ =\ 7.107109} and mean cv is
  \texttt{0.924987}

  \begin{itemize}
  \tightlist
  \item
    Train Score \texttt{1.0}
  \item
    Test Score \texttt{0.9415555555555556}
  \item
    Test Precision \texttt{0.9508089770354906}
  \item
    Test Recall \texttt{0.9799623453469607}
  \item
    No of support vectors for each class \texttt{{[}2810\ 6720{]}}
  \item
    Test Confusion Matrix

    \begin{equation}
    \begin{bmatrix}
    & 1187 & 377 &  \\
    & 149 & 7287 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\item
  SGD: For Tf-Idf with sgd got best scores at
  \texttt{alpha\ =\ 0.00003,\ l1\_ratio\ =\ 0.15,\ penalty\ =\ l1} and
  mean cv score is \texttt{0.929282}

  \begin{itemize}
  \tightlist
  \item
    Train Score \texttt{0.9569047619047619}
  \item
    Test Score \texttt{0.9355555555555556}
  \item
    Test Precision \texttt{0.9517659462308908}
  \item
    Test Recall \texttt{0.9712210866057019}
  \item
    Test Confusion Matrix

    \begin{equation}
    \begin{bmatrix}
    & 1198 & 366 &  \\
    & 214 & 7222 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\item
  For Avg Word2Vec got high mean cv at
  \texttt{gamma\ =\ 0.00100,\ C\ =\ 10} and mean cv score is
  \texttt{0.933630}

  \begin{itemize}
  \tightlist
  \item
    Train Score \texttt{0.9725714285714285}
  \item
    Test Score \texttt{0.9332222222222222}
  \item
    Test Precision \texttt{0.9459741615555266}
  \item
    Test Recall \texttt{0.9748520710059172}
  \item
    No of support vectors for each class \texttt{{[}1693\ 2078{]}}

    \begin{equation}
    \begin{bmatrix}
    & 1150 & 414 &  \\
    & 187 & 7249 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\item
  SGD: For Avg Word2Vec got best cv mean score at
  \texttt{alpha\ =\ 0.00012,l1\_ratio=\ 0.25\ penlty\ =\ l1} and mean cv
  score is \texttt{0.925406}

  \begin{itemize}
  \tightlist
  \item
    Train Score \texttt{0.9392380952380952}
  \item
    Test Score \texttt{0.9287777777777778}
  \item
    Test Precision \texttt{0.9474516001580403}
  \item
    Test Recall \texttt{0.9674556213017751}
  \item
    Test ConfusionMatrix

    \begin{equation}
    \begin{bmatrix}
    & 1165 & 399 &  \\
    & 242 & 7194 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\item
  For Tf-Idf Word2Vec got high mean cv at
  \texttt{gamma\ =\ 0.00100\ C\ =\ 20.0} and mean cv score is
  \texttt{0.892457}

  \begin{itemize}
  \tightlist
  \item
    Train Score \texttt{0.9643809523809523}
  \item
    Test Score \texttt{0.8904444444444445}
  \item
    Test Precision \texttt{0.8969719350073855}
  \item
    Test Recall \texttt{0.9799623453469607}
  \item
    No of support vectors for each class \texttt{{[}2031\ 2750{]}}

    \begin{equation}
    \begin{bmatrix}
    & 727 & 837 &  \\
    & 149 & 7287 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\item
  SGD : Got best cv scores at
  \texttt{alpha\ =\ 0.000823\ l1\_ratio\ =\ 0.464483\ penalty\ =\ l1}
  and mean cv score is \texttt{0.892981}.

  \begin{itemize}
  \tightlist
  \item
    Train Score \texttt{0.9137142857142857}
  \item
    Test Score \texttt{0.889}
  \item
    Test Precision \texttt{0.9022622172228472}
  \item
    Test Recall \texttt{0.9708176438945669}
  \item
    Test ConfusionMatrix

    \begin{equation}
    \begin{bmatrix}
    & 782 & 782 &  \\
    & 217 & 7219 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\end{enumerate}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
