
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{RF and GBDT on Amazon reviews dataset}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \subsubsection{Random Forest and GBDT on Amazon reviews data
set}\label{random-forest-and-gbdt-on-amazon-reviews-data-set}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{c+c1}{\PYZsh{}importing required Modules}
        \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
        \PY{k+kn}{import} \PY{n+nn}{sqlite3}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{nltk}
        \PY{k+kn}{import} \PY{n+nn}{string}
        \PY{k+kn}{import} \PY{n+nn}{pickle}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{TfidfTransformer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{TfidfVectorizer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{CountVectorizer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{confusion\PYZus{}matrix}
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{accuracy\PYZus{}score}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{roc\PYZus{}curve}\PY{p}{,} \PY{n}{auc}
        \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{stem}\PY{n+nn}{.}\PY{n+nn}{porter} \PY{k}{import} \PY{n}{PorterStemmer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{StandardScaler}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{TimeSeriesSplit}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{precision\PYZus{}score}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{recall\PYZus{}score}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{confusion\PYZus{}matrix}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{GridSearchCV}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{RandomizedSearchCV}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{ParameterGrid}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{RandomForestClassifier} \PY{k}{as} \PY{n}{RF}
        \PY{k+kn}{import} \PY{n+nn}{xgboost} \PY{k}{as} \PY{n+nn}{xgb}
        \PY{k+kn}{import} \PY{n+nn}{warnings}
        \PY{n}{warnings}\PY{o}{.}\PY{n}{filterwarnings}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{n}{conn} \PY{o}{=} \PY{n}{sqlite3}\PY{o}{.}\PY{n}{connect}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}clean\PYZus{}dt1.sqlite}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{final\PYZus{}review} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}sql\PYZus{}query}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{l+s+s2}{SELECT *}
        \PY{l+s+s2}{FROM Reviews\PYZus{}final}
        \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}\PY{p}{,} \PY{n}{conn}\PY{p}{)} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{c+c1}{\PYZsh{}SORT by time for TBS}
        \PY{n}{final\PYZus{}review} \PY{o}{=} \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 364171 entries, 23 to 345187
Data columns (total 6 columns):
index                     364171 non-null int64
HelpfulnessNumerator      364171 non-null int64
HelpfulnessDenominator    364171 non-null int64
Score                     364171 non-null object
final\_text                364171 non-null object
Time                      364171 non-null int64
dtypes: int64(4), object(2)
memory usage: 19.4+ MB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{c+c1}{\PYZsh{}changing lables to 1 or 0}
        \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{Score} \PY{o}{=} \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{Score}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:}
                             \PY{l+m+mi}{1} \PY{k}{if} \PY{n}{x} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{positive}\PY{l+s+s1}{\PYZsq{}} \PY{k}{else} \PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{c+c1}{\PYZsh{}Converting to int8}
        \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{HelpfulnessNumerator} \PY{o}{=} \PY{n}{final\PYZus{}review}\PY{o}{.}\PYZbs{}
                              \PY{n}{HelpfulnessNumerator}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{int8}\PY{p}{)}
        \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{HelpfulnessDenominator} \PY{o}{=} \PY{n}{final\PYZus{}review}\PY{o}{.}\PYZbs{}
                              \PY{n}{HelpfulnessDenominator}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{int8}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{c+c1}{\PYZsh{}Splitting Dataframe for train and test}
        \PY{n}{train\PYZus{}df} \PY{o}{=} \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n+nb}{round}\PY{p}{(}\PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{,}\PY{p}{:}\PY{p}{]}
        \PY{n}{test\PYZus{}df} \PY{o}{=} \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{train\PYZus{}df\PYZus{}dt.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
        \PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test\PYZus{}df\PYZus{}dt.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(254920, 6)
(109251, 6)

    \end{Verbatim}

    \paragraph{Word2Vec}\label{word2vec}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{c+c1}{\PYZsh{}importing}
         \PY{k+kn}{from} \PY{n+nn}{gensim}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Word2Vec}
         \PY{k+kn}{from} \PY{n+nn}{gensim}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{KeyedVectors}
         \PY{k+kn}{import} \PY{n+nn}{pickle}
         \PY{k+kn}{import} \PY{n+nn}{gensim}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{k+kn}{import} \PY{n+nn}{gensim}
         \PY{n}{list\PYZus{}of\PYZus{}sent}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{o}{.}\PY{n}{values}\PY{p}{:}
             \PY{n}{list\PYZus{}of\PYZus{}sent}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{c+c1}{\PYZsh{}word2vec model with 300 dim vector}
         \PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{o}{=}\PY{n}{gensim}\PY{o}{.}\PY{n}{models}\PY{o}{.}\PY{n}{Word2Vec}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{,}\PY{n}{min\PYZus{}count}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{,} \PY{n}{workers}\PY{o}{=}\PY{l+m+mi}{8}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}50}\PY{p}{,}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w2v\PYZus{}model\PYZus{}dt\PYZus{}50.p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{w2v\PYZus{}model\PYZus{}300} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w2v\PYZus{}model\PYZus{}dt\PYZus{}300.p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \paragraph{Avg Word2Vec}\label{avg-word2vec}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{c+c1}{\PYZsh{} the avg\PYZhy{}w2v for each sentence/review is stored in this list}
         \PY{k}{def} \PY{n+nf}{avg\PYZus{}w2v}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{,}\PY{n}{model}\PY{p}{,}\PY{n}{d}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
         \PY{l+s+sd}{    Returns average of word vectors for }
         \PY{l+s+sd}{    each sentance with dimension of model given}
         \PY{l+s+sd}{    \PYZsq{}\PYZsq{}\PYZsq{}}
             \PY{n}{sent\PYZus{}vectors} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{:} \PY{c+c1}{\PYZsh{} for each review/sentence}
                 \PY{n}{doc} \PY{o}{=} \PY{p}{[}\PY{n}{word} \PY{k}{for} \PY{n}{word} \PY{o+ow}{in} \PY{n}{sent} \PY{k}{if} \PY{n}{word} \PY{o+ow}{in} \PY{n}{model}\PY{o}{.}\PY{n}{wv}\PY{o}{.}\PY{n}{vocab}\PY{p}{]}
                 \PY{k}{if} \PY{n}{doc}\PY{p}{:}
                     \PY{n}{sent\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{wv}\PY{p}{[}\PY{n}{doc}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{sent\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{d}\PY{p}{)}
                 \PY{n}{sent\PYZus{}vectors}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent\PYZus{}vec}\PY{p}{)}
             \PY{k}{return} \PY{n}{sent\PYZus{}vectors}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{o}{.}\PY{n}{values}\PY{p}{:}
             \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{c+c1}{\PYZsh{}avg word2vec for }
         \PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{avg\PYZus{}w2v}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{p}{,}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}stacking columns}
         \PY{n}{train\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}
                     \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{column} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}\PY{p}{)}
         \PY{n}{column}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{train\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{n}{column}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{X\PYZus{}test\PYZus{}cv} \PY{o}{=} \PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}
\end{Verbatim}


    \subparagraph{Random Forest}\label{random-forest}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{c+c1}{\PYZsh{}base model}
         \PY{n}{model} \PY{o}{=} \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}train score}
         \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test score}
         \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Train Score 0.9969738405326041
Test Score 0.8889847795386788

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of Estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No of Estimators 1 Train Score 0.9415558942861626 Test Score 0.8301035619017731
No of Estimators 2 Train Score 0.9352457913967407 Test Score 0.8022255348083058
No of Estimators 3 Train Score 0.9776400439353523 Test Score 0.8654610596788535
No of Estimators 4 Train Score 0.982403443096994 Test Score 0.8622312882472932
No of Estimators 5 Train Score 0.9876543901728273 Test Score 0.8755557299021915
No of Estimators 6 Train Score 0.9920199054044967 Test Score 0.8789554893038339
No of Estimators 7 Train Score 0.992031113402524 Test Score 0.881283016894189
No of Estimators 8 Train Score 0.9953038488265226 Test Score 0.8853627281761598
No of Estimators 9 Train Score 0.9945473089596736 Test Score 0.8842251163763796
No of Estimators 10 Train Score 0.9969738405326041 Test Score 0.8889847795386788
No of Estimators 11 Train Score 0.9958754567259196 Test Score 0.8864872639782415
No of Estimators 12 Train Score 0.9978648763757818 Test Score 0.8898085673936922
No of Estimators 13 Train Score 0.9970074645266862 Test Score 0.8875202677964329
No of Estimators 14 Train Score 0.9983131962968774 Test Score 0.8912992311313354
No of Estimators 15 Train Score 0.9976687364103024 Test Score 0.8883832836445421
No of Estimators 16 Train Score 0.9987391002219184 Test Score 0.8920837909932527
No of Estimators 17 Train Score 0.9981506803254803 Test Score 0.888801715570898
No of Estimators 18 Train Score 0.998985676178521 Test Score 0.8922799309587321
No of Estimators 19 Train Score 0.9984476922732062 Test Score 0.8891939955018567

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{c+c1}{\PYZsh{}grid search}
         \PY{n}{param\PYZus{}grid} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{17}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{,}\PY{l+m+mi}{25}\PY{p}{,}\PY{l+m+mi}{27}\PY{p}{,}\PY{l+m+mi}{35}\PY{p}{]}\PY{p}{\PYZcb{}}
         \PY{n}{model\PYZus{}grid\PYZus{}avgw2v} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}\PY{p}{,}\PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,}
                              \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}grid\PYZus{}avgw2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}50}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}grid\PYZus{}avgw2v}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}grid\PYZus{}avgw2v}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{n\PYZus{}estimators}\PY{p}{,}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{Train\PYZus{}score}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{n\PYZus{}estimators}\PY{p}{,}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{Test\PYZus{}score}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Validation curve for AvgW2V model with different no of estimates with RF}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}55}]:} <matplotlib.legend.Legend at 0x1541ace89a90>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_27_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{n}{scores\PYZus{}df}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}56}]:}     n\_estimators  Test\_score  Test\_std  Train\_score
         0              1    0.831742  0.010920     0.942438
         1              3    0.870001  0.009861     0.978063
         2              5    0.881069  0.008450     0.987786
         3              7    0.886157  0.008190     0.992247
         4              9    0.889126  0.008104     0.994517
         5             11    0.890701  0.008086     0.995924
         6             15    0.892673  0.007981     0.997590
         7             17    0.893368  0.007743     0.998058
         8             19    0.893450  0.007841     0.998393
         9             21    0.893847  0.007564     0.998735
         10            25    0.894179  0.007405     0.999102
         11            27    0.894408  0.007433     0.999270
         12            35    0.894981  0.007525     0.999662
\end{Verbatim}
            
    We can observe that after no of estimates \textgreater{}15 there is no
increment in test score. and that is also having some varince.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{with 15 estimaters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Deptha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
with 15 estimaters
Deptha 1 Train Score 0.8600121046378696 Test Score 0.8293451540352529
Deptha 2 Train Score 0.8600121046378696 Test Score 0.8293451540352529
Deptha 3 Train Score 0.8600121046378696 Test Score 0.8293451540352529
Deptha 4 Train Score 0.8639349039474569 Test Score 0.8333333333333334
Deptha 5 Train Score 0.8719206025419739 Test Score 0.8425257597154663
Deptha 6 Train Score 0.8788247293268476 Test Score 0.8511166902034625
Deptha 7 Train Score 0.886177176032817 Test Score 0.8588707568387468
Deptha 8 Train Score 0.8944598865750599 Test Score 0.8674355353313458
Deptha 9 Train Score 0.9033534330097958 Test Score 0.8727836183900831
Deptha 10 Train Score 0.9147743829997086 Test Score 0.8787331973429573
Deptha 11 Train Score 0.9260160050211831 Test Score 0.880485381034573
Deptha 12 Train Score 0.9396113066284101 Test Score 0.8837020764684346
Deptha 13 Train Score 0.9517159444979938 Test Score 0.8841335843924891
Deptha 14 Train Score 0.9629127345273587 Test Score 0.8866441759506251
Deptha 15 Train Score 0.9702315572392459 Test Score 0.8867095559391182
Deptha 16 Train Score 0.9768610880724485 Test Score 0.887376431821748
Deptha 17 Train Score 0.9826556230526103 Test Score 0.8874025838171452
Deptha 18 Train Score 0.9864159063908005 Test Score 0.8874679638056384
Deptha 19 Train Score 0.988988141938087 Test Score 0.8861342120403787

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}54}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{with 25 estimaters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Deptha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
with 25 estimaters
Deptha 1 Train Score 0.8600121046378696 Test Score 0.8293451540352529
Deptha 2 Train Score 0.8600121046378696 Test Score 0.8293451540352529
Deptha 3 Train Score 0.8600121046378696 Test Score 0.8293451540352529
Deptha 4 Train Score 0.8630550761023066 Test Score 0.8325749254668131
Deptha 5 Train Score 0.8706316827688239 Test Score 0.8420550237983158
Deptha 6 Train Score 0.8776703055300262 Test Score 0.8509205502379832
Deptha 7 Train Score 0.8856279841294747 Test Score 0.8591061247973221
Deptha 8 Train Score 0.8937818026944028 Test Score 0.8674355353313458
Deptha 9 Train Score 0.9035383649772477 Test Score 0.8730974423348502
Deptha 10 Train Score 0.9145222030440923 Test Score 0.8788378053245463
Deptha 11 Train Score 0.9269518728564704 Test Score 0.881492232857367
Deptha 12 Train Score 0.9404855304745466 Test Score 0.8842381923740782
Deptha 13 Train Score 0.9533691242070341 Test Score 0.8860296040587897
Deptha 14 Train Score 0.9644818542511937 Test Score 0.8871149118677755
Deptha 15 Train Score 0.9721145009078478 Test Score 0.8879648517181861
Deptha 16 Train Score 0.9784806437874067 Test Score 0.8881348396882682
Deptha 17 Train Score 0.9844937347291027 Test Score 0.889115539515665
Deptha 18 Train Score 0.988085898096882 Test Score 0.8890501595271719
Deptha 19 Train Score 0.9907646096254287 Test Score 0.8891547675087609

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{with 25 estimaters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{max\PYZus{}features}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Deptha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
with 25 estimaters
Deptha 1 Train Score 0.8600121046378696 Test Score 0.8293451540352529
Deptha 2 Train Score 0.8600121046378696 Test Score 0.8293451540352529
Deptha 3 Train Score 0.8600121046378696 Test Score 0.8293451540352529
Deptha 4 Train Score 0.8601746206092667 Test Score 0.8295543699984309
Deptha 5 Train Score 0.8634753760283338 Test Score 0.8325749254668131
Deptha 6 Train Score 0.8675382753132636 Test Score 0.8379622365186463
Deptha 7 Train Score 0.874408778104055 Test Score 0.8473377268685601
Deptha 8 Train Score 0.8830333325861335 Test Score 0.8554448454417072
Deptha 9 Train Score 0.8906939992378561 Test Score 0.861198284429102
Deptha 10 Train Score 0.9007251574723723 Test Score 0.8656702756420315
Deptha 11 Train Score 0.9132444912689696 Test Score 0.8699068988963858
Deptha 12 Train Score 0.9284033086010177 Test Score 0.8754118939275066
Deptha 13 Train Score 0.9422507901638609 Test Score 0.8781055494534233
Deptha 14 Train Score 0.9546132119880747 Test Score 0.8796092891887651
Deptha 15 Train Score 0.9666562058685078 Test Score 0.8806161410115592
Deptha 16 Train Score 0.9751126403801753 Test Score 0.8805376850253674
Deptha 17 Train Score 0.9825547510703638 Test Score 0.8841858883832836
Deptha 18 Train Score 0.9873517742260878 Test Score 0.8825121606778598
Deptha 19 Train Score 0.9912241375445517 Test Score 0.8822898687169831

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}76}]:} \PY{n}{param\PYZus{}grid} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{25}\PY{p}{]}\PY{p}{,}
                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{17}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{,}\PY{l+m+mi}{25}\PY{p}{,}\PY{l+m+mi}{35}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{,}\PY{l+m+mi}{70}\PY{p}{]}\PY{p}{\PYZcb{}}
         \PY{n}{model\PYZus{}grid\PYZus{}avgw2v\PYZus{}depth} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}
                             \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}\PY{p}{,}\PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,}
                              \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}grid\PYZus{}avgw2v\PYZus{}depth}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                                              \PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}77}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}grid\PYZus{}avgw2v\PYZus{}depth}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}grid\PYZus{}avgw2v\PYZus{}depth}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}78}]:} \PY{n}{scores\PYZus{}df\PYZus{}train} \PY{o}{=} \PY{n}{scores\PYZus{}df1}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{n}{scores\PYZus{}df\PYZus{}test} \PY{o}{=} \PY{n}{scores\PYZus{}df1}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{n}{scores\PYZus{}df\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{scores\PYZus{}df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{scores\PYZus{}df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{scores\PYZus{}df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{scores\PYZus{}df\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{scores\PYZus{}df\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{final\PYZus{}df} \PY{o}{=} \PY{n}{scores\PYZus{}df\PYZus{}train}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{scores\PYZus{}df\PYZus{}test}\PY{p}{,} \PY{n}{ignore\PYZus{}index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}80}]:} \PY{n}{g} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{FacetGrid}\PY{p}{(}\PY{n}{final\PYZus{}df}\PY{p}{,} \PY{n}{col}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{n\PYZus{}estimators}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{col\PYZus{}wrap}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} 
           \PY{n}{hue}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Score\PYZus{}name}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{sharex}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}\PY{n}{sharey}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}\PY{n}{size} \PY{o}{=} \PY{l+m+mi}{8}\PY{p}{)}\PY{o}{.}\PYZbs{}
            \PY{n+nb}{map}\PY{p}{(}\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{add\PYZus{}legend}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_36_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    We can observe that for each no of estimators, if depth is increasing,
model is overfitting. and for 20 estimators with depth in with depth
\textgreater{}25.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}85}]:} \PY{c+c1}{\PYZsh{}best scores}
         \PY{n}{scores\PYZus{}df1}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}85}]:}     n\_estimators  depth  Test\_score  Test\_std  Train\_score
         58            20     70    0.896479  0.007020     0.999095
         54            20     50    0.896479  0.007020     0.999095
         50            20     35    0.896336  0.007000     0.999079
         46            20     25    0.896263  0.006714     0.998319
         47            25     25    0.894559  0.006800     0.998347
\end{Verbatim}
            
    for Avg Word2vec best score got at n\_ectimators = 20 and depth = 25
with mean cv of 0.896263.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{c+c1}{\PYZsh{}testscore}
         \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{o}{.}\PY{n}{values}\PY{p}{:}
             \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}avg word2vec for }
         \PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{avg\PYZus{}w2v}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{p}{,}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}stacking columns}
         \PY{n}{train\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}
                     \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{column} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}\PY{p}{)}
         \PY{n}{column}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{train\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{n}{column}\PY{p}{)}
         
         
         \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}test}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{o}{.}\PY{n}{values}\PY{p}{:}
             \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}test}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}avg word2vec for }
         \PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300\PYZus{}test} \PY{o}{=} \PY{n}{avg\PYZus{}w2v}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}test}\PY{p}{,}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}stacking columns}
         \PY{n}{test\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300\PYZus{}test}\PY{p}{,}
                     \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{column} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}\PY{p}{)}
         \PY{n}{column}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{test\PYZus{}df\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{test\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{n}{column}\PY{p}{)}
         
         
         \PY{n}{model} \PY{o}{=} \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Predicting training data}
         \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}predict test cv}
         \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{test\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}recall}
         \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}confusion matrix}
         \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{n\PYZus{}estimators=20,max\PYZus{}depth=25}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
n\_estimators=20,max\_depth=25
Train Score 0.997889533971442
Test Score 0.8889438082946609
Test Precision 0.8970036119448542
Test Recall 0.9777092667346848
Test ConfusionMatrix [[ 8956 10123]
 [ 2010 88162]]

    \end{Verbatim}

    \subparagraph{XGBoost}\label{xgboost}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of Estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No of Estimators 0 Train Score 0.1399878953621304 Test Score 0.17065484596474711
No of Estimators 10 Train Score 0.8844735603326533 Test Score 0.8588053768502537
No of Estimators 20 Train Score 0.8895563874380759 Test Score 0.8653302997018673
No of Estimators 30 Train Score 0.8968976261460178 Test Score 0.8743788901093154
No of Estimators 40 Train Score 0.9028658850956042 Test Score 0.8816883728228464
No of Estimators 50 Train Score 0.908088812176369 Test Score 0.8882263716721586
No of Estimators 60 Train Score 0.9120228194839838 Test Score 0.893365238767718
No of Estimators 70 Train Score 0.9152507229158727 Test Score 0.8973272660704011
No of Estimators 80 Train Score 0.9180919504158167 Test Score 0.9009623934306188
No of Estimators 90 Train Score 0.9202102620429938 Test Score 0.9035122129818505

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{80}\PY{p}{,}\PY{l+m+mi}{150}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of Estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No of Estimators 80 Train Score 0.9180919504158167 Test Score 0.9009623934306188
No of Estimators 90 Train Score 0.9202102620429938 Test Score 0.9035122129818505
No of Estimators 100 Train Score 0.9221380377037054 Test Score 0.9060620325330823
No of Estimators 110 Train Score 0.9242731613279236 Test Score 0.908232648151054
No of Estimators 120 Train Score 0.9259655690300599 Test Score 0.9101548198127517
No of Estimators 130 Train Score 0.9277028087243057 Test Score 0.911710863538888
No of Estimators 140 Train Score 0.9288572325211271 Test Score 0.9135676552120927

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{150}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of Estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No of Estimators 150 Train Score 0.9302470242765237 Test Score 0.9147444950049689
No of Estimators 200 Train Score 0.9353466633789872 Test Score 0.9194910821695695
No of Estimators 250 Train Score 0.9391237587142185 Test Score 0.9230216015481981
No of Estimators 300 Train Score 0.9419089462240254 Test Score 0.9252183691615671
No of Estimators 350 Train Score 0.944593261751586 Test Score 0.9268659448715937
No of Estimators 400 Train Score 0.9466779493846809 Test Score 0.9281996966368534
No of Estimators 450 Train Score 0.9484712290690637 Test Score 0.929363460432031

    \end{Verbatim}

    We can obsever if no of estimators incresing then Test and Train scores
also incresing.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{uniform}
         \PY{n}{eta1} \PY{o}{=} \PY{n}{uniform}\PY{o}{.}\PY{n}{rvs}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{with 150 estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{eta1}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{learning\PYZus{}rate}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{150}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score }
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Learning Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
with 150 estimators
Learning Rate 0.8701241366272119 Train Score 0.9562944116921835 Test Score 0.9261467649981694
Learning Rate 0.5822769286725598 Train Score 0.9537950281320751 Test Score 0.9289842564987708
Learning Rate 0.27883894070106907 Train Score 0.9459214095178319 Test Score 0.9268005648831006
Learning Rate 0.18591123209017923 Train Score 0.9403286185021631 Test Score 0.9236754014331293
Learning Rate 0.4111001279251132 Train Score 0.9502420927573917 Test Score 0.930161096291647
Learning Rate 0.11737554713471554 Train Score 0.933211539754769 Test Score 0.917699670484858
Learning Rate 0.684968744374135 Train Score 0.9552576718746497 Test Score 0.9287750405355929
Learning Rate 0.4376110596596504 Train Score 0.9507688686646791 Test Score 0.9294811444113186
Learning Rate 0.5562293251719702 Train Score 0.9528871802918563 Test Score 0.930056488310058
Learning Rate 0.3670803216193239 Train Score 0.9490092129743786 Test Score 0.9290234844918668
Learning Rate 0.40236572881420285 Train Score 0.9500459527919123 Test Score 0.9286573565563052
Learning Rate 0.11304070069439631 Train Score 0.9328192598238103 Test Score 0.9170589465976254
Learning Rate 0.44703084626748935 Train Score 0.9508529286498846 Test Score 0.9291019404780585
Learning Rate 0.5854451165110357 Train Score 0.9535092241823765 Test Score 0.9300695643077567
Learning Rate 0.16198510384493825 Train Score 0.9382831588621641 Test Score 0.9220016737277055

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{c+c1}{\PYZsh{}random search}
         \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{randint} \PY{k}{as} \PY{n}{sp\PYZus{}randint}
         \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{uniform}
         \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{l+m+mi}{25}\PY{p}{)}
         \PY{n}{param\PYZus{}distributions} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{sp\PYZus{}randint}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{learning\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{sp\PYZus{}randint}\PY{p}{(}\PY{l+m+mi}{50}\PY{p}{,}\PY{l+m+mi}{700}\PY{p}{)}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{subsample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mf}{0.7}\PY{p}{,}\PY{l+m+mf}{0.3}\PY{p}{)}\PY{p}{\PYZcb{}}
         \PY{n}{model\PYZus{}random\PYZus{}avgw2v\PYZus{}depth} \PY{o}{=} \PY{n}{RandomizedSearchCV}\PY{p}{(}\PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}\PY{p}{,}
                                                \PY{n}{param\PYZus{}distributions}\PY{o}{=}\PY{n}{param\PYZus{}distributions}\PY{p}{,}\PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{30}\PY{p}{,}
                                                \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}random\PYZus{}avgw2v\PYZus{}depth}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}random\PYZus{}avgw2v\PYZus{}depth}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{learning\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{subsample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}avgw2v\PYZus{}depth}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{learning\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{subsample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}25}]:}     learning\_rate  depth  n\_estimators  subsample  Test\_score  Test\_std  \textbackslash{}
         13       0.510903      4           576   0.927412    0.936679  0.003772   
         2        0.437611      4           550   0.810124    0.936248  0.003834   
         28       0.566830      3           693   0.937182    0.936002  0.004033   
         4        0.406806      3           354   0.797815    0.935876  0.003101   
         3        0.402366      3           309   0.859582    0.935630  0.003431   
         6        0.481343      3           353   0.843264    0.935540  0.003151   
         5        0.699186      4           612   0.950912    0.935052  0.005123   
         16       0.076742      4           458   0.903955    0.934621  0.003908   
         18       0.719055      4           672   0.818962    0.934254  0.004816   
         10       0.456069      3           221   0.857746    0.933883  0.003535   
         17       0.509213      4           210   0.880636    0.933775  0.003687   
         26       0.676561      4           433   0.898262    0.933684  0.004650   
         7        0.631773      4           452   0.793398    0.933123  0.003660   
         8        0.605659      4           285   0.831081    0.932722  0.004069   
         24       0.766994      3           521   0.841719    0.932118  0.004406   
         21       0.650652      3           549   0.705907    0.932001  0.004052   
         12       0.903585      3           613   0.987161    0.931829  0.004628   
         20       0.842154      3           633   0.898623    0.931639  0.005062   
         9        0.281701      4           107   0.900884    0.930646  0.004327   
         1        0.185911      3           186   0.905491    0.930370  0.005146   
         19       0.825139      4           579   0.729381    0.930275  0.004906   
         14       0.666186      4           279   0.726611    0.930142  0.004342   
         15       0.641717      3           117   0.929946    0.929835  0.003231   
         23       0.836928      3           382   0.750712    0.928627  0.004657   
         0        0.870124      3           193   0.783652    0.928161  0.003508   
         11       0.559242      3            64   0.745576    0.926495  0.004264   
         25       0.215064      3           114   0.927762    0.926353  0.005986   
         27       0.094440      3           243   0.733825    0.926163  0.005562   
         22       0.990475      4           434   0.749095    0.925982  0.005695   
         29       0.033683      3           576   0.810164    0.924394  0.006005   
         
             Train\_score  
         13     0.998045  
         2      0.996316  
         28     0.991577  
         4      0.975302  
         3      0.972967  
         6      0.977620  
         5      0.999616  
         16     0.966540  
         18     0.999800  
         10     0.968635  
         17     0.983310  
         26     0.997391  
         7      0.996940  
         8      0.990600  
         24     0.989528  
         21     0.987656  
         12     0.994322  
         20     0.993807  
         9      0.961340  
         1      0.952671  
         19     0.999448  
         14     0.990129  
         15     0.961299  
         23     0.983342  
         0      0.971065  
         11     0.948061  
         25     0.946190  
         27     0.945670  
         22     0.997964  
         29     0.942891  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{colm} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
         \PY{n}{colm}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    We can observe from above that learning rate between 0.4-0.6 giving good
score and if we are incresing no of estimaters model efficiency is
incresing.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{n}{fig}\PY{p}{,} \PY{n}{axes} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,}\PY{n}{sharex}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{)}\PY{p}{)}
         \PY{k}{for} \PY{n}{ax}\PY{p}{,}\PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{axes}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{colm}\PY{p}{)}\PY{p}{:}
             \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{30}\PY{p}{)}\PY{p}{,}\PY{n}{scores\PYZus{}df}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
             \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{n}{i}\PY{p}{)}
             \PY{k}{if} \PY{n}{i} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                 \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Iteration no in random search}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{k}{if} \PY{n}{i} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{learning\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                 \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{iteration no vs params and scores}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_52_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{param\PYZus{}grid} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{]}\PY{p}{,}
                       \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mi}{560}\PY{p}{,}\PY{l+m+mi}{800}\PY{p}{,}\PY{l+m+mi}{900}\PY{p}{]}\PY{p}{,}
                       \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{subsample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mf}{0.8}\PY{p}{,}\PY{l+m+mf}{0.93}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{\PYZcb{}}
         \PY{n}{model\PYZus{}grid\PYZus{}avgw2v} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}
                             \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}
                                             \PY{n}{learning\PYZus{}rate}\PY{o}{=}\PY{l+m+mf}{0.52}\PY{p}{,}
                                             \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}\PY{p}{,}
                                             \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,}
                                     \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}
                                                 \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}grid\PYZus{}avgw2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                                          \PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}grid\PYZus{}avgw2v\PYZus{}depth}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{subsample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}grid\PYZus{}avgw2v\PYZus{}depth}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{subsample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}32}]:}     n\_estimators  depth  subsample  Test\_score  Test\_std  Train\_score
         7            900      5       0.93    0.939139  0.002537     1.000000
         8            900      5       1.00    0.938992  0.002336     1.000000
         4            800      5       0.93    0.938897  0.002644     1.000000
         5            800      5       1.00    0.938690  0.002465     1.000000
         13           800      7       0.93    0.938440  0.002398     1.000000
         17           900      7       1.00    0.938435  0.002192     1.000000
         16           900      7       0.93    0.938414  0.002297     1.000000
         14           800      7       1.00    0.938289  0.002245     1.000000
         12           800      7       0.80    0.937883  0.002347     1.000000
         15           900      7       0.80    0.937823  0.002401     1.000000
         6            900      5       0.80    0.937797  0.003259     1.000000
         1            560      5       0.93    0.937754  0.003156     0.999996
         10           560      7       0.93    0.937633  0.002251     1.000000
         11           560      7       1.00    0.937594  0.002246     1.000000
         2            560      5       1.00    0.937421  0.002853     0.999992
         26           900      9       1.00    0.937361  0.002619     1.000000
         3            800      5       0.80    0.937331  0.003446     1.000000
         23           800      9       1.00    0.937223  0.002627     1.000000
         9            560      7       0.80    0.937124  0.002138     1.000000
         25           900      9       0.93    0.936925  0.002573     1.000000
         22           800      9       0.93    0.936692  0.002666     1.000000
         20           560      9       1.00    0.936657  0.002620     1.000000
         24           900      9       0.80    0.936537  0.002635     1.000000
         21           800      9       0.80    0.936308  0.002734     1.000000
         0            560      5       0.80    0.936278  0.003660     0.999995
         19           560      9       0.93    0.935881  0.002666     1.000000
         18           560      9       0.80    0.935687  0.002820     1.000000
\end{Verbatim}
            
    Got best cv scores at no of estimators = 900, depth = 5, learning rate =
0.52 and subsample = 0.93 with mean cv score of 0.939139.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{c+c1}{\PYZsh{}testscore}
         \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{o}{.}\PY{n}{values}\PY{p}{:}
             \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}avg word2vec for }
         \PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{avg\PYZus{}w2v}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{p}{,}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}stacking columns}
         \PY{n}{train\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}
                     \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{column} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}\PY{p}{)}
         \PY{n}{column}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{train\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{n}{column}\PY{p}{)}
         
         
         \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}test}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{o}{.}\PY{n}{values}\PY{p}{:}
             \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}test}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}avg word2vec for }
         \PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300\PYZus{}test} \PY{o}{=} \PY{n}{avg\PYZus{}w2v}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}test}\PY{p}{,}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}stacking columns}
         \PY{n}{test\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300\PYZus{}test}\PY{p}{,}
                     \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{column} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}\PY{p}{)}
         \PY{n}{column}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{test\PYZus{}df\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{test\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{n}{column}\PY{p}{)}
         
         
         \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,}\PY{n}{learning\PYZus{}rate}\PY{o}{=}\PY{l+m+mf}{0.52}\PY{p}{,}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{900}\PY{p}{,}
                                          \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{subsample}\PY{o}{=}\PY{l+m+mf}{0.93}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Predicting training data}
         \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}predict test cv}
         \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{test\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}recall}
         \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}confusion matrix}
         \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}\PY{l+s+s2}{max\PYZus{}depth=5,learning\PYZus{}rate=0.52,n\PYZus{}estimators=900,subsample=0.93}\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
max\_depth=5,learning\_rate=0.52,n\_estimators=900,subsample=0.93
Train Score 1.0
Test Score 0.9303164273095899
Test Precision 0.9402160582696143
Test Recall 0.9777425364858271
Test ConfusionMatrix [[13473  5606]
 [ 2007 88165]]

    \end{Verbatim}

    \subsubsection{Tf-Idf Word2Vec}\label{tf-idf-word2vec}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{base} \PY{k}{import} \PY{n}{BaseEstimator}\PY{p}{,} \PY{n}{TransformerMixin}
         
         \PY{k}{class} \PY{n+nc}{TfidfWeightedWord2Vec}\PY{p}{(}\PY{n}{BaseEstimator}\PY{p}{,} \PY{n}{TransformerMixin}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
         \PY{l+s+sd}{    Class for Tfidf Weighted Word2Vec Calculations}
         \PY{l+s+sd}{    \PYZsq{}\PYZsq{}\PYZsq{}}
             \PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{word2vec}\PY{p}{)}\PY{p}{:}
                 \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{word2vec} \PY{o}{=} \PY{n}{word2vec}
                 \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{word2weight} \PY{o}{=} \PY{k+kc}{None}
                 \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dim} \PY{o}{=} \PY{n}{word2vec}\PY{o}{.}\PY{n}{vector\PYZus{}size}
                 \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tfidf} \PY{o}{=} \PY{k+kc}{None}
         
             \PY{k}{def} \PY{n+nf}{fit}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
                 \PY{n}{tfidf} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{p}{)}
                 \PY{n}{tfidf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tfidf} \PY{o}{=} \PY{n}{tfidf}
                 \PY{c+c1}{\PYZsh{}print(self.word2vec.wv.vocab.keys())}
                 \PY{k}{return} \PY{n+nb+bp}{self}
             
             \PY{k}{def} \PY{n+nf}{tf\PYZus{}idf\PYZus{}W2V}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,}\PY{n}{feature\PYZus{}names}\PY{p}{,}\PY{n}{tf\PYZus{}idf\PYZus{}trans\PYZus{}arr}\PY{p}{,}\PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{)}\PY{p}{:}
                 \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
         \PY{l+s+sd}{        tfidf weighted word2vec calculation}
         \PY{l+s+sd}{        \PYZsq{}\PYZsq{}\PYZsq{}}
                 \PY{k+kn}{import} \PY{n+nn}{operator}
                 \PY{n}{dict\PYZus{}tfidf} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{k}\PY{p}{:} \PY{n}{v} \PY{k}{for} \PY{n}{v}\PY{p}{,} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{)}\PY{p}{\PYZcb{}}
                 \PY{n}{sent\PYZus{}vectors} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                 \PY{n}{i} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{:} \PY{c+c1}{\PYZsh{} for each review/sentence}
                     \PY{n}{doc} \PY{o}{=} \PY{p}{[}\PY{n}{word} \PY{k}{for} \PY{n}{word} \PY{o+ow}{in} \PY{n}{sent} \PY{k}{if} \PY{n}{word} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{word2vec}\PY{o}{.}\PY{n}{wv}\PY{o}{.}\PY{n}{vocab}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{]}
                     \PY{k}{if} \PY{n}{doc}\PY{p}{:}
                         \PY{c+c1}{\PYZsh{}itemgetter}
                         \PY{n}{f} \PY{o}{=} \PY{n}{operator}\PY{o}{.}\PY{n}{itemgetter}\PY{p}{(}\PY{o}{*}\PY{n}{doc}\PY{p}{)}
                         \PY{k}{try}\PY{p}{:}
                             \PY{c+c1}{\PYZsh{}itemgetter from dict}
                             \PY{n}{final} \PY{o}{=} \PY{n}{f}\PY{p}{(}\PY{n}{dict\PYZus{}tfidf}\PY{p}{)}
                             \PY{n}{final} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}trans\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{n}{final}\PY{p}{]}
                             \PY{c+c1}{\PYZsh{}converting to dense}
                             \PY{n}{final} \PY{o}{=} \PY{n}{final}\PY{o}{.}\PY{n}{toarray}\PY{p}{(}\PY{p}{)}
                             \PY{c+c1}{\PYZsh{}converting to diagnol matrix for multiplication}
                             \PY{n}{final}\PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{diag}\PY{p}{(}\PY{n}{final}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                             \PY{n}{sent\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{final}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{word2vec}\PY{o}{.}\PY{n}{wv}\PY{p}{[}\PY{n}{doc}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                             \PY{c+c1}{\PYZsh{}tfidf weighted word to vec}
                             \PY{n}{sent\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{sent\PYZus{}vec}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)} \PY{o}{/} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{final}\PY{p}{)}
                         \PY{k}{except}\PY{p}{:}
                             \PY{n}{sent\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dim}\PY{p}{)}             
                     \PY{k}{else}\PY{p}{:}
                         \PY{n}{sent\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dim}\PY{p}{)}
                     \PY{n}{sent\PYZus{}vectors}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent\PYZus{}vec}\PY{p}{)}
                     \PY{n}{i} \PY{o}{=} \PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}
                 \PY{k}{return} \PY{n}{sent\PYZus{}vectors}
         
             \PY{k}{def} \PY{n+nf}{transform}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{X}\PY{p}{)}\PY{p}{:}
                 \PY{c+c1}{\PYZsh{}transform data}
                 \PY{n}{tf\PYZus{}idf\PYZus{}trans\PYZus{}arr} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tfidf}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                 \PY{n}{feature\PYZus{}names} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tfidf}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
                 \PY{n}{list\PYZus{}of\PYZus{}sent} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                 \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}
                     \PY{n}{list\PYZus{}of\PYZus{}sent}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
                 \PY{n}{temp\PYZus{}vec} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tf\PYZus{}idf\PYZus{}W2V}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{,}\PY{n}{tf\PYZus{}idf\PYZus{}trans\PYZus{}arr}\PY{p}{,}\PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{)}
                 \PY{n}{temp\PYZus{}vec}\PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{temp\PYZus{}vec}\PY{p}{,}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                 \PY{k}{return} \PY{n}{temp\PYZus{}vec}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{c+c1}{\PYZsh{} For simple cv}
         \PY{c+c1}{\PYZsh{}Train data}
         \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{X\PYZus{}test\PYZus{}cv} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}transforming to tfidf weighted word2vec}
         \PY{n}{tfidfvect\PYZus{}w2v} \PY{o}{=} \PY{n}{TfidfWeightedWord2Vec}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{)}
         \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{X\PYZus{}train\PYZus{}tfw2v} \PY{o}{=} \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{X\PYZus{}cv\PYZus{}tfw2v} \PY{o}{=} \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
\end{Verbatim}


    \subparagraph{Random Forest}\label{random-forest}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{c+c1}{\PYZsh{}base model}
         \PY{n}{model} \PY{o}{=} \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}train score}
         \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test score}
         \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}cv\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Train Score 0.9790018156956805
Test Score 0.8738950781944662

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}cv\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of Estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No of Estimators 1 Train Score 0.9284873685862232 Test Score 0.8177336680788744
No of Estimators 6 Train Score 0.974675528457107 Test Score 0.8645980438307442
No of Estimators 11 Train Score 0.977847391898859 Test Score 0.8718682985511794
No of Estimators 16 Train Score 0.9804756674362826 Test Score 0.8768633296720539
No of Estimators 21 Train Score 0.9805148954293784 Test Score 0.8747319420471782
No of Estimators 26 Train Score 0.981316267288337 Test Score 0.8770463936398347
No of Estimators 31 Train Score 0.9813554952814328 Test Score 0.8756603378837805
No of Estimators 36 Train Score 0.9816188832350765 Test Score 0.8775171295569852
No of Estimators 41 Train Score 0.9816188832350765 Test Score 0.8759349338354516
No of Estimators 46 Train Score 0.9817365672143642 Test Score 0.8774648255661907
No of Estimators 51 Train Score 0.9817421712133778 Test Score 0.8756864898791777
No of Estimators 56 Train Score 0.9817813992064738 Test Score 0.8770594696375333
No of Estimators 61 Train Score 0.9817757952074601 Test Score 0.8755688058998902
No of Estimators 66 Train Score 0.9817926072045011 Test Score 0.877072545635232
No of Estimators 71 Train Score 0.9817926072045011 Test Score 0.8760003138239447
No of Estimators 76 Train Score 0.9817982112035148 Test Score 0.876967937653643
No of Estimators 81 Train Score 0.9817982112035148 Test Score 0.8759349338354516
No of Estimators 86 Train Score 0.9817982112035148 Test Score 0.8771902296145195
No of Estimators 91 Train Score 0.9818038152025286 Test Score 0.8762749097756158
No of Estimators 96 Train Score 0.9817982112035148 Test Score 0.8771379256237251

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{c+c1}{\PYZsh{}random search}
         \PY{n}{param\PYZus{}distributions} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{sp\PYZus{}randint}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}\PY{p}{\PYZcb{}}
         \PY{n}{model\PYZus{}random\PYZus{}tfidfw2v} \PY{o}{=} \PY{n}{RandomizedSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}
                                   \PY{n}{TfidfWeightedWord2Vec}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{)}\PY{p}{,}
                                  \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                 \PY{n}{param\PYZus{}distributions}\PY{o}{=}\PY{n}{param\PYZus{}distributions}\PY{p}{,}\PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{60}\PY{p}{,}
                                 \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}random\PYZus{}tfidfw2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}tfw2v}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}random\PYZus{}tfidfw2v}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}tfidfw2v}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{n\PYZus{}estimators}\PY{p}{,}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{Train\PYZus{}score}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{n\PYZus{}estimators}\PY{p}{,}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{Test\PYZus{}score}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Validation curve for Tf\PYZhy{}IdfW2V model with different no of estimates with RF}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}22}]:} <matplotlib.legend.Legend at 0x14850adf3048>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_66_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{c+c1}{\PYZsh{}best scores}
         \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}46}]:}     n\_estimators  Test\_score  Test\_std  Train\_score
         46            56    0.884962  0.009991     0.984384
         35            62    0.884918  0.010046     0.984405
         15            52    0.884914  0.010177     0.984378
         58            58    0.884841  0.010031     0.984390
         18           114    0.884448  0.009929     0.984432
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n}{param\PYZus{}distributions} \PY{o}{=} \PY{p}{\PYZob{}}
             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{sp\PYZus{}randint}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{70}\PY{p}{)}\PY{p}{,}
             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{sp\PYZus{}randint}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{30}\PY{p}{)}\PY{p}{,}
             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}min\PYZus{}samples\PYZus{}split}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{sp\PYZus{}randint}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{,}
             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}class\PYZus{}weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{k+kc}{None}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{balanced}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{\PYZcb{}}
         \PY{n}{model\PYZus{}random\PYZus{}tfidfw2v} \PY{o}{=} \PY{n}{RandomizedSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}
                                   \PY{n}{TfidfWeightedWord2Vec}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{)}\PY{p}{,}
                                  \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                 \PY{n}{param\PYZus{}distributions}\PY{o}{=}\PY{n}{param\PYZus{}distributions}\PY{p}{,}\PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,}
                                 \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}random\PYZus{}tfidfw2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}tfw2v}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}random\PYZus{}tfidfw2v\PYZus{}all}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}min\PYZus{}samples\PYZus{}split}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}class\PYZus{}weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}tfidfw2v\PYZus{}all}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min\PYZus{}samples\PYZus{}split}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class\PYZus{}weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}49}]:}     n\_estimators  depth  min\_samples\_split class\_weight  Test\_score  Test\_std  \textbackslash{}
         0             64     29                  7         None    0.883093  0.010659   
         55            49     28                  6         None    0.882808  0.010204   
         85            64     24                  5         None    0.881937  0.010730   
         71            61     24                  3         None    0.881906  0.010798   
         44            23     26                  4         None    0.881863  0.010971   
         
             Train\_score  
         0      0.979521  
         55     0.980000  
         85     0.978783  
         71     0.980478  
         44     0.979109  
\end{Verbatim}
            
    We can observe that for no of estimators based on depth scores are
changing and best score got at n\_estimators at 56 and test cv is
0.884962

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}50}]:} \PY{c+c1}{\PYZsh{}testscore}
         \PY{c+c1}{\PYZsh{}transforming to tfidf weighted word2vec}
         \PY{n}{tfidfvect\PYZus{}w2v} \PY{o}{=} \PY{n}{TfidfWeightedWord2Vec}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{)}
         \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{X\PYZus{}train\PYZus{}tfw2v} \PY{o}{=} \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{X\PYZus{}cv\PYZus{}tfw2v} \PY{o}{=} \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
         
         \PY{n}{model} \PY{o}{=} \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{56}\PY{p}{)}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Predicting training data}
         \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}predict test cv}
         \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}cv\PYZus{}tfw2v}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}recall}
         \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}confusion matrix}
         \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{56}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
n\_estimators 56
Train Score 0.9796524399811706
Test Score 0.8709485496700259
Test Precision 0.8726985900036254
Test Recall 0.9877234618285056
Test ConfusionMatrix [[ 6087 12992]
 [ 1107 89065]]

    \end{Verbatim}

    \subparagraph{Xg Boost}\label{xg-boost}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{X\PYZus{}train\PYZus{}tfw2v} \PY{o}{=} \PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{float}\PY{p}{)}
         \PY{n}{X\PYZus{}cv\PYZus{}tfw2v} \PY{o}{=} \PY{n}{X\PYZus{}cv\PYZus{}tfw2v}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{float}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}64}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}cv\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of Estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No of Estimators 0 Train Score 0.1399878953621304 Test Score 0.17065484596474711
No of Estimators 10 Train Score 0.8740277061711237 Test Score 0.84591244311941
No of Estimators 20 Train Score 0.8791217412745735 Test Score 0.8521627700193525
No of Estimators 30 Train Score 0.8847537602833382 Test Score 0.8581908049584184
No of Estimators 40 Train Score 0.8902961153078837 Test Score 0.8641142319158952
No of Estimators 50 Train Score 0.8953509224182377 Test Score 0.8695930749516189
No of Estimators 60 Train Score 0.8985956378471678 Test Score 0.8736989382289869
No of Estimators 70 Train Score 0.901431261348098 Test Score 0.8769810136513416
No of Estimators 80 Train Score 0.9036168209634395 Test Score 0.879818505151943
No of Estimators 90 Train Score 0.9063739884781781 Test Score 0.8818452847952298

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{100}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}cv\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of Estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}  
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No of Estimators 100 Train Score 0.907831028221739 Test Score 0.883754380459229
No of Estimators 150 Train Score 0.9155925668557082 Test Score 0.8910115591819656
No of Estimators 200 Train Score 0.9202550940351034 Test Score 0.8957450703488676
No of Estimators 250 Train Score 0.9233316894936227 Test Score 0.8984779538678801
No of Estimators 300 Train Score 0.9258422810517586 Test Score 0.9008708614467283
No of Estimators 350 Train Score 0.9279942166730178 Test Score 0.902453057168262
No of Estimators 400 Train Score 0.929669812378113 Test Score 0.903878340917412
No of Estimators 450 Train Score 0.9312501400999753 Test Score 0.9051728646895758

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}cv\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of Estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}  
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No of Estimators 500 Train Score 0.9327239918405774 Test Score 0.9060881845284795
No of Estimators 550 Train Score 0.9341361995920289 Test Score 0.9069381243788901
No of Estimators 600 Train Score 0.9353410593799736 Test Score 0.9075396202730268
No of Estimators 650 Train Score 0.9363497792024389 Test Score 0.9080757361786704
No of Estimators 700 Train Score 0.9373584990249042 Test Score 0.9088733720382866
No of Estimators 750 Train Score 0.9381262468897805 Test Score 0.9091871959830535
No of Estimators 800 Train Score 0.9390284907309856 Test Score 0.9096840838956012
No of Estimators 850 Train Score 0.9398915065790948 Test Score 0.9101286678173545
No of Estimators 900 Train Score 0.940939454394656 Test Score 0.9106647837229981
No of Estimators 950 Train Score 0.9417856582457241 Test Score 0.9108216956953815

    \end{Verbatim}

    With increase in no of estimatores test score is incresing.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{learning\PYZus{}rate}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}cv\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of Estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}  
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No of Estimators 500 Train Score 0.9558012597789782 Test Score 0.9105732517391077
No of Estimators 550 Train Score 0.9579980273923472 Test Score 0.9108478476907788
No of Estimators 600 Train Score 0.9597016430925108 Test Score 0.9108478476907788
No of Estimators 650 Train Score 0.9616406267512497 Test Score 0.9110962916470526
No of Estimators 700 Train Score 0.9634283024366188 Test Score 0.9117762435273812
No of Estimators 750 Train Score 0.964918966174262 Test Score 0.9113447356033265
No of Estimators 800 Train Score 0.9664096299119052 Test Score 0.9115277995711073
No of Estimators 850 Train Score 0.9679171056465894 Test Score 0.9115408755688059
No of Estimators 900 Train Score 0.9692116294187533 Test Score 0.9122862074376274
No of Estimators 950 Train Score 0.9705397771849992 Test Score 0.9121031434698468

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{p}{[}\PY{l+m+mi}{700}\PY{p}{,}\PY{l+m+mi}{900}\PY{p}{,}\PY{l+m+mi}{950}\PY{p}{]}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{learning\PYZus{}rate}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,}
                             \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{reg\PYZus{}alpha}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{reg\PYZus{}lambda}\PY{o}{=}\PY{l+m+mf}{0.7}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}cv\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of Estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}  
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No of Estimators 700 Train Score 0.9641400103113582 Test Score 0.9118023955227784
No of Estimators 900 Train Score 0.9698560893053283 Test Score 0.912652335373189
No of Estimators 950 Train Score 0.9709376611149716 Test Score 0.9128877033317642

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{p}{[}\PY{l+m+mi}{700}\PY{p}{,}\PY{l+m+mi}{900}\PY{p}{,}\PY{l+m+mi}{950}\PY{p}{]}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{learning\PYZus{}rate}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,}
                     \PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{l+m+mi}{6}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{reg\PYZus{}alpha}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{,} \PY{n}{reg\PYZus{}lambda}\PY{o}{=}\PY{l+m+mf}{0.7}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}cv\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of Estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}  
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No of Estimators 700 Train Score 0.9815628432449396 Test Score 0.9140383911292431
No of Estimators 900 Train Score 0.9816581112281724 Test Score 0.9146137350279826
No of Estimators 950 Train Score 0.9816973392212683 Test Score 0.9145222030440923

    \end{Verbatim}

    We can observe from initial simple cv that incresing the estimators are
incresing test scores and there is impact of test scores with
regularization and learning rate is also incresing the test score

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{k+kn}{from} \PY{n+nn}{xgboost} \PY{k}{import} \PY{n}{XGBClassifier}
         \PY{n}{param\PYZus{}distributions} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{sp\PYZus{}randint}\PY{p}{(}\PY{l+m+mi}{600}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{sp\PYZus{}randint}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}learning\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}subsample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}reg\PYZus{}alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}reg\PYZus{}lambda}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                               \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}colsample\PYZus{}bylevel}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mf}{0.7}\PY{p}{,}\PY{l+m+mf}{0.3}\PY{p}{)}\PY{p}{\PYZcb{}}
         \PY{n}{model\PYZus{}random\PYZus{}tfidfw2v\PYZus{}xgb} \PY{o}{=} \PY{n}{RandomizedSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}
                                   \PY{n}{TfidfWeightedWord2Vec}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{)}\PY{p}{,}
                                     \PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                 \PY{n}{param\PYZus{}distributions}\PY{o}{=}\PY{n}{param\PYZus{}distributions}\PY{p}{,}\PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{30}\PY{p}{,}
                                 \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}random\PYZus{}tfidfw2v\PYZus{}xgb}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}tfw2v}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}random\PYZus{}tfidfw2v\PYZus{}xgb}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}subsample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}colsample\PYZus{}bylevel}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}learning\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}reg\PYZus{}alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}reg\PYZus{}lambda}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}tfidfw2v\PYZus{}xgb}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{subsample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{colsample\PYZus{}bylevel}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{learning\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg\PYZus{}alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg\PYZus{}lambda}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}22}]:}     n\_estimators  depth  subsample  colsample\_bylevel  learning\_rate  \textbackslash{}
         20           884      4   0.994481           0.791814       0.229976   
         6            906      5   0.524254           0.885013       0.151921   
         3            903      7   0.849676           0.776976       0.231515   
         21           667      3   0.960319           0.737489       0.351055   
         19           894      3   0.328739           0.822887       0.109562   
         
             reg\_alpha  reg\_lambda  Test\_score  Test\_std  Train\_score  
         20   0.998268    0.150014    0.920558  0.006677     0.978847  
         6    0.644862    0.309258    0.920411  0.006462     0.982022  
         3    0.477546    0.631773    0.919302  0.005702     0.984339  
         21   0.323604    0.806417    0.919064  0.006489     0.967847  
         19   0.973815    0.752860    0.918870  0.007118     0.953416  
\end{Verbatim}
            
    from random search got good score at n\_estimators = 884, depth = 4,
subsample = 0.994481, colsample\_bylevel=0.791814, learning\_rate =
0.229976, reg\_alpha = 0.998268, reg\_lambda = 0.150014 and Test\_score
is 0.920558

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{c+c1}{\PYZsh{}testscore}
         \PY{c+c1}{\PYZsh{}transforming to tfidf weighted word2vec}
         \PY{n}{tfidfvect\PYZus{}w2v} \PY{o}{=} \PY{n}{TfidfWeightedWord2Vec}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{)}
         \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{X\PYZus{}train\PYZus{}tfw2v} \PY{o}{=} \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{X\PYZus{}cv\PYZus{}tfw2v} \PY{o}{=} \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
         
         \PY{n}{model}  \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{884}\PY{p}{,}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{,}
                                    \PY{n}{subsample}\PY{o}{=}\PY{l+m+mf}{0.994481}\PY{p}{,}
                                    \PY{n}{colsample\PYZus{}bylevel}\PY{o}{=}\PY{l+m+mf}{0.791814}\PY{p}{,}
                                    \PY{n}{learning\PYZus{}rate}\PY{o}{=}\PY{l+m+mf}{0.229976}\PY{p}{,}\PY{n}{reg\PYZus{}alpha}\PY{o}{=}\PY{l+m+mf}{0.998268}\PY{p}{,}
                                    \PY{n}{reg\PYZus{}lambda} \PY{o}{=} \PY{l+m+mf}{0.150014}\PY{p}{)}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Predicting training data}
         \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}predict test cv}
         \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}cv\PYZus{}tfw2v}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}recall}
         \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}confusion matrix}
         \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Depth 9
Train Score 0.9620547622783618
Test Score 0.9055477753064045
Test Precision 0.9101124749627652
Test Recall 0.9826110100696447
Test ConfusionMatrix [[10328  8751]
 [ 1568 88604]]

    \end{Verbatim}

    \paragraph{Bag of Words:}\label{bag-of-words}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{c+c1}{\PYZsh{}BoW with cleaned data and without stopwords}
         \PY{c+c1}{\PYZsh{}simple cv for train data}
         \PY{n}{scores\PYZus{}train} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{corpus} \PY{k}{import} \PY{n}{stopwords}
         \PY{n}{stop} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{stopwords}\PY{o}{.}\PY{n}{words}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{not}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{very}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}CountVectorizer for BoW}
         \PY{n}{count\PYZus{}vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stop}\PY{p}{)}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{int8}\PY{p}{)}
         \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{X\PYZus{}test\PYZus{}cv} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{final\PYZus{}counts\PYZus{}train} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}
                 \PY{n}{X\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test}
         \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
\end{Verbatim}


    \subparagraph{Random Forest:}\label{random-forest}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{c+c1}{\PYZsh{}base model}
         \PY{n}{model} \PY{o}{=} \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}train score}
         \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test score}
         \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Train Score 0.9972204164892067
Test Score 0.8877294837596108

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of Estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No of Estimators 1 Train Score 0.9418921342269844 Test Score 0.8236440190386527
No of Estimators 2 Train Score 0.9373136670327946 Test Score 0.7947199121292955
No of Estimators 3 Train Score 0.9773766559817085 Test Score 0.8608452324912391
No of Estimators 4 Train Score 0.9852726905920065 Test Score 0.8612505884198964
No of Estimators 5 Train Score 0.9875198941964987 Test Score 0.8727574663946859
No of Estimators 6 Train Score 0.9932191611934277 Test Score 0.8796877451749568
No of Estimators 7 Train Score 0.9916948734617023 Test Score 0.8778963334902453
No of Estimators 8 Train Score 0.9960323686983031 Test Score 0.8851404362152833
No of Estimators 9 Train Score 0.9943567729932079 Test Score 0.8803938490506825
No of Estimators 10 Train Score 0.9972204164892067 Test Score 0.8877294837596108
No of Estimators 11 Train Score 0.9958138127367689 Test Score 0.8814399288665725
No of Estimators 12 Train Score 0.9980498083432338 Test Score 0.8878863957319943
No of Estimators 13 Train Score 0.9968841765483849 Test Score 0.8812307129033945
No of Estimators 14 Train Score 0.9983972562820829 Test Score 0.8874287358125424
No of Estimators 15 Train Score 0.9975454484320011 Test Score 0.8811522569172028
No of Estimators 16 Train Score 0.9987559122189594 Test Score 0.8874287358125424
No of Estimators 17 Train Score 0.9981282643294255 Test Score 0.8819760447722161
No of Estimators 18 Train Score 0.9989352401873978 Test Score 0.88821329567446
No of Estimators 19 Train Score 0.9984757122682747 Test Score 0.8819760447722161

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{with 14 estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{p}{[}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{25}\PY{p}{,}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{,}\PY{l+m+mi}{200}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{,}\PY{l+m+mi}{400}\PY{p}{]}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{14}\PY{p}{,}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
with 14 estimators
Depth 5 Train Score 0.8600121046378696 Test Score 0.8293451540352529
Depth 8 Train Score 0.8600233126358969 Test Score 0.8293451540352529
Depth 10 Train Score 0.8600569366299792 Test Score 0.8293713060306501
Depth 20 Train Score 0.8624890722019233 Test Score 0.8304958418327318
Depth 25 Train Score 0.8648819797807715 Test Score 0.8318034416025942
Depth 30 Train Score 0.8687487391002219 Test Score 0.8338956012343742
Depth 50 Train Score 0.8927954988679923 Test Score 0.843127255609603
Depth 100 Train Score 0.9512171885857749 Test Score 0.8656310476489356
Depth 200 Train Score 0.9900136737575934 Test Score 0.8815183848527642
Depth 300 Train Score 0.9969794445316178 Test Score 0.8877556357550082
Depth 400 Train Score 0.9983019882988501 Test Score 0.8896778074167059

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{with 14 estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{p}{[}\PY{l+m+mi}{400}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{600}\PY{p}{,}\PY{l+m+mi}{700}\PY{p}{,}\PY{l+m+mi}{800}\PY{p}{]}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{14}\PY{p}{,}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
with 14 estimators
Depth 400 Train Score 0.9983019882988501 Test Score 0.8896778074167059
Depth 500 Train Score 0.9983356122929322 Test Score 0.887794863748104
Depth 600 Train Score 0.9983692362870145 Test Score 0.8885794236100214
Depth 700 Train Score 0.9983972562820829 Test Score 0.8874287358125424
Depth 800 Train Score 0.9983972562820829 Test Score 0.8874287358125424

    \end{Verbatim}

    We can observe that with increase in no of estimators score is incresing
and with high variance base models score is increasing.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{param\PYZus{}distributions} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{sp\PYZus{}randint}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{)}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{sp\PYZus{}randint}\PY{p}{(}\PY{l+m+mi}{50}\PY{p}{,}\PY{l+m+mi}{600}\PY{p}{)}\PY{p}{\PYZcb{}}
         \PY{n}{model\PYZus{}random\PYZus{}bow} \PY{o}{=} \PY{n}{RandomizedSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}
                                 \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stop}\PY{p}{)}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{int8}\PY{p}{)}\PY{p}{,}
                                 \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                 \PY{n}{param\PYZus{}distributions}\PY{o}{=}\PY{n}{param\PYZus{}distributions}\PY{p}{,}
                                 \PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{50}\PY{p}{,}
                                 \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}random\PYZus{}bow}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}random\PYZus{}bow}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}bow}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}20}]:}     n\_estimators  depth  Test\_score  Test\_std  Train\_score
         17            28    483    0.891749  0.007396     0.999524
         49            26    434    0.891680  0.007370     0.999376
         45            28    389    0.891253  0.007705     0.999268
         37            34    479    0.891046  0.007578     0.999683
         18            40    404    0.890343  0.007515     0.999657
         12            26    251    0.890006  0.008157     0.996093
         35            54    564    0.889657  0.008277     0.999923
         13            60    542    0.889411  0.008074     0.999951
         41            66    567    0.889324  0.008297     0.999961
         15            20    210    0.889212  0.008916     0.992222
\end{Verbatim}
            
    Best cv score got at no of estimators = 28, depth = 483 and Test cv
score is 0.891749

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{c+c1}{\PYZsh{}Test scores}
         \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{corpus} \PY{k}{import} \PY{n}{stopwords}
         \PY{n}{stop} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{stopwords}\PY{o}{.}\PY{n}{words}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{not}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{very}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}CountVectorizer for BoW}
         \PY{n}{count\PYZus{}vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stop}\PY{p}{)}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{int8}\PY{p}{)}
         \PY{n}{final\PYZus{}counts\PYZus{}train} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}
                 \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test}
         \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
         \PY{n}{model} \PY{o}{=} \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{l+m+mi}{483}\PY{p}{)}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Predicting training data}
         \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}predict test cv}
         \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}recall}
         \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}confusion matrix}
         \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{n\PYZus{}estimators=28,max\PYZus{}depth=483}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
n\_estimators=28,max\_depth=483
Train Score 0.9995606464773262
Test Score 0.8887058242029822
Test Precision 0.8856493153393643
Test Recall 0.9934236791908797
Test ConfusionMatrix [[ 7513 11566]
 [  593 89579]]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{k+kn}{import} \PY{n+nn}{operator}
         \PY{n}{importances} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{feature\PYZus{}importances\PYZus{}}
         \PY{n}{features} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
         \PY{n}{dict\PYZus{}feature} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n}{features}\PY{p}{,}\PY{n}{importances}\PY{p}{)}\PY{p}{)}
         \PY{n}{sorted\PYZus{}feature} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n}{dict\PYZus{}feature}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{key}\PY{o}{=}\PY{n}{operator}\PY{o}{.}\PY{n}{itemgetter}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{reverse}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{c+c1}{\PYZsh{}To 100 features to seperate the data using Bag of words with RF}
         \PY{n}{list\PYZus{}feature} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{sorted\PYZus{}feature}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{100}\PY{p}{]}
         \PY{n}{list\PYZus{}fval} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{sorted\PYZus{}feature}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{100}\PY{p}{]}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{list\PYZus{}feature}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
['not', 'great', 'disappointed', 'terrible', 'love', 'wa', 'horrible', 'best', 'awful', 'worst', 'money', 'good', 'disappointing', 'delicious', 'bad', 'waste', 'taste', 'return', 'disgusting', 'yuck', 'like', 'would', 'disappointment', 'stale', 'product', 'excellent', 'poor', 'perfect', 'thought', 'beware', 'threw', 'very', 'flavor', 'received', 'didnt', 'one', 'favorite', 'dont', 'gross', 'unfortunately', 'buy', 'refund', 'wonderful', 'nasty', 'find', 'price', 'box', 'nothing', 'ha', 'misleading', 'china', 'nice', 'description', 'easy', 'weak', 'amazon', 'bland', 'get', 'make', 'maybe', 'much', 'tasteless', 'overpriced', 'even', 'really', 'tasted', 'coffee', 'ordered', 'store', 'item', 'review', 'time', 'tasty', 'wont', 'opened', 'bought', 'little', 'better', 'away', 'worse', 'use', 'food', 'yummy', 'tea', 'sorry', 'tried', 'well', 'mistake', 'highly', 'sweet', 'smell', 'rip', 'ingredient', 'day', 'bag', 'got', 'way', 'order', 'trash', 'ive']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Feature importances}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{list\PYZus{}feature}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{list\PYZus{}fval}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{,}
                \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{r}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{list\PYZus{}feature}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} 
                    \PY{n}{list\PYZus{}feature}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{,}\PY{n}{rotation} \PY{o}{=} \PY{l+m+mi}{90}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}35}]:} ([<matplotlib.axis.XTick at 0x153cdb9907b8>,
           <matplotlib.axis.XTick at 0x153cdbdfb208>,
           <matplotlib.axis.XTick at 0x153cda6c2400>,
           <matplotlib.axis.XTick at 0x153cd762fe10>,
           <matplotlib.axis.XTick at 0x153cdbd8f4e0>,
           <matplotlib.axis.XTick at 0x153cdbd8fb70>,
           <matplotlib.axis.XTick at 0x153cdbd6d240>,
           <matplotlib.axis.XTick at 0x153cdbd6d8d0>,
           <matplotlib.axis.XTick at 0x153cdbd6df60>,
           <matplotlib.axis.XTick at 0x153cd96c1630>,
           <matplotlib.axis.XTick at 0x153cd96c1cc0>,
           <matplotlib.axis.XTick at 0x153cd969a390>,
           <matplotlib.axis.XTick at 0x153cd969aa20>,
           <matplotlib.axis.XTick at 0x153cd591a0f0>,
           <matplotlib.axis.XTick at 0x153cd591a780>,
           <matplotlib.axis.XTick at 0x153cd591ae10>,
           <matplotlib.axis.XTick at 0x153cd48b44e0>,
           <matplotlib.axis.XTick at 0x153cd48b4b70>,
           <matplotlib.axis.XTick at 0x153cd48dc240>,
           <matplotlib.axis.XTick at 0x153cd48dc8d0>,
           <matplotlib.axis.XTick at 0x153cd48dcf60>,
           <matplotlib.axis.XTick at 0x153cd5fe3630>,
           <matplotlib.axis.XTick at 0x153cd5fe3cc0>,
           <matplotlib.axis.XTick at 0x153cd5fe1390>,
           <matplotlib.axis.XTick at 0x153cd5fe1a20>,
           <matplotlib.axis.XTick at 0x153cd92590f0>,
           <matplotlib.axis.XTick at 0x153cd9259780>,
           <matplotlib.axis.XTick at 0x153cd9259e10>,
           <matplotlib.axis.XTick at 0x153cdacfa4e0>,
           <matplotlib.axis.XTick at 0x153cdacfab70>,
           <matplotlib.axis.XTick at 0x153cdacfe240>,
           <matplotlib.axis.XTick at 0x153cdacfe8d0>,
           <matplotlib.axis.XTick at 0x153cdacfef60>,
           <matplotlib.axis.XTick at 0x153cd7a9e630>,
           <matplotlib.axis.XTick at 0x153cd7a9ecc0>,
           <matplotlib.axis.XTick at 0x153cd89de390>,
           <matplotlib.axis.XTick at 0x153cd89dea20>,
           <matplotlib.axis.XTick at 0x153cd8a030f0>,
           <matplotlib.axis.XTick at 0x153cd8a03780>,
           <matplotlib.axis.XTick at 0x153cd8a03e10>,
           <matplotlib.axis.XTick at 0x153cd554f4a8>,
           <matplotlib.axis.XTick at 0x153cd554fb38>,
           <matplotlib.axis.XTick at 0x153cd5553208>,
           <matplotlib.axis.XTick at 0x153cd5553898>,
           <matplotlib.axis.XTick at 0x153cd5553f28>,
           <matplotlib.axis.XTick at 0x153cd71da5f8>,
           <matplotlib.axis.XTick at 0x153cd71dac88>,
           <matplotlib.axis.XTick at 0x153cd71d3358>,
           <matplotlib.axis.XTick at 0x153cd71d39e8>,
           <matplotlib.axis.XTick at 0x153cdbd95128>],
          <a list of 50 Text xticklabel objects>)
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_103_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subparagraph{XGBoost}\label{xgboost}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{c+c1}{\PYZsh{}base model}
         \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}train score}
         \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test score}
         \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Train Score 0.8965894062002645
Test Score 0.8765233537318897

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{model} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of Estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No of Estimators 0 Train Score 0.1399878953621304 Test Score 0.17065484596474711
No of Estimators 10 Train Score 0.8616652843469099 Test Score 0.8314765416601286
No of Estimators 20 Train Score 0.8644224518616485 Test Score 0.8354516449605105
No of Estimators 30 Train Score 0.8701217188585775 Test Score 0.8432057115957947
No of Estimators 40 Train Score 0.8749467620093699 Test Score 0.8494168105026414
No of Estimators 50 Train Score 0.8794747932124364 Test Score 0.8547387415659815
No of Estimators 60 Train Score 0.8832911165407635 Test Score 0.8592368847743083
No of Estimators 70 Train Score 0.8868832799085428 Test Score 0.8644934358491553
No of Estimators 80 Train Score 0.8911759431530341 Test Score 0.8697107589309064
No of Estimators 90 Train Score 0.8940451906480464 Test Score 0.8735289502589048

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{50}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{model} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of Estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No of Estimators 50 Train Score 0.8794747932124364 Test Score 0.8547387415659815
No of Estimators 100 Train Score 0.8965894062002645 Test Score 0.8765233537318897
No of Estimators 150 Train Score 0.9057799645827262 Test Score 0.8880040797112819
No of Estimators 200 Train Score 0.9116809755441483 Test Score 0.895731994351169
No of Estimators 250 Train Score 0.9159904507856806 Test Score 0.901093153407605
No of Estimators 300 Train Score 0.919470534173186 Test Score 0.9047936607563157
No of Estimators 350 Train Score 0.9223005536751026 Test Score 0.9079057482085883
No of Estimators 400 Train Score 0.9249064132164713 Test Score 0.9105732517391077
No of Estimators 450 Train Score 0.9269294568604156 Test Score 0.9127307913593807

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1050}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{model} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of Estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No of Estimators 500 Train Score 0.9287059245477572 Test Score 0.9151498509336262
No of Estimators 550 Train Score 0.9303422922597565 Test Score 0.9166405146712694
No of Estimators 600 Train Score 0.9319058079845778 Test Score 0.9184319263559809
No of Estimators 650 Train Score 0.9331554997646321 Test Score 0.9198179821120351
No of Estimators 700 Train Score 0.9345172715249602 Test Score 0.920694073957843
No of Estimators 750 Train Score 0.9355820313375625 Test Score 0.9219493697369109
No of Estimators 800 Train Score 0.9368653471116989 Test Score 0.9226947016057325
No of Estimators 850 Train Score 0.93791329492726 Test Score 0.9238715413986087
No of Estimators 900 Train Score 0.9388883907556432 Test Score 0.9246822532559235
No of Estimators 950 Train Score 0.9397458026047387 Test Score 0.9253752811339505
No of Estimators 1000 Train Score 0.9407601264262178 Test Score 0.9262382969820597

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{p}{[}\PY{l+m+mi}{1200}\PY{p}{,}\PY{l+m+mi}{1500}\PY{p}{,}\PY{l+m+mi}{1750}\PY{p}{,}\PY{l+m+mi}{2100}\PY{p}{]}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{model} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of Estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No of Estimators 1200 Train Score 0.9435397099370111 Test Score 0.9283043046184424
No of Estimators 1500 Train Score 0.9471150613077493 Test Score 0.9314817720592081
No of Estimators 1750 Train Score 0.9496424648629261 Test Score 0.9326455358543857
No of Estimators 2100 Train Score 0.9527190603214454 Test Score 0.9345284795229876

    \end{Verbatim}

    even increase in estimators, test score alo increasing

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{param\PYZus{}distributions} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{sp\PYZus{}randint}\PY{p}{(}\PY{l+m+mi}{600}\PY{p}{,}\PY{l+m+mi}{2000}\PY{p}{)}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{sp\PYZus{}randint}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{)}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}learning\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}subsample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}reg\PYZus{}alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}reg\PYZus{}lambda}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                               \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}colsample\PYZus{}bylevel}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mf}{0.7}\PY{p}{,}\PY{l+m+mf}{0.3}\PY{p}{)}\PY{p}{\PYZcb{}}
         
         \PY{n}{model\PYZus{}random\PYZus{}bow} \PY{o}{=} \PY{n}{RandomizedSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stop}\PY{p}{)}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{int8}\PY{p}{)}\PY{p}{,}
                                                             \PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                                \PY{n}{param\PYZus{}distributions}\PY{o}{=}\PY{n}{param\PYZus{}distributions}\PY{p}{,}\PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{,}
                                                \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}random\PYZus{}bow}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}bow}\PY{p}{,}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}random\PYZus{}bow\PYZus{}xgb.p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}random\PYZus{}bow\PYZus{}xgb}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}subsample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}colsample\PYZus{}bylevel}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}learning\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}reg\PYZus{}alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}reg\PYZus{}lambda}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}bow\PYZus{}xgb}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{subsample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{colsample\PYZus{}bylevel}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{learning\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg\PYZus{}alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg\PYZus{}lambda}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}17}]:}     n\_estimators  depth  subsample  colsample\_bylevel  learning\_rate  \textbackslash{}
         2           1825      3   0.836375           0.859582       0.406806   
         12          1240      3   0.660874           0.761028       0.259216   
         16          1763      6   0.320007           0.952691       0.177006   
         7           1114      6   0.750906           0.990907       0.666196   
         23          1119      3   0.198074           0.713333       0.293012   
         13           830      5   0.790607           0.728332       0.831163   
         5            614      5   0.471378           0.857746       0.559242   
         9           1615      8   0.662077           0.947542       0.712552   
         10           655      4   0.725973           0.895196       0.857754   
         4           1681      8   0.289804           0.831081       0.281701   
         3           1204      5   0.421004           0.844403       0.516502   
         20          1730      5   0.806417           0.745004       0.994481   
         24          1163      5   0.299572           0.712891       0.383704   
         8           1117      3   0.396542           0.822676       0.593100   
         18           891      3   0.747596           0.849763       0.085110   
         19          1822      6   0.998268           0.754903       0.015087   
         11          1905      7   0.310728           0.782047       0.660684   
         21          1091      3   0.119866           0.988096       0.539474   
         15          1885      4   0.353804           0.802320       0.923763   
         14           830      3   0.126974           0.710105       0.795971   
         0           1486      8   0.117376           0.961037       0.582277   
         22           881      6   0.074116           0.773796       0.626783   
         6           1919      7   0.053081           0.987161       0.510903   
         1           1053      7   0.018730           0.905491       0.437611   
         17           909      8   0.023475           0.937474       0.489521   
         
             reg\_alpha  reg\_lambda  Test\_score  Test\_std  Train\_score  
         2    0.699186    0.366395    0.938228  0.003046     0.981074  
         12   0.676561    0.021376    0.937136  0.002877     0.968227  
         16   0.958540    0.762318    0.933874  0.004498     0.986529  
         7    0.577135    0.121505    0.931410  0.003405     0.998340  
         23   0.588749    0.987940    0.930107  0.004097     0.956563  
         13   0.566830    0.174626    0.929563  0.002793     0.993391  
         5    0.151921    0.903585    0.929356  0.003601     0.980291  
         9    0.210908    0.844187    0.928485  0.003783     0.999967  
         10   0.990475    0.137572    0.928446  0.003519     0.983068  
         4    0.669612    0.456069    0.928329  0.003828     0.996344  
         3    0.034450    0.719930    0.928282  0.003205     0.989170  
         20   0.531058    0.323604    0.927837  0.003633     0.999591  
         24   0.434800    0.073235    0.927427  0.004114     0.980631  
         8    0.719055    0.415219    0.927397  0.003359     0.970442  
         18   0.109562    0.085703    0.926340  0.004487     0.944349  
         19   0.582870    0.312620    0.921192  0.004684     0.945676  
         11   0.215531    0.265331    0.912635  0.002424     0.992984  
         21   0.801124    0.797099    0.905925  0.007794     0.934209  
         15   0.345075    0.410529    0.905523  0.005715     0.960594  
         14   0.507171    0.775050    0.895935  0.008408     0.919568  
         0    0.185911    0.411100    0.877535  0.007569     0.911695  
         22   0.063457    0.373199    0.873906  0.007535     0.895959  
         6    0.666186    0.072758    0.859096  0.005541     0.883607  
         1    0.761255    0.946506    0.857513  0.008010     0.878668  
         17   0.637238    0.446780    0.851614  0.004864     0.871551  
\end{Verbatim}
            
    From above df we can observe that second row in the df i.e 12th index
with 1240 estimators is giving max similar scores as 1825 estimators so
for better time complexity n estimators coosen as 1240. and got good
score at n\_estimators = 1240, depth = 3, subsample = 0.660874,
colsample\_bylevel=0.761028, learning\_rate = 0.259216, reg\_alpha =
0.676561, reg\_lambda = 0.021376 and Test\_score is 0.937136

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{param\PYZus{}distributions1} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{sp\PYZus{}randint}\PY{p}{(}\PY{l+m+mi}{600}\PY{p}{,}\PY{l+m+mi}{2000}\PY{p}{)}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{sp\PYZus{}randint}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{)}\PY{p}{\PYZcb{}}
         
         \PY{n}{model\PYZus{}random\PYZus{}bow1} \PY{o}{=} \PY{n}{RandomizedSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stop}\PY{p}{)}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{int8}\PY{p}{)}\PY{p}{,}
                                                             \PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                                \PY{n}{param\PYZus{}distributions}\PY{o}{=}\PY{n}{param\PYZus{}distributions1}\PY{p}{,}\PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,}
                                                \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}random\PYZus{}bow1}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}bow1}\PY{p}{,}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}random\PYZus{}bow\PYZus{}xgb1.p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}random\PYZus{}bow1}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}bow1}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{scores\PYZus{}df1}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}22}]:}     n\_estimators  depth  Test\_score  Test\_std  Train\_score
         18          1978      7    0.938181  0.003358     0.987153
         5           1877      7    0.938030  0.003206     0.986398
         2           1486      8    0.937512  0.003099     0.986929
         19          1472      8    0.937508  0.003046     0.986764
         8           1712      6    0.937482  0.002863     0.980572
         3           1365      7    0.936951  0.002875     0.981748
         9           1452      6    0.936852  0.002762     0.977774
         15          1249      7    0.936610  0.003017     0.980420
         14          1581      5    0.936002  0.002954     0.972947
         6           1053      7    0.935682  0.003258     0.977682
         0            918      7    0.934914  0.002916     0.975334
         17          1204      5    0.934405  0.003269     0.967921
         10           731      8    0.934263  0.003227     0.976142
         12          1825      3    0.933279  0.002834     0.957562
         4           1780      3    0.933046  0.002852     0.957191
         11          1006      4    0.931207  0.003088     0.956341
         16          1428      3    0.930992  0.003162     0.953105
         1            743      5    0.930668  0.003390     0.958674
         7            767      4    0.928351  0.003608     0.951389
         13           709      3    0.923142  0.004575     0.940904
\end{Verbatim}
            
    above model is better than this best model with estimators 1978, depth
7, because it is generalizing train and test data's well

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{c+c1}{\PYZsh{}Test scores}
         \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{corpus} \PY{k}{import} \PY{n}{stopwords}
         \PY{n}{stop} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{stopwords}\PY{o}{.}\PY{n}{words}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{not}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{very}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}CountVectorizer for BoW}
         \PY{n}{count\PYZus{}vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stop}\PY{p}{)}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{int8}\PY{p}{)}
         \PY{n}{final\PYZus{}counts\PYZus{}train} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}
                 \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test}
         \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{learning\PYZus{}rate}\PY{o}{=}\PY{l+m+mf}{0.259216}\PY{p}{,}
                                      \PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{1240}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}
                                     \PY{n}{subsample}\PY{o}{=}\PY{l+m+mf}{0.660874}\PY{p}{,}\PY{n}{colsample\PYZus{}bylevel}\PY{o}{=}\PY{l+m+mf}{0.761028}\PY{p}{,}
                                     \PY{n}{reg\PYZus{}alpha}\PY{o}{=}\PY{l+m+mf}{0.676561}\PY{p}{,}\PY{n}{reg\PYZus{}lambda}\PY{o}{=}\PY{l+m+mf}{0.021376}\PY{p}{)}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Predicting training data}
         \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}predict test cv}
         \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}recall}
         \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}confusion matrix}
         \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}\PYZsq{}\PYZsq{}}\PY{l+s+s1}{max\PYZus{}depth=3,learning\PYZus{}rate=0.259216,n\PYZus{}estimators=1240,n\PYZus{}jobs=\PYZhy{}1,}
         \PY{l+s+s1}{subsample=0.660874,colsample\PYZus{}bylevel=0.761028,reg\PYZus{}alpha=0.676561,}
         \PY{l+s+s1}{reg\PYZus{}lambda=0.021376}\PY{l+s+s1}{\PYZsq{}\PYZsq{}\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
max\_depth=3,learning\_rate=0.259216,n\_estimators=1240,n\_jobs=-1,
subsample=0.660874,colsample\_bylevel=0.761028,reg\_alpha=0.676561,
reg\_lambda=0.021376
Train Score 0.956825670798682
Test Score 0.9375749421057931
Test Precision 0.949588987896179
Test Recall 0.9761899480991882
Test ConfusionMatrix [[14406  4673]
 [ 2147 88025]]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{k+kn}{import} \PY{n+nn}{operator}
         \PY{n}{importances} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{feature\PYZus{}importances\PYZus{}}
         \PY{n}{features} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
         \PY{n}{dict\PYZus{}feature} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n}{features}\PY{p}{,}\PY{n}{importances}\PY{p}{)}\PY{p}{)}
         \PY{n}{sorted\PYZus{}feature} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n}{dict\PYZus{}feature}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{,} 
                             \PY{n}{key}\PY{o}{=}\PY{n}{operator}\PY{o}{.}\PY{n}{itemgetter}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{reverse}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{c+c1}{\PYZsh{}To 100 features to seperate the data using Bag of words with RF}
         \PY{n}{list\PYZus{}feature} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{sorted\PYZus{}feature}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{100}\PY{p}{]}
         \PY{n}{list\PYZus{}fval} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{sorted\PYZus{}feature}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{100}\PY{p}{]}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{list\PYZus{}feature}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
['not', 'wa', 'like', 'great', 'good', 'product', 'taste', 'love', 'one', 'best', 'flavor', 'would', 'food', 'ha', 'get', 'very', 'amazon', 'really', 'dont', 'price', 'day', 'however', 'make', 'use', 'much', 'better', 'buy', 'didnt', 'little', 'try', 'time', 'bad', 'delicious', 'even', 'store', 'also', 'coffee', 'could', 'star', 'find', 'bit', 'box', 'something', 'sugar', 'well', 'found', 'review', 'still', 'used', 'tried', 'year', 'bag', 'bought', 'cat', 'chocolate', 'disappointed', 'first', 'ive', 'perfect', 'though', 'wont', 'brand', 'excellent', 'shipping', 'sweet', 'tea', 'thought', 'water', 'ingredient', 'know', 'nice', 'pretty', 'terrible', 'come', 'disappointing', 'doesnt', 'drink', 'dry', 'favorite', 'looking', 'money', 'old', 'ordered', 'say', 'small', 'stick', 'thing', 'unfortunately', 'way', 'work', 'amazing', 'back', 'changed', 'doe', 'high', 'keep', 'long', 'quite', 'smell', 'tasty']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Feature importances}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{list\PYZus{}feature}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{list\PYZus{}fval}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{,}
                \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{r}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{list\PYZus{}feature}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} 
                    \PY{n}{list\PYZus{}feature}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{,}\PY{n}{rotation} \PY{o}{=} \PY{l+m+mi}{90}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}39}]:} ([<matplotlib.axis.XTick at 0x153cda7d6780>,
           <matplotlib.axis.XTick at 0x153cdacfad68>,
           <matplotlib.axis.XTick at 0x153cda7e5438>,
           <matplotlib.axis.XTick at 0x153cdab303c8>,
           <matplotlib.axis.XTick at 0x153cd7c5a320>,
           <matplotlib.axis.XTick at 0x153cd7c5a9b0>,
           <matplotlib.axis.XTick at 0x153cd7c4f080>,
           <matplotlib.axis.XTick at 0x153cd7c4f710>,
           <matplotlib.axis.XTick at 0x153cd7c4fda0>,
           <matplotlib.axis.XTick at 0x153cd9a71ba8>,
           <matplotlib.axis.XTick at 0x153cd9a71518>,
           <matplotlib.axis.XTick at 0x153cd9a901d0>,
           <matplotlib.axis.XTick at 0x153cd9a90860>,
           <matplotlib.axis.XTick at 0x153cd9a90ef0>,
           <matplotlib.axis.XTick at 0x153cdb38e5c0>,
           <matplotlib.axis.XTick at 0x153cdb38ec50>,
           <matplotlib.axis.XTick at 0x153cdb373cf8>,
           <matplotlib.axis.XTick at 0x153cdb373668>,
           <matplotlib.axis.XTick at 0x153cd4737080>,
           <matplotlib.axis.XTick at 0x153cd4737710>,
           <matplotlib.axis.XTick at 0x153cd4737da0>,
           <matplotlib.axis.XTick at 0x153cd6f7fba8>,
           <matplotlib.axis.XTick at 0x153cd6f7f518>,
           <matplotlib.axis.XTick at 0x153cd6f981d0>,
           <matplotlib.axis.XTick at 0x153cd6f98860>,
           <matplotlib.axis.XTick at 0x153cd6f98ef0>,
           <matplotlib.axis.XTick at 0x153cd4a3d5c0>,
           <matplotlib.axis.XTick at 0x153cd4a3dc50>,
           <matplotlib.axis.XTick at 0x153cd4a5c320>,
           <matplotlib.axis.XTick at 0x153cd4a5c9b0>,
           <matplotlib.axis.XTick at 0x153cd6c76080>,
           <matplotlib.axis.XTick at 0x153cd6c76710>,
           <matplotlib.axis.XTick at 0x153cd6c76da0>,
           <matplotlib.axis.XTick at 0x153cd6c74ba8>,
           <matplotlib.axis.XTick at 0x153cd6c74518>,
           <matplotlib.axis.XTick at 0x153cd53761d0>,
           <matplotlib.axis.XTick at 0x153cd5376860>,
           <matplotlib.axis.XTick at 0x153cd5376ef0>,
           <matplotlib.axis.XTick at 0x153cd53ab5c0>,
           <matplotlib.axis.XTick at 0x153cd53abc50>,
           <matplotlib.axis.XTick at 0x153cd4ab8320>,
           <matplotlib.axis.XTick at 0x153cd4ab89b0>,
           <matplotlib.axis.XTick at 0x153cd4ae2080>,
           <matplotlib.axis.XTick at 0x153cd4ae2710>,
           <matplotlib.axis.XTick at 0x153cd4ae2da0>,
           <matplotlib.axis.XTick at 0x153cdb617ba8>,
           <matplotlib.axis.XTick at 0x153cdb617518>,
           <matplotlib.axis.XTick at 0x153cd74661d0>,
           <matplotlib.axis.XTick at 0x153cd7466860>,
           <matplotlib.axis.XTick at 0x153cd7466ef0>],
          <a list of 50 Text xticklabel objects>)
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_122_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{Tf-Idf:}\label{tf-idf}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{c+c1}{\PYZsh{}TFIDF with (1,2) gram with cleaned data }
         \PY{c+c1}{\PYZsh{}simple cv for train data}
         \PY{c+c1}{\PYZsh{}tfidf vec }
         \PY{n}{tf\PYZus{}idf\PYZus{}vect} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{X\PYZus{}test\PYZus{}cv} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{final\PYZus{}counts\PYZus{}train} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}
                 \PY{n}{X\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test}
         \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
\end{Verbatim}


    \subparagraph{Random Forest}\label{random-forest}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of Estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No of Estimators 1 Train Score 0.9434500459527919 Test Score 0.8208065275380512
No of Estimators 2 Train Score 0.9503541727376656 Test Score 0.8015325069302788
No of Estimators 3 Train Score 0.9757178722736545 Test Score 0.8582561849469115
No of Estimators 4 Train Score 0.9874246262132658 Test Score 0.86530414770647
No of Estimators 5 Train Score 0.9842135347784179 Test Score 0.8648464877870181
No of Estimators 6 Train Score 0.9929333572437291 Test Score 0.873659710235891
No of Estimators 7 Train Score 0.9885510300150188 Test Score 0.863421204037868
No of Estimators 8 Train Score 0.9948275089103584 Test Score 0.8727443903969873
No of Estimators 9 Train Score 0.9915323574903051 Test Score 0.861368272399184
No of Estimators 10 Train Score 0.9960828046894263 Test Score 0.8708483707306868
No of Estimators 11 Train Score 0.9935497971352357 Test Score 0.8614205763899786
No of Estimators 12 Train Score 0.9970635045168232 Test Score 0.8696192269470161
No of Estimators 13 Train Score 0.9951301248570981 Test Score 0.8600214446362258
No of Estimators 14 Train Score 0.9976295084172065 Test Score 0.8677493592761127
No of Estimators 15 Train Score 0.9961780726726592 Test Score 0.8599560646477327
No of Estimators 16 Train Score 0.9980386003452063 Test Score 0.8669124954234008
No of Estimators 17 Train Score 0.9968505525543028 Test Score 0.8593284167581986
No of Estimators 18 Train Score 0.9983468202909597 Test Score 0.8659056436006067
No of Estimators 19 Train Score 0.9974613884467957 Test Score 0.8594068727443904

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{p}{[}\PY{l+m+mi}{150}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{]}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)} \PY{n}{VB} 
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of Estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No of Estimators 150 Train Score 0.9999943960009863 Test Score 0.8560463413358439
No of Estimators 300 Train Score 0.9999943960009863 Test Score 0.8549218055337622
No of Estimators 500 Train Score 0.9999943960009863 Test Score 0.8542810816465296

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{c+c1}{\PYZsh{}random search}
         \PY{n}{param\PYZus{}distributions} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{sp\PYZus{}randint}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{)}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{sp\PYZus{}randint}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{150}\PY{p}{)}\PY{p}{\PYZcb{}}
         
         \PY{n}{model\PYZus{}random\PYZus{}tfidf\PYZus{}rf} \PY{o}{=} \PY{n}{RandomizedSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                                             \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                                \PY{n}{param\PYZus{}distributions}\PY{o}{=}\PY{n}{param\PYZus{}distributions}\PY{p}{,}\PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{40}\PY{p}{,}
                                                \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}random\PYZus{}tfidf\PYZus{}rf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}tfidf\PYZus{}rf}\PY{p}{,}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}random\PYZus{}tfidf\PYZus{}rf.p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{n}{model\PYZus{}random\PYZus{}tfidf\PYZus{}rf}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}44}]:} mean: 0.85523, std: 0.01842, params: \{'randomforestclassifier\_\_max\_depth': 142, 'randomforestclassifier\_\_n\_estimators': 27\}
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}random\PYZus{}tfidf\PYZus{}rf}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}tfidf\PYZus{}rf}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{n}{scores\PYZus{}df1}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}46}]:}     n\_estimators  depth  Test\_score  Test\_std  Train\_score
         17             3    126    0.860801  0.016423     0.916165
         36             6    105    0.859692  0.019217     0.912101
         2             29    146    0.855562  0.018273     0.928623
         3             26    142    0.855554  0.018274     0.925843
         0             27    142    0.855230  0.018425     0.926185
         38            38    149    0.854565  0.018887     0.930270
         31             4     63    0.854518  0.020148     0.891385
         37            20    120    0.854099  0.018943     0.912255
         10            22    119    0.853595  0.019060     0.911291
         12            48    148    0.853573  0.018661     0.929691
         7              4     55    0.853474  0.020593     0.887026
         4             40    139    0.853405  0.018838     0.923902
         23            24    116    0.852801  0.019535     0.908702
         29            38    125    0.852330  0.019519     0.913656
         21            21    100    0.851312  0.019907     0.899021
         15            31    108    0.850984  0.019731     0.902228
         16            44    114    0.850535  0.020016     0.905612
         14            37    102    0.850186  0.020033     0.897602
         28            47     98    0.849197  0.020203     0.893931
         35            33     89    0.848926  0.020388     0.888985
         25            27     81    0.848727  0.020194     0.885194
         27            40     86    0.848438  0.020199     0.886512
         24            15     60    0.848291  0.020515     0.878173
         1             24     71    0.848201  0.020624     0.880570
         11            10     46    0.847907  0.020621     0.874783
         20             3     21    0.847838  0.020727     0.872820
         34             4     19    0.847407  0.020747     0.872239
         9             48     58    0.847057  0.020555     0.873843
         33            46     54    0.847014  0.020589     0.873140
         26            15     25    0.846897  0.020525     0.871390
         19            49     32    0.846889  0.020509     0.871325
         18            10     15    0.846884  0.020501     0.871232
         30            47     23    0.846884  0.020505     0.871247
         22            20     24    0.846880  0.020501     0.871268
         32            45     12    0.846880  0.020501     0.871226
         8             23     11    0.846880  0.020501     0.871226
         6             21     13    0.846880  0.020501     0.871229
         5             25     13    0.846880  0.020501     0.871228
         39            23     27    0.846880  0.020501     0.871320
         13             2    116    0.845072  0.010422     0.925554
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{c+c1}{\PYZsh{}random search}
         \PY{n}{param\PYZus{}distributions} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                                      \PY{n}{sp\PYZus{}randint}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{)}\PY{p}{\PYZcb{}}
         
         \PY{n}{model\PYZus{}random\PYZus{}tfidf\PYZus{}rf1} \PY{o}{=} \PY{n}{RandomizedSearchCV}\PY{p}{(}
                            \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                            \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                            \PY{n}{param\PYZus{}distributions}\PY{o}{=}\PY{n}{param\PYZus{}distributions}\PY{p}{,}\PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,}
                                \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}random\PYZus{}tfidf\PYZus{}rf1}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}tfidf\PYZus{}rf1}\PY{p}{,}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}random\PYZus{}tfidf\PYZus{}rf1.p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}random\PYZus{}tfidf\PYZus{}rf1}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{randomforestclassifier\PYZus{}\PYZus{}n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}tfidf\PYZus{}rf1}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{n\PYZus{}estimators}\PY{p}{,}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{Test\PYZus{}score}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{n\PYZus{}estimators}\PY{p}{,}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{Train\PYZus{}score}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Validation curve for Tf\PYZhy{}Idf Representation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}21}]:} <matplotlib.legend.Legend at 0x14c9e6254be0>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_135_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}23}]:}     n\_estimators  Test\_score  Test\_std  Train\_score
         10             6    0.883076  0.010823     0.993331
         2             16    0.879002  0.011770     0.997926
         5              9    0.875895  0.013146     0.992001
         3             24    0.875766  0.012165     0.999061
         7              5    0.875455  0.013131     0.985027
\end{Verbatim}
            
    Got best cv score at n\_estimators = 6 at max dept and mean cv score is
0.883076

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{c+c1}{\PYZsh{}test scores}
         \PY{c+c1}{\PYZsh{}TFIDF with (1,2) gram with cleaned data }
         \PY{c+c1}{\PYZsh{}tfidf vec }
         \PY{n}{tf\PYZus{}idf\PYZus{}vect} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         \PY{n}{final\PYZus{}counts\PYZus{}train} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}
                 \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test}
         \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
         \PY{n}{model} \PY{o}{=} \PY{n}{RF}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{6}\PY{p}{)}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Predicting training data}
         \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}predict test cv}
         \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}recall}
         \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}confusion matrix}
         \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators=6}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
n\_estimators=6
Train Score 0.9927624352738114
Test Score 0.8698043953831086
Test Precision 0.8794440336537501
Test Recall 0.9760568690946192
Test ConfusionMatrix [[ 7014 12065]
 [ 2159 88013]]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{n}{features} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
         \PY{n}{dict\PYZus{}feature} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n}{features}\PY{p}{,}\PY{n}{importances}\PY{p}{)}\PY{p}{)}
         \PY{n}{sorted\PYZus{}feature} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n}{dict\PYZus{}feature}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{,} 
                         \PY{n}{key}\PY{o}{=}\PY{n}{operator}\PY{o}{.}\PY{n}{itemgetter}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{reverse}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} \PY{c+c1}{\PYZsh{}To 100 features to seperate the data using Bag of words with RF}
         \PY{n}{list\PYZus{}feature} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{sorted\PYZus{}feature}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{100}\PY{p}{]}
         \PY{n}{list\PYZus{}fval} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{sorted\PYZus{}feature}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{100}\PY{p}{]}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{list\PYZus{}feature}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
['not', 'wa', 'like', 'great', 'good', 'product', 'taste', 'love', 'one', 'best', 'flavor', 'would', 'food', 'ha', 'get', 'very', 'amazon', 'really', 'dont', 'price', 'day', 'however', 'make', 'use', 'much', 'better', 'buy', 'didnt', 'little', 'try', 'time', 'bad', 'delicious', 'even', 'store', 'also', 'coffee', 'could', 'star', 'find', 'bit', 'box', 'something', 'sugar', 'well', 'found', 'review', 'still', 'used', 'tried', 'year', 'bag', 'bought', 'cat', 'chocolate', 'disappointed', 'first', 'ive', 'perfect', 'though', 'wont', 'brand', 'excellent', 'shipping', 'sweet', 'tea', 'thought', 'water', 'ingredient', 'know', 'nice', 'pretty', 'terrible', 'come', 'disappointing', 'doesnt', 'drink', 'dry', 'favorite', 'looking', 'money', 'old', 'ordered', 'say', 'small', 'stick', 'thing', 'unfortunately', 'way', 'work', 'amazing', 'back', 'changed', 'doe', 'high', 'keep', 'long', 'quite', 'smell', 'tasty']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Feature importances for RF with Tfidf vectorization}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{list\PYZus{}feature}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{list\PYZus{}fval}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{,}
                \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{r}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{list\PYZus{}feature}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} 
                    \PY{n}{list\PYZus{}feature}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{,}\PY{n}{rotation} \PY{o}{=} \PY{l+m+mi}{90}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}45}]:} ([<matplotlib.axis.XTick at 0x153c7cb19438>,
           <matplotlib.axis.XTick at 0x153c8aa0aeb8>,
           <matplotlib.axis.XTick at 0x153cdb877828>,
           <matplotlib.axis.XTick at 0x153cd4d41898>,
           <matplotlib.axis.XTick at 0x153cd4d41f28>,
           <matplotlib.axis.XTick at 0x153cd8dbd5f8>,
           <matplotlib.axis.XTick at 0x153cd8dbdc88>,
           <matplotlib.axis.XTick at 0x153c619e9358>,
           <matplotlib.axis.XTick at 0x153c619e99e8>,
           <matplotlib.axis.XTick at 0x153c59d6f0b8>,
           <matplotlib.axis.XTick at 0x153c59d6f748>,
           <matplotlib.axis.XTick at 0x153c59d6fdd8>,
           <matplotlib.axis.XTick at 0x153cdae144a8>,
           <matplotlib.axis.XTick at 0x153cdae14b38>,
           <matplotlib.axis.XTick at 0x153cdae2b208>,
           <matplotlib.axis.XTick at 0x153cdae2b898>,
           <matplotlib.axis.XTick at 0x153cdae2bf28>,
           <matplotlib.axis.XTick at 0x153cdb7175f8>,
           <matplotlib.axis.XTick at 0x153cdb717c88>,
           <matplotlib.axis.XTick at 0x153cd3fd9358>,
           <matplotlib.axis.XTick at 0x153cd3fd99e8>,
           <matplotlib.axis.XTick at 0x153cd6ae50b8>,
           <matplotlib.axis.XTick at 0x153cd6ae5748>,
           <matplotlib.axis.XTick at 0x153cd6ae5dd8>,
           <matplotlib.axis.XTick at 0x153c7c5854a8>,
           <matplotlib.axis.XTick at 0x153c7c585b38>,
           <matplotlib.axis.XTick at 0x153c7c58f208>,
           <matplotlib.axis.XTick at 0x153c7c58f898>,
           <matplotlib.axis.XTick at 0x153c7c58ff28>,
           <matplotlib.axis.XTick at 0x153c6402b5f8>,
           <matplotlib.axis.XTick at 0x153c6402bc88>,
           <matplotlib.axis.XTick at 0x153c62732358>,
           <matplotlib.axis.XTick at 0x153c627329e8>,
           <matplotlib.axis.XTick at 0x153c536510b8>,
           <matplotlib.axis.XTick at 0x153c53651748>,
           <matplotlib.axis.XTick at 0x153c53651dd8>,
           <matplotlib.axis.XTick at 0x153c631b44a8>,
           <matplotlib.axis.XTick at 0x153c631b4b38>,
           <matplotlib.axis.XTick at 0x153c6319e208>,
           <matplotlib.axis.XTick at 0x153c6319e898>,
           <matplotlib.axis.XTick at 0x153c6319ef28>,
           <matplotlib.axis.XTick at 0x153cd83b25f8>,
           <matplotlib.axis.XTick at 0x153cd83b2c88>,
           <matplotlib.axis.XTick at 0x153cd6d53358>,
           <matplotlib.axis.XTick at 0x153cd6d539e8>,
           <matplotlib.axis.XTick at 0x153cd6d4e0b8>,
           <matplotlib.axis.XTick at 0x153cd6d4e748>,
           <matplotlib.axis.XTick at 0x153cd6d4edd8>,
           <matplotlib.axis.XTick at 0x153cd5a534a8>,
           <matplotlib.axis.XTick at 0x153c7f4d3320>],
          <a list of 50 Text xticklabel objects>)
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_141_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subparagraph{XGBoost:}\label{xgboost}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{c+c1}{\PYZsh{}base model}
         \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}train score}
         \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test score}
         \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Train Score 0.9028826970926453
Test Score 0.8865003399759401

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{i}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{model} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{No of Estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
No of Estimators 0 Train Score 0.1399878953621304 Test Score 0.17065484596474711
No of Estimators 10 Train Score 0.8626291721772656 Test Score 0.8329410534023746
No of Estimators 20 Train Score 0.8673925713389075 Test Score 0.8399105601757414
No of Estimators 30 Train Score 0.8716347985922754 Test Score 0.8461347350802866
No of Estimators 40 Train Score 0.8771883616148484 Test Score 0.8529865578743658
No of Estimators 50 Train Score 0.8829885005940239 Test Score 0.8608190804958419
No of Estimators 60 Train Score 0.8878079397458026 Test Score 0.8670955593911815
No of Estimators 70 Train Score 0.892061374997198 Test Score 0.8727966943877817
No of Estimators 80 Train Score 0.8962027302683194 Test Score 0.8783932214027931
No of Estimators 90 Train Score 0.8999910336015781 Test Score 0.8829567445996129

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{k+kn}{from} \PY{n+nn}{xgboost} \PY{k}{import} \PY{n}{XGBClassifier}
         \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{randint} \PY{k}{as} \PY{n}{sp\PYZus{}randint}
         \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{uniform}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{pipeline} \PY{k}{import} \PY{n}{make\PYZus{}pipeline}
         \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{l+m+mi}{25}\PY{p}{)}
         \PY{n}{param\PYZus{}distributions} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{sp\PYZus{}randint}\PY{p}{(}\PY{l+m+mi}{200}\PY{p}{,}\PY{l+m+mi}{900}\PY{p}{)}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{sp\PYZus{}randint}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{)}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}learning\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}subsample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}reg\PYZus{}alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}reg\PYZus{}lambda}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                               \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}colsample\PYZus{}bylevel}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{uniform}\PY{p}{(}\PY{l+m+mf}{0.7}\PY{p}{,}\PY{l+m+mf}{0.3}\PY{p}{)}\PY{p}{\PYZcb{}}
         
         \PY{n}{model\PYZus{}random\PYZus{}tfidf\PYZus{}xgb} \PY{o}{=} \PY{n}{RandomizedSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                                             \PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                                \PY{n}{param\PYZus{}distributions}\PY{o}{=}\PY{n}{param\PYZus{}distributions}\PY{p}{,}\PY{n}{n\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,}
                                                \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}random\PYZus{}tfidf\PYZus{}xgb}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}tfidf\PYZus{}xgb}\PY{p}{,}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}random\PYZus{}tfidf\PYZus{}xgb.p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}random\PYZus{}tfidf\PYZus{}xgb}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}subsample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}colsample\PYZus{}bylevel}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}learning\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}reg\PYZus{}alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xgbclassifier\PYZus{}\PYZus{}reg\PYZus{}lambda}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}random\PYZus{}tfidf\PYZus{}xgb}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}estimators}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                  \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{subsample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{colsample\PYZus{}bylevel}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{learning\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg\PYZus{}alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{reg\PYZus{}lambda}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}16}]:}    n\_estimators  depth  subsample  colsample\_bylevel  learning\_rate  \textbackslash{}
         2           759      3   0.907128           0.859582       0.406806   
         3           503      7   0.849676           0.776976       0.231515   
         5           371      5   0.745284           0.900884       0.456069   
         
            reg\_alpha  reg\_lambda  Test\_score  Test\_std  Train\_score  
         2   0.362060    0.305770    0.944274  0.003011     0.983090  
         3   0.477546    0.631773    0.942919  0.004053     0.991016  
         5   0.525819    0.559242    0.940904  0.003930     0.986590  
\end{Verbatim}
            
    Got best cv score at n\_estimators = 759, max\_depth = 3,subample =
0.907128, colsample\_bylevel = 0.859582, learning rate = 0.406806,
reg\_alpha = 0.362060, reg\_lambda = 0.305770 and mean test cv is
0.944274

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{c+c1}{\PYZsh{}test scores}
         \PY{c+c1}{\PYZsh{}TFIDF with (1,2) gram with cleaned data }
         \PY{c+c1}{\PYZsh{}tfidf vec }
         \PY{n}{tf\PYZus{}idf\PYZus{}vect} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         \PY{n}{final\PYZus{}counts\PYZus{}train} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}
                 \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test}
         \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
         \PY{n}{model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{learning\PYZus{}rate}\PY{o}{=}\PY{l+m+mf}{0.406806}\PY{p}{,}
                                    \PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{759}\PY{p}{,}\PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}
                                   \PY{n}{subsample}\PY{o}{=}\PY{l+m+mf}{0.907128}\PY{p}{,}\PY{n}{colsample\PYZus{}bylevel}\PY{o}{=}\PY{l+m+mf}{0.859582}\PY{p}{,}
                                     \PY{n}{reg\PYZus{}alpha}\PY{o}{=}\PY{l+m+mf}{0.362060}\PY{p}{,}\PY{n}{reg\PYZus{}lambda}\PY{o}{=}\PY{l+m+mf}{0.305770}\PY{p}{)}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Predicting training data}
         \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}predict test cv}
         \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}recall}
         \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}confusion matrix}
         \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}\PYZsq{}\PYZsq{}}\PY{l+s+s1}{max\PYZus{}depth=3,learning\PYZus{}rate=0.406806,}
         \PY{l+s+s1}{         n\PYZus{}estimators=759,n\PYZus{}jobs=\PYZhy{}1,}
         \PY{l+s+s1}{         subsample=0.907128,colsample\PYZus{}bylevel=0.859582,}
         \PY{l+s+s1}{         reg\PYZus{}alpha=0.362060,reg\PYZus{}lambda=0.305770}\PY{l+s+s1}{\PYZsq{}\PYZsq{}\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
max\_depth=3,learning\_rate=0.406806,
         n\_estimators=759,n\_jobs=-1,
         subsample=0.907128,colsample\_bylevel=0.859582,
         reg\_alpha=0.362060,reg\_lambda=0.305770
Train Score 0.9708889063235525
Test Score 0.9481926938883855
Test Precision 0.9579801877181193
Test Recall 0.9802266779044493
Test ConfusionMatrix [[15202  3877]
 [ 1783 88389]]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{k+kn}{import} \PY{n+nn}{operator}
         \PY{n}{importances} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{feature\PYZus{}importances\PYZus{}}
         \PY{n}{features} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
         \PY{n}{dict\PYZus{}feature} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n}{features}\PY{p}{,}\PY{n}{importances}\PY{p}{)}\PY{p}{)}
         \PY{n}{sorted\PYZus{}feature} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n}{dict\PYZus{}feature}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{,} 
                             \PY{n}{key}\PY{o}{=}\PY{n}{operator}\PY{o}{.}\PY{n}{itemgetter}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{reverse}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{c+c1}{\PYZsh{}To 100 features to seperate the data using Bag of words with RF}
         \PY{n}{list\PYZus{}feature} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{sorted\PYZus{}feature}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{100}\PY{p}{]}
         \PY{n}{list\PYZus{}fval} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{sorted\PYZus{}feature}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{100}\PY{p}{]}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{list\PYZus{}feature}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
['smartdogs', 'ovaltine', 'ambivalence', 'minuscule', 'grackle', 'everwhere', 'gent', 'advertizer', 'globule', 'ob', 'radish', 'bentadril', 'disapproving', 'lift', 'prima', 'subito', 'taam', 'bothering', 'brine', 'caducity', 'crass', 'domesticate', 'goldenflax', 'groundclear', 'mcgee', 'nectar', 'overrun', 'pimiento', 'reshipment', 'soaping', 'therefor', 'twixt', 'undercut', 'untraceable', 'vegecat', 'warns', 'wildeberryaki', 'aa', 'aachen', 'aachener', 'aaf', 'aagghh', 'aah', 'aahhyaa', 'aahing', 'aahs', 'aammaazziinngg', 'aap', 'aardvark', 'aargh', 'aaron', 'aarp', 'aarrgh', 'aarrghh', 'aauw', 'ab', 'aback', 'abacus', 'abada', 'abalone', 'abamectin', 'abandon', 'abandoned', 'abandoning', 'abash', 'abated', 'abates', 'abattoir', 'abb', 'abba', 'abbas', 'abbazabba', 'abbey', 'abbie', 'abbondanza', 'abbot', 'abbott', 'abbreviated', 'abbreviating', 'abbreviation', 'abby', 'abc', 'abcstores', 'abd', 'abdomen', 'abdominal', 'abduct', 'abe', 'abel', 'aberdeen', 'aberfoyle', 'abernook', 'aberrant', 'aberration', 'abetter', 'abhor', 'abhorrent', 'abhors', 'abi', 'abid']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Feature importances}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{list\PYZus{}feature}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{list\PYZus{}fval}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{,}
                \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{r}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{list\PYZus{}feature}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} 
                    \PY{n}{list\PYZus{}feature}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{,}\PY{n}{rotation} \PY{o}{=} \PY{l+m+mi}{90}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}49}]:} ([<matplotlib.axis.XTick at 0x153cd6c32da0>,
           <matplotlib.axis.XTick at 0x153c60c5b8d0>,
           <matplotlib.axis.XTick at 0x153c3fac8e48>,
           <matplotlib.axis.XTick at 0x153c7b7544a8>,
           <matplotlib.axis.XTick at 0x153c7b754b38>,
           <matplotlib.axis.XTick at 0x153c7fe16208>,
           <matplotlib.axis.XTick at 0x153c7fe16898>,
           <matplotlib.axis.XTick at 0x153c7fe16f28>,
           <matplotlib.axis.XTick at 0x153cdc7e75f8>,
           <matplotlib.axis.XTick at 0x153cdc7e7c88>,
           <matplotlib.axis.XTick at 0x153cd8dfe358>,
           <matplotlib.axis.XTick at 0x153cd8dfe9e8>,
           <matplotlib.axis.XTick at 0x153cdc69f0b8>,
           <matplotlib.axis.XTick at 0x153cdc69f748>,
           <matplotlib.axis.XTick at 0x153cdc69fdd8>,
           <matplotlib.axis.XTick at 0x153cda3614a8>,
           <matplotlib.axis.XTick at 0x153cda361b38>,
           <matplotlib.axis.XTick at 0x153cd624d208>,
           <matplotlib.axis.XTick at 0x153cd624d898>,
           <matplotlib.axis.XTick at 0x153cd624df28>,
           <matplotlib.axis.XTick at 0x153cdbf2c5f8>,
           <matplotlib.axis.XTick at 0x153cdbf2cc88>,
           <matplotlib.axis.XTick at 0x153c7bb19358>,
           <matplotlib.axis.XTick at 0x153c7bb199e8>,
           <matplotlib.axis.XTick at 0x153cd7d0a0b8>,
           <matplotlib.axis.XTick at 0x153cd7d0a748>,
           <matplotlib.axis.XTick at 0x153cd7d0add8>,
           <matplotlib.axis.XTick at 0x153cda1504a8>,
           <matplotlib.axis.XTick at 0x153cda150b38>,
           <matplotlib.axis.XTick at 0x153cd4f0b208>,
           <matplotlib.axis.XTick at 0x153cd4f0b898>,
           <matplotlib.axis.XTick at 0x153cd4f0bf28>,
           <matplotlib.axis.XTick at 0x153cd4d745f8>,
           <matplotlib.axis.XTick at 0x153cd4d74c88>,
           <matplotlib.axis.XTick at 0x153c8a4fa358>,
           <matplotlib.axis.XTick at 0x153c8a4fa9e8>,
           <matplotlib.axis.XTick at 0x153c7c9480b8>,
           <matplotlib.axis.XTick at 0x153c7c948748>,
           <matplotlib.axis.XTick at 0x153c7c948dd8>,
           <matplotlib.axis.XTick at 0x153c7c3ff4a8>,
           <matplotlib.axis.XTick at 0x153c7c3ffb38>,
           <matplotlib.axis.XTick at 0x153c7c7ec208>,
           <matplotlib.axis.XTick at 0x153c7c7ec898>,
           <matplotlib.axis.XTick at 0x153c7c7ecf28>,
           <matplotlib.axis.XTick at 0x153cdb7cc5f8>,
           <matplotlib.axis.XTick at 0x153cdb7ccc88>,
           <matplotlib.axis.XTick at 0x153c8a9cb358>,
           <matplotlib.axis.XTick at 0x153c8a9cb9e8>,
           <matplotlib.axis.XTick at 0x153c7e2be0b8>,
           <matplotlib.axis.XTick at 0x153c7e2be748>],
          <a list of 50 Text xticklabel objects>)
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_152_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{\texorpdfstring{Conclusions:}{Conclusions: }}\label{conclusions}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  For RF with Avg Word2Vec Representation got good cv score at
  n\_ectimators = 20 and depth = 25 with mean cv of 0.896263.

  \begin{itemize}
  \tightlist
  \item
    Train Score 0.997889533971442
  \item
    Test Score 0.8889438082946609
  \item
    Test Precision 0.8970036119448542
  \item
    Test Recall 0.9777092667346848
  \item
    Test ConfusionMatrix

    \begin{equation}
    \begin{bmatrix}
    & 8956 & 10123 &  \\
    & 2010 & 88162 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\item
  For XGBoost with Avg Word2Vec representation got best cv at no of
  estimators = 900, depth = 5, learning rate = 0.52 and subsample = 0.93
  with mean cv score of 0.939139.

  \begin{itemize}
  \tightlist
  \item
    Train Score 1.0
  \item
    Test Score 0.9303164273095899
  \item
    Test Precision 0.9402160582696143
  \item
    Test Recall 0.9777425364858271
  \item
    Test ConfusionMatrix

    \begin{equation}
    \begin{bmatrix}
    & 13473 & 5606 &  \\
    & 2007 & 88165 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\item
  For RF with Tf-Idf Word2Vec representation got best cv at at 56 and
  test cv is 0.884962.

  \begin{itemize}
  \tightlist
  \item
    Train Score 0.9796524399811706
  \item
    Test Score 0.8709485496700259
  \item
    Test Precision 0.8726985900036254
  \item
    Test Recall 0.9877234618285056
  \item
    Test ConfusionMatrix

    \begin{equation}
    \begin{bmatrix}
    & 6087 & 12992 &  \\
    & 1107 & 89065 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\item
  For XGBoost with Tf-Idf Word2Vec representation got best cv at
  n\_estimators = 884, depth = 4, subsample = 0.994481,
  colsample\_bylevel=0.791814, learning\_rate = 0.229976, reg\_alpha =
  0.998268, reg\_lambda = 0.150014 and Test\_score is 0.920558.

  \begin{itemize}
  \tightlist
  \item
    Train Score 0.9620547622783618
  \item
    Test Score 0.9055477753064045
  \item
    Test Precision 0.9101124749627652
  \item
    Test Recall 0.9826110100696447
  \item
    Test ConfusionMatrix

    \begin{equation}
    \begin{bmatrix}
    & 10328 & 8751 &  \\
    & 1568 & 88604 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\item
  For RF with Bag of Words representation got best cv at no of
  estimators = 28, depth = 483 and Test cv score is 0.891749.

  \begin{itemize}
  \tightlist
  \item
    Train Score 0.9995606464773262
  \item
    Test Score 0.8887058242029822
  \item
    Test Precision 0.8856493153393643
  \item
    Test Recall 0.9934236791908797
  \item
    Test ConfusionMatrix

    \begin{equation}
    \begin{bmatrix}
    & 7513 & 11566 &  \\
    & 593 & 89579 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\item
  For XGBoost with Bag of Words representation got best cv at
  n\_estimators = 1240, depth = 3, subsample = 0.660874,
  colsample\_bylevel=0.761028, learning\_rate = 0.259216, reg\_alpha =
  0.676561, reg\_lambda = 0.021376 and Test\_score is 0.937136.

  \begin{itemize}
  \tightlist
  \item
    Train Score 0.956825670798682
  \item
    Test Score 0.9375749421057931
  \item
    Test Precision 0.949588987896179
  \item
    Test Recall 0.9761899480991882
  \item
    Test ConfusionMatrix

    \begin{equation}
    \begin{bmatrix}
    & 14406 & 4673 &  \\
    & 2147 & 88025 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\item
  For RF with Tf-Idf vectorization got best cv at n\_estimators = 6 ,
  max dept and mean cv score is 0.883076.

  \begin{itemize}
  \tightlist
  \item
    Train Score 0.9927624352738114
  \item
    Test Score 0.8698043953831086
  \item
    Test Precision 0.8794440336537501
  \item
    Test Recall 0.9760568690946192
  \item
    Test ConfusionMatrix

    \begin{equation}
    \begin{bmatrix}
    & 7014 & 12065 &  \\
    & 2159 & 88013 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\item
  For XGBoost wit Tf-Idf vectorization got best cv at n\_estimators =
  759, max\_depth = 3,subample = 0.907128, colsample\_bylevel =
  0.859582, learning rate = 0.406806, reg\_alpha = 0.362060, reg\_lambda
  = 0.305770 and mean test cv is 0.944274.

  \begin{itemize}
  \tightlist
  \item
    Train Score 0.9708889063235525
  \item
    Test Score 0.9481926938883855
  \item
    Test Precision 0.9579801877181193
  \item
    Test Recall 0.9802266779044493
  \item
    Test ConfusionMatrix

    \begin{equation}
    \begin{bmatrix}
    & 15202 & 3877 &  \\
    & 1783 & 88389 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\end{enumerate}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
