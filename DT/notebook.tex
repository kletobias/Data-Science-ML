
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Decision Tree on Amazon food reviews data set}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \subsubsection{Decision Tree on Amazon food reviews data
set}\label{decision-tree-on-amazon-food-reviews-data-set}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{c+c1}{\PYZsh{}importing required Modules}
        \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
        \PY{k+kn}{import} \PY{n+nn}{sqlite3}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{nltk}
        \PY{k+kn}{import} \PY{n+nn}{string}
        \PY{k+kn}{import} \PY{n+nn}{pickle}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{TfidfTransformer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{TfidfVectorizer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{CountVectorizer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{confusion\PYZus{}matrix}
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{accuracy\PYZus{}score}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{roc\PYZus{}curve}\PY{p}{,} \PY{n}{auc}
        \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{stem}\PY{n+nn}{.}\PY{n+nn}{porter} \PY{k}{import} \PY{n}{PorterStemmer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{StandardScaler}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{TimeSeriesSplit}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{precision\PYZus{}score}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{recall\PYZus{}score}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{confusion\PYZus{}matrix}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{tree} \PY{k}{import} \PY{n}{DecisionTreeClassifier} \PY{k}{as} \PY{n}{DT}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{GridSearchCV}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{RandomizedSearchCV}
        \PY{k+kn}{import} \PY{n+nn}{warnings}
        \PY{n}{warnings}\PY{o}{.}\PY{n}{filterwarnings}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{c+c1}{\PYZsh{}getting cleaned data from db}
        \PY{n}{conn} \PY{o}{=} \PY{n}{sqlite3}\PY{o}{.}\PY{n}{connect}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}clean\PYZus{}LR.sqlite}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{final\PYZus{}review} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}sql\PYZus{}query}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{l+s+s2}{SELECT *}
        \PY{l+s+s2}{FROM Reviews\PYZus{}final}
        \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}\PY{p}{,} \PY{n}{conn}\PY{p}{)} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{c+c1}{\PYZsh{}SORT by time for TBS}
        \PY{n}{final\PYZus{}review} \PY{o}{=} \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{c+c1}{\PYZsh{}info of data}
        \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Int64Index: 364171 entries, 23 to 345187
Data columns (total 15 columns):
level\_0                   364171 non-null int64
index                     364171 non-null int64
Id                        364171 non-null int64
ProductId                 364171 non-null object
UserId                    364171 non-null object
ProfileName               364171 non-null object
HelpfulnessNumerator      364171 non-null int64
HelpfulnessDenominator    364171 non-null int64
Score                     364171 non-null object
Time                      364171 non-null int64
Summary                   364171 non-null object
Text                      364171 non-null object
CleanedTextBow            364171 non-null object
final\_text                364171 non-null object
final\_stem\_text           364171 non-null object
dtypes: int64(6), object(9)
memory usage: 44.5+ MB

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{c+c1}{\PYZsh{}changing lables to 1 or 0}
        \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{Score} \PY{o}{=} \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{Score}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:}
                             \PY{l+m+mi}{1} \PY{k}{if} \PY{n}{x} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{positive}\PY{l+s+s1}{\PYZsq{}} \PY{k}{else} \PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{c+c1}{\PYZsh{}Converting to int8}
        \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{HelpfulnessNumerator} \PY{o}{=} \PY{n}{final\PYZus{}review}\PY{o}{.}\PYZbs{}
                              \PY{n}{HelpfulnessNumerator}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{int8}\PY{p}{)}
        \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{HelpfulnessDenominator} \PY{o}{=} \PY{n}{final\PYZus{}review}\PY{o}{.}\PYZbs{}
                              \PY{n}{HelpfulnessDenominator}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{int8}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{c+c1}{\PYZsh{}Splitting Dataframe for train and test}
        \PY{n}{train\PYZus{}df} \PY{o}{=} \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n+nb}{round}\PY{p}{(}\PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{,}\PY{p}{:}\PY{p}{]}
        \PY{n}{test\PYZus{}df} \PY{o}{=} \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{train\PYZus{}df\PYZus{}dt.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
        \PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test\PYZus{}df\PYZus{}dt.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(254920, 15)
(109251, 15)

    \end{Verbatim}

    \paragraph{Word2Vec}\label{word2vec}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{c+c1}{\PYZsh{}importing}
        \PY{k+kn}{from} \PY{n+nn}{gensim}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Word2Vec}
        \PY{k+kn}{from} \PY{n+nn}{gensim}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{KeyedVectors}
        \PY{k+kn}{import} \PY{n+nn}{pickle}
        \PY{k+kn}{import} \PY{n+nn}{gensim}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{k+kn}{import} \PY{n+nn}{gensim}
         \PY{n}{list\PYZus{}of\PYZus{}sent}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{final\PYZus{}review}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{o}{.}\PY{n}{values}\PY{p}{:}
             \PY{n}{list\PYZus{}of\PYZus{}sent}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{c+c1}{\PYZsh{}word2vec model with 50 dim vector}
         \PY{n}{w2v\PYZus{}model\PYZus{}50}\PY{o}{=}\PY{n}{gensim}\PY{o}{.}\PY{n}{models}\PY{o}{.}\PY{n}{Word2Vec}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{,}\PY{n}{min\PYZus{}count}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{50}\PY{p}{,} \PY{n}{workers}\PY{o}{=}\PY{l+m+mi}{8}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}word2vec model with 100 dim vector}
         \PY{n}{w2v\PYZus{}model\PYZus{}100}\PY{o}{=}\PY{n}{gensim}\PY{o}{.}\PY{n}{models}\PY{o}{.}\PY{n}{Word2Vec}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{,}\PY{n}{min\PYZus{}count}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{workers}\PY{o}{=}\PY{l+m+mi}{8}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}word2vec model with 300 dim vector}
         \PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{o}{=}\PY{n}{gensim}\PY{o}{.}\PY{n}{models}\PY{o}{.}\PY{n}{Word2Vec}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{,}\PY{n}{min\PYZus{}count}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{,} \PY{n}{workers}\PY{o}{=}\PY{l+m+mi}{8}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{c+c1}{\PYZsh{}saving to disk}
         \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}50}\PY{p}{,}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w2v\PYZus{}model\PYZus{}dt\PYZus{}50.p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}100}\PY{p}{,}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w2v\PYZus{}model\PYZus{}dt\PYZus{}100.p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{,}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w2v\PYZus{}model\PYZus{}dt\PYZus{}300.p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{c+c1}{\PYZsh{}loading from disk}
         \PY{n}{w2v\PYZus{}model\PYZus{}100} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w2v\PYZus{}model\PYZus{}dt\PYZus{}100.p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{w2v\PYZus{}model\PYZus{}50} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w2v\PYZus{}model\PYZus{}dt\PYZus{}50.p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{w2v\PYZus{}model\PYZus{}300} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w2v\PYZus{}model\PYZus{}dt\PYZus{}300.p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \paragraph{Avg Word2Vec}\label{avg-word2vec}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{c+c1}{\PYZsh{} the avg\PYZhy{}w2v for each sentence/review is stored in this list}
         \PY{k}{def} \PY{n+nf}{avg\PYZus{}w2v}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{,}\PY{n}{model}\PY{p}{,}\PY{n}{d}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
         \PY{l+s+sd}{    Returns average of word vectors for }
         \PY{l+s+sd}{    each sentance with dimension of model given}
         \PY{l+s+sd}{    \PYZsq{}\PYZsq{}\PYZsq{}}
             \PY{n}{sent\PYZus{}vectors} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{:} \PY{c+c1}{\PYZsh{} for each review/sentence}
                 \PY{n}{doc} \PY{o}{=} \PY{p}{[}\PY{n}{word} \PY{k}{for} \PY{n}{word} \PY{o+ow}{in} \PY{n}{sent} \PY{k}{if} \PY{n}{word} \PY{o+ow}{in} \PY{n}{model}\PY{o}{.}\PY{n}{wv}\PY{o}{.}\PY{n}{vocab}\PY{p}{]}
                 \PY{k}{if} \PY{n}{doc}\PY{p}{:}
                     \PY{n}{sent\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{wv}\PY{p}{[}\PY{n}{doc}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{sent\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{d}\PY{p}{)}
                 \PY{n}{sent\PYZus{}vectors}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent\PYZus{}vec}\PY{p}{)}
             \PY{k}{return} \PY{n}{sent\PYZus{}vectors}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{o}{.}\PY{n}{values}\PY{p}{:}
             \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{c+c1}{\PYZsh{}avg word2vec for }
         \PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{avg\PYZus{}w2v}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{p}{,}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}stacking columns}
         \PY{n}{train\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}
                     \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{column} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}\PY{p}{)}
         \PY{n}{column}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{train\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{n}{column}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{c+c1}{\PYZsh{}CountVectorizer for BoW}
         \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{X\PYZus{}test\PYZus{}cv} \PY{o}{=} \PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n}{model} \PY{o}{=} \PY{n}{DT}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}train score}
         \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test score}
         \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Train Score 1.0
Test Score 0.8445786913541503

    \end{Verbatim}

    With max depth i got model which was so much overfit.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{]}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{DT}\PY{p}{(}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{n}{i}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Depth 1 Train Score 0.8600121046378696 Test Score 0.8293451540352529
Depth 2 Train Score 0.8687543430992356 Test Score 0.8472854228777655
Depth 3 Train Score 0.8734560982717267 Test Score 0.8435979915267535
Depth 4 Train Score 0.8796765371769295 Test Score 0.8608713844866364
Depth 5 Train Score 0.8846248683060232 Test Score 0.8601129766201161
Depth 6 Train Score 0.8893546434735827 Test Score 0.8662194675453737
Depth 7 Train Score 0.8938434466835534 Test Score 0.868612375124222
Depth 8 Train Score 0.9010501894151667 Test Score 0.8713452586432345
Depth 9 Train Score 0.909400147945574 Test Score 0.8704691667974267
Depth 10 Train Score 0.9212189818654591 Test Score 0.8698807469009886
Depth 11 Train Score 0.9341249915940015 Test Score 0.87024687483655
Depth 12 Train Score 0.947524153235749 Test Score 0.866664051467127

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{param\PYZus{}grid} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{,}\PY{l+m+mi}{13}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{17}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{,}\PY{l+m+mi}{23}\PY{p}{,}\PY{l+m+mi}{25}\PY{p}{,}
                                                   \PY{l+m+mi}{29}\PY{p}{,}\PY{l+m+mi}{35}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{,}\PY{l+m+mi}{70}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{]}\PY{p}{\PYZcb{}}
         \PY{n}{model\PYZus{}grid\PYZus{}avgw2v} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{DT}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,}
                                      \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}
                                                    \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}grid\PYZus{}avgw2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                                                \PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}grid\PYZus{}avgw2v}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}grid\PYZus{}avgw2v}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{depth}\PY{p}{,}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{Train\PYZus{}score}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{depth}\PY{p}{,}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{Test\PYZus{}score}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Validation curve for AvgW2V model with different max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}17}]:} <matplotlib.legend.Legend at 0x14e0df52be48>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_26_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{c+c1}{\PYZsh{}top scores}
         \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}18}]:}    depth  Test\_score  Test\_std  Train\_score
         4      8    0.879296  0.009600     0.913345
         5      9    0.879253  0.008580     0.923057
         3      7    0.878424  0.010808     0.905153
         6     11    0.874696  0.006940     0.946930
         2      5    0.873255  0.013776     0.893709
\end{Verbatim}
            
    From cross validation better depth is 8 with Test score of 0.879296.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{c+c1}{\PYZsh{}testscore}
         \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{o}{.}\PY{n}{values}\PY{p}{:}
             \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}avg word2vec for }
         \PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{avg\PYZus{}w2v}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}train}\PY{p}{,}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}stacking columns}
         \PY{n}{train\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}
                     \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{column} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}\PY{p}{)}
         \PY{n}{column}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{train\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{n}{column}\PY{p}{)}
         
         
         \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}test}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{o}{.}\PY{n}{values}\PY{p}{:}
             \PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}test}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}avg word2vec for }
         \PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300\PYZus{}test} \PY{o}{=} \PY{n}{avg\PYZus{}w2v}\PY{p}{(}\PY{n}{list\PYZus{}of\PYZus{}sent\PYZus{}test}\PY{p}{,}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}stacking columns}
         \PY{n}{test\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{sent\PYZus{}vector\PYZus{}avgw2v\PYZus{}300\PYZus{}test}\PY{p}{,}
                     \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{column} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{)}\PY{p}{)}
         \PY{n}{column}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{test\PYZus{}df\PYZus{}avgw2v\PYZus{}300} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{test\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{n}{column}\PY{p}{)}
         
         
         \PY{n}{model} \PY{o}{=} \PY{n}{DT}\PY{p}{(}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{l+m+mi}{8}\PY{p}{)}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Predicting training data}
         \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{train\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}predict test cv}
         \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{test\PYZus{}df\PYZus{}avgw2v\PYZus{}300}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}recall}
         \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}confusion matrix}
         \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
max\_depth 8
Train Score 0.8931115644123646
Test Score 0.8619692268262991
Test Precision 0.8777263581488933
Test Recall 0.9675509027192477
Test ConfusionMatrix [[ 6925 12154]
 [ 2926 87246]]

    \end{Verbatim}

    \paragraph{Tf-Idf Weighted Word2Vec}\label{tf-idf-weighted-word2vec}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{base} \PY{k}{import} \PY{n}{BaseEstimator}\PY{p}{,} \PY{n}{TransformerMixin}
         
         \PY{k}{class} \PY{n+nc}{TfidfWeightedWord2Vec}\PY{p}{(}\PY{n}{BaseEstimator}\PY{p}{,} \PY{n}{TransformerMixin}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
         \PY{l+s+sd}{    Class for Tfidf Weighted Word2Vec Calculations}
         \PY{l+s+sd}{    \PYZsq{}\PYZsq{}\PYZsq{}}
             \PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{word2vec}\PY{p}{)}\PY{p}{:}
                 \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{word2vec} \PY{o}{=} \PY{n}{word2vec}
                 \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{word2weight} \PY{o}{=} \PY{k+kc}{None}
                 \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dim} \PY{o}{=} \PY{n}{word2vec}\PY{o}{.}\PY{n}{vector\PYZus{}size}
                 \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tfidf} \PY{o}{=} \PY{k+kc}{None}
         
             \PY{k}{def} \PY{n+nf}{fit}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
                 \PY{n}{tfidf} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{p}{)}
                 \PY{n}{tfidf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tfidf} \PY{o}{=} \PY{n}{tfidf}
                 \PY{c+c1}{\PYZsh{}print(self.word2vec.wv.vocab.keys())}
                 \PY{k}{return} \PY{n+nb+bp}{self}
             
             \PY{k}{def} \PY{n+nf}{tf\PYZus{}idf\PYZus{}W2V}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,}\PY{n}{feature\PYZus{}names}\PY{p}{,}\PY{n}{tf\PYZus{}idf\PYZus{}trans\PYZus{}arr}\PY{p}{,}\PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{)}\PY{p}{:}
                 \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
         \PY{l+s+sd}{        tfidf weighted word2vec calculation}
         \PY{l+s+sd}{        \PYZsq{}\PYZsq{}\PYZsq{}}
                 \PY{k+kn}{import} \PY{n+nn}{operator}
                 \PY{n}{dict\PYZus{}tfidf} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{k}\PY{p}{:} \PY{n}{v} \PY{k}{for} \PY{n}{v}\PY{p}{,} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{)}\PY{p}{\PYZcb{}}
                 \PY{n}{sent\PYZus{}vectors} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                 \PY{n}{i} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{:} \PY{c+c1}{\PYZsh{} for each review/sentence}
                     \PY{n}{doc} \PY{o}{=} \PY{p}{[}\PY{n}{word} \PY{k}{for} \PY{n}{word} \PY{o+ow}{in} \PY{n}{sent} \PY{k}{if} \PY{n}{word} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{word2vec}\PY{o}{.}\PY{n}{wv}\PY{o}{.}\PY{n}{vocab}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{]}
                     \PY{k}{if} \PY{n}{doc}\PY{p}{:}
                         \PY{c+c1}{\PYZsh{}itemgetter}
                         \PY{n}{f} \PY{o}{=} \PY{n}{operator}\PY{o}{.}\PY{n}{itemgetter}\PY{p}{(}\PY{o}{*}\PY{n}{doc}\PY{p}{)}
                         \PY{k}{try}\PY{p}{:}
                             \PY{c+c1}{\PYZsh{}itemgetter from dict}
                             \PY{n}{final} \PY{o}{=} \PY{n}{f}\PY{p}{(}\PY{n}{dict\PYZus{}tfidf}\PY{p}{)}
                             \PY{n}{final} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}trans\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{n}{final}\PY{p}{]}
                             \PY{c+c1}{\PYZsh{}converting to dense}
                             \PY{n}{final} \PY{o}{=} \PY{n}{final}\PY{o}{.}\PY{n}{toarray}\PY{p}{(}\PY{p}{)}
                             \PY{c+c1}{\PYZsh{}converting to diagnol matrix for multiplication}
                             \PY{n}{final}\PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{diag}\PY{p}{(}\PY{n}{final}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                             \PY{n}{sent\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{final}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{word2vec}\PY{o}{.}\PY{n}{wv}\PY{p}{[}\PY{n}{doc}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                             \PY{c+c1}{\PYZsh{}tfidf weighted word to vec}
                             \PY{n}{sent\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{sent\PYZus{}vec}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)} \PY{o}{/} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{final}\PY{p}{)}
                         \PY{k}{except}\PY{p}{:}
                             \PY{n}{sent\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dim}\PY{p}{)}             
                     \PY{k}{else}\PY{p}{:}
                         \PY{n}{sent\PYZus{}vec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dim}\PY{p}{)}
                     \PY{n}{sent\PYZus{}vectors}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent\PYZus{}vec}\PY{p}{)}
                     \PY{n}{i} \PY{o}{=} \PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}
                 \PY{k}{return} \PY{n}{sent\PYZus{}vectors}
         
             \PY{k}{def} \PY{n+nf}{transform}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{X}\PY{p}{)}\PY{p}{:}
                 \PY{c+c1}{\PYZsh{}transform data}
                 \PY{n}{tf\PYZus{}idf\PYZus{}trans\PYZus{}arr} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tfidf}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                 \PY{n}{feature\PYZus{}names} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tfidf}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
                 \PY{n}{list\PYZus{}of\PYZus{}sent} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                 \PY{k}{for} \PY{n}{sent} \PY{o+ow}{in} \PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}
                     \PY{n}{list\PYZus{}of\PYZus{}sent}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sent}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
                 \PY{n}{temp\PYZus{}vec} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tf\PYZus{}idf\PYZus{}W2V}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{,}\PY{n}{tf\PYZus{}idf\PYZus{}trans\PYZus{}arr}\PY{p}{,}\PY{n}{list\PYZus{}of\PYZus{}sent}\PY{p}{)}
                 \PY{n}{temp\PYZus{}vec}\PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{temp\PYZus{}vec}\PY{p}{,}\PY{n}{X}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                 \PY{k}{return} \PY{n}{temp\PYZus{}vec}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{c+c1}{\PYZsh{} For simple cv}
         \PY{c+c1}{\PYZsh{}Train data}
         \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{X\PYZus{}test\PYZus{}cv} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}transforming to tfidf weighted word2vec}
         \PY{n}{tfidfvect\PYZus{}w2v} \PY{o}{=} \PY{n}{TfidfWeightedWord2Vec}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{)}
         \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{X\PYZus{}train\PYZus{}tfw2v} \PY{o}{=} \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{X\PYZus{}cv\PYZus{}tfw2v} \PY{o}{=} \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{]}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{DT}\PY{p}{(}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{n}{i}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}cv\PYZus{}tfw2v}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Depth 1 Train Score 0.8600121046378696 Test Score 0.8293451540352529
Depth 2 Train Score 0.8711360426800565 Test Score 0.8420288718029185
Depth 3 Train Score 0.8711360426800565 Test Score 0.8420288718029185
Depth 4 Train Score 0.8759330658357805 Test Score 0.848174590721272
Depth 5 Train Score 0.8803994530496962 Test Score 0.8514566661436268
Depth 6 Train Score 0.885218892201475 Test Score 0.8531565458444479
Depth 7 Train Score 0.8896068234291991 Test Score 0.8610936764475129
Depth 8 Train Score 0.8948017305148954 Test Score 0.8611590564360061
Depth 9 Train Score 0.9023391091883168 Test Score 0.8621920602541974
Depth 10 Train Score 0.9121461074622851 Test Score 0.8623620482242795
Depth 11 Train Score 0.9238192374078142 Test Score 0.8596945446937602
Depth 12 Train Score 0.9346349555042478 Test Score 0.857850829018254

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{param\PYZus{}grid} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{decisiontreeclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{,}
                                   \PY{l+m+mi}{13}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{17}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{,}\PY{l+m+mi}{23}\PY{p}{,}\PY{l+m+mi}{25}\PY{p}{,}\PY{l+m+mi}{29}\PY{p}{,}\PY{l+m+mi}{35}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{,}\PY{l+m+mi}{70}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{]}\PY{p}{\PYZcb{}}
         \PY{n}{model\PYZus{}grid\PYZus{}tfidfw2v} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}
                             \PY{n}{TfidfWeightedWord2Vec}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{)}\PY{p}{,}\PY{n}{DT}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                             \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,}
                             \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}
                                 \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}grid\PYZus{}tfidfw2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}grid\PYZus{}tfidfw2v}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{decisiontreeclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}grid\PYZus{}tfidfw2v}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{scores\PYZus{}df1}\PY{o}{.}\PY{n}{depth}\PY{p}{,}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{Train\PYZus{}score}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{scores\PYZus{}df1}\PY{o}{.}\PY{n}{depth}\PY{p}{,}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{Test\PYZus{}score}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Validation curve for Tf\PYZhy{}Idf\PYZhy{}W2V model with different max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}27}]:} <matplotlib.legend.Legend at 0x14e02ac89e48>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_36_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{c+c1}{\PYZsh{}top 5 scores}
         \PY{n}{scores\PYZus{}df1}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}29}]:}    depth  Test\_score  Test\_std  Train\_score
         5      9    0.872741  0.010143     0.916072
         4      8    0.872728  0.011507     0.907520
         3      7    0.872689  0.013214     0.900727
         6     11    0.869556  0.009616     0.936217
         2      5    0.866557  0.015469     0.889496
\end{Verbatim}
            
    From 10 fold cv we can observe that good depth is 9 with cv score of
0.872741.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{c+c1}{\PYZsh{}testscore}
         \PY{c+c1}{\PYZsh{}transforming to tfidf weighted word2vec}
         \PY{n}{tfidfvect\PYZus{}w2v} \PY{o}{=} \PY{n}{TfidfWeightedWord2Vec}\PY{p}{(}\PY{n}{w2v\PYZus{}model\PYZus{}300}\PY{p}{)}
         \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{X\PYZus{}train\PYZus{}tfw2v} \PY{o}{=} \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{X\PYZus{}cv\PYZus{}tfw2v} \PY{o}{=} \PY{n}{tfidfvect\PYZus{}w2v}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessNumerator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HelpfulnessDenominator}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
         
         \PY{n}{model} \PY{o}{=} \PY{n}{DT}\PY{p}{(}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{l+m+mi}{9}\PY{p}{)}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Predicting training data}
         \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}tfw2v}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}predict test cv}
         \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}cv\PYZus{}tfw2v}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}recall}
         \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}confusion matrix}
         \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Depth 9
Train Score 0.8931586380040797
Test Score 0.8538869209435154
Test Precision 0.8665547048653989
Test Recall 0.9727742536485827
Test ConfusionMatrix [[ 5571 13508]
 [ 2455 87717]]

    \end{Verbatim}

    \paragraph{Bag of Words:}\label{bag-of-words}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{c+c1}{\PYZsh{}BoW with cleaned data and without stopwords}
         \PY{c+c1}{\PYZsh{}simple cv for train data}
         \PY{n}{scores\PYZus{}train} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{corpus} \PY{k}{import} \PY{n}{stopwords}
         \PY{n}{stop} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{stopwords}\PY{o}{.}\PY{n}{words}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{not}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{very}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}CountVectorizer for BoW}
         \PY{n}{count\PYZus{}vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stop}\PY{p}{)}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{int8}\PY{p}{)}
         \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{X\PYZus{}test\PYZus{}cv} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{final\PYZus{}counts\PYZus{}train} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}
                 \PY{n}{X\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test}
         \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{,}\PY{l+m+mi}{13}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{17}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{]}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{DT}\PY{p}{(}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{n}{i}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Depth 1 Train Score 0.8600121046378696 Test Score 0.8293451540352529
Depth 3 Train Score 0.8621752482571563 Test Score 0.8318034416025942
Depth 5 Train Score 0.8667256954562776 Test Score 0.8381322244887285
Depth 7 Train Score 0.8699760148842214 Test Score 0.8407735760238506
Depth 9 Train Score 0.8807076729954495 Test Score 0.8607275485119514
Depth 11 Train Score 0.8883571316491449 Test Score 0.8659840995867985
Depth 13 Train Score 0.8967070901795521 Test Score 0.8666902034625242
Depth 15 Train Score 0.9028714890946179 Test Score 0.8681154872116742
Depth 17 Train Score 0.9085035081033825 Test Score 0.8693838589884408
Depth 19 Train Score 0.9145838470332429 Test Score 0.8715152466133166

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{p}{[}\PY{l+m+mi}{23}\PY{p}{,}\PY{l+m+mi}{25}\PY{p}{,}\PY{l+m+mi}{27}\PY{p}{,}\PY{l+m+mi}{35}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{,}\PY{l+m+mi}{45}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{,}\PY{l+m+mi}{70}\PY{p}{]}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{DT}\PY{p}{(}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{n}{i}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Depth 23 Train Score 0.9259935890251283 Test Score 0.876549505727287
Depth 25 Train Score 0.9308802761650714 Test Score 0.8764710497410952
Depth 27 Train Score 0.934982403443097 Test Score 0.8760656938124379
Depth 35 Train Score 0.9501524287731725 Test Score 0.8769548616559444
Depth 40 Train Score 0.9572863195176078 Test Score 0.8767456456927664
Depth 45 Train Score 0.9623075026338795 Test Score 0.8764187457503008
Depth 50 Train Score 0.9668187218399049 Test Score 0.8754772739159998
Depth 70 Train Score 0.9780827598574343 Test Score 0.8750980699827396

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{c+c1}{\PYZsh{}grid search}
         \PY{n}{param\PYZus{}grid} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{decisiontreeclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}
                               \PY{l+m+mi}{7}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{,}\PY{l+m+mi}{13}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{17}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{,}\PY{l+m+mi}{23}\PY{p}{,}\PY{l+m+mi}{35}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{,}\PY{l+m+mi}{70}\PY{p}{]}\PY{p}{\PYZcb{}}
         \PY{n}{model\PYZus{}grid\PYZus{}bow} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}
                     \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stop}\PY{p}{)}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{int8}\PY{p}{)}\PY{p}{,}
                                                           \PY{n}{DT}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                             \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,}
                                     \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}
                                                          \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}grid\PYZus{}bow} \PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{o}{.}\PY{n}{values}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}grid\PYZus{}bow}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{decisiontreeclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}grid\PYZus{}bow}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{depth}\PY{p}{,}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{Train\PYZus{}score}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{depth}\PY{p}{,}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{Test\PYZus{}score}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Validation curve for BoW model with different max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}56}]:} <matplotlib.legend.Legend at 0x14df4881ccc0>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_46_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}57}]:} \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}57}]:}     depth  Test\_score  Test\_std  Train\_score
         12     35    0.881535  0.007312     0.955675
         11     23    0.880539  0.007810     0.933671
         13     50    0.879348  0.007243     0.970945
         10     19    0.877954  0.009595     0.922455
         14     70    0.877250  0.007491     0.981497
         9      17    0.876733  0.010275     0.916729
         8      15    0.876517  0.010974     0.911208
         7      13    0.874536  0.011799     0.904508
         6      11    0.873721  0.010701     0.897472
         5       9    0.869086  0.012684     0.890258
         4       8    0.864641  0.015348     0.885937
         3       7    0.860680  0.017437     0.882900
         2       5    0.854971  0.019846     0.878509
         1       3    0.849357  0.020504     0.873588
         0       1    0.846880  0.020501     0.871226
\end{Verbatim}
            
    Depth with 23 to 35 might be better option for bag of words
representation of data. for better time complexity and for low variance
, maximum depth taken as 23 with mean cv of 0.880539

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{c+c1}{\PYZsh{}Test scores}
        \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{corpus} \PY{k}{import} \PY{n}{stopwords}
        \PY{n}{stop} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{stopwords}\PY{o}{.}\PY{n}{words}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
        \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{not}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{stop}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{very}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}CountVectorizer for BoW}
        \PY{n}{count\PYZus{}vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{stop\PYZus{}words}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stop}\PY{p}{)}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{int8}\PY{p}{)}
        \PY{n}{final\PYZus{}counts\PYZus{}train} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}
                \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}test}
        \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
        
        \PY{n}{model} \PY{o}{=} \PY{n}{DT}\PY{p}{(}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{l+m+mi}{23}\PY{p}{)}
        \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}Predicting training data}
        \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}Accuracy score}
        \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}predict test cv}
        \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}Accuracy score}
        \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}precision}
        \PY{c+c1}{\PYZsh{}precision}
        \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}recall}
        \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}confusion matrix}
        \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{23}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Depth 23
Train Score 0.9213243370469166
Test Score 0.8763672643728662
Test Precision 0.9049877972763098
Test Recall 0.9499401144479439
Test ConfusionMatrix [[10086  8993]
 [ 4514 85658]]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{k+kn}{import} \PY{n+nn}{operator}
         \PY{n}{importances} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{feature\PYZus{}importances\PYZus{}}
         \PY{n}{features} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
         \PY{n}{dict\PYZus{}feature} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n}{features}\PY{p}{,}\PY{n}{importances}\PY{p}{)}\PY{p}{)}
         \PY{n}{sorted\PYZus{}feature} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n}{dict\PYZus{}feature}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{key}\PY{o}{=}\PY{n}{operator}\PY{o}{.}\PY{n}{itemgetter}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{reverse}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{c+c1}{\PYZsh{}To 100 features to seperate the data using Bag of words with RF}
         \PY{n}{list\PYZus{}feature} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{sorted\PYZus{}feature}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{100}\PY{p}{]}
         \PY{n}{list\PYZus{}fval} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{sorted\PYZus{}feature}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{100}\PY{p}{]}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{list\PYZus{}feature}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
['not', 'great', 'best', 'disappointed', 'love', 'good', 'worst', 'delicious', 'awful', 'horrible', 'terrible', 'excellent', 'disappointing', 'money', 'favorite', 'bad', 'perfect', 'waste', 'tasty', 'nice', 'yuck', 'wont', 'wa', 'threw', 'disgusting', 'beware', 'find', 'wonderful', 'amazing', 'disappointment', 'thought', 'day', 'rip', 'unfortunately', 'yummy', 'misleading', 'stale', 'poor', 'awesome', 'sweet', 'very', 'product', 'refund', 'year', 'return', 'taste', 'nasty', 'little', 'make', 'store', 'like', 'tasted', 'didnt', 'keep', 'ever', 'bit', 'easy', 'would', 'flavor', 'worse', 'one', 'order', 'get', 'coffee', 'well', 'try', 'found', 'smooth', 'really', 'enjoy', 'even', 'however', 'use', 'time', 'company', 'opened', 'without', 'mediocre', 'never', 'food', 'way', 'review', 'gross', 'longer', 'work', 'cat', 'drink', 'price', 'bland', 'brand', 'changed', 'doe', 'quite', 'nothing', 'ordered', 'customer', 'since', 'buy', 'dog', 'much']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Feature importances for Bag of Words}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{list\PYZus{}feature}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{list\PYZus{}fval}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{,}
                \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{r}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{list\PYZus{}feature}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} 
                    \PY{n}{list\PYZus{}feature}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{,}\PY{n}{rotation} \PY{o}{=} \PY{l+m+mi}{90}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}12}]:} ([<matplotlib.axis.XTick at 0x154442851a20>,
           <matplotlib.axis.XTick at 0x154441e06470>,
           <matplotlib.axis.XTick at 0x154441dfb470>,
           <matplotlib.axis.XTick at 0x1544593d9e48>,
           <matplotlib.axis.XTick at 0x1544599e74e0>,
           <matplotlib.axis.XTick at 0x1544599e7b38>,
           <matplotlib.axis.XTick at 0x1544599b5208>,
           <matplotlib.axis.XTick at 0x1544599b5898>,
           <matplotlib.axis.XTick at 0x1544599b5f28>,
           <matplotlib.axis.XTick at 0x154458e815f8>,
           <matplotlib.axis.XTick at 0x154458e81c88>,
           <matplotlib.axis.XTick at 0x154459a2e358>,
           <matplotlib.axis.XTick at 0x154459a2e9e8>,
           <matplotlib.axis.XTick at 0x154459a160b8>,
           <matplotlib.axis.XTick at 0x154459a16748>,
           <matplotlib.axis.XTick at 0x154459a16dd8>,
           <matplotlib.axis.XTick at 0x1544594c44a8>,
           <matplotlib.axis.XTick at 0x1544594c4b38>,
           <matplotlib.axis.XTick at 0x154458fd0208>,
           <matplotlib.axis.XTick at 0x154458fd0898>,
           <matplotlib.axis.XTick at 0x154458fd0f28>,
           <matplotlib.axis.XTick at 0x154458fe75f8>,
           <matplotlib.axis.XTick at 0x154458fe7c88>,
           <matplotlib.axis.XTick at 0x154459ac9358>,
           <matplotlib.axis.XTick at 0x154459ac99e8>,
           <matplotlib.axis.XTick at 0x154459ac70b8>,
           <matplotlib.axis.XTick at 0x154459ac7748>,
           <matplotlib.axis.XTick at 0x154459ac7dd8>,
           <matplotlib.axis.XTick at 0x154458d0e4a8>,
           <matplotlib.axis.XTick at 0x154458d0eb38>,
           <matplotlib.axis.XTick at 0x154458bb9208>,
           <matplotlib.axis.XTick at 0x154458bb9898>,
           <matplotlib.axis.XTick at 0x154458bb9f28>,
           <matplotlib.axis.XTick at 0x154458be35f8>,
           <matplotlib.axis.XTick at 0x154458be3c88>,
           <matplotlib.axis.XTick at 0x1544589cb358>,
           <matplotlib.axis.XTick at 0x1544589cb9e8>,
           <matplotlib.axis.XTick at 0x15445880f0b8>,
           <matplotlib.axis.XTick at 0x15445880f748>,
           <matplotlib.axis.XTick at 0x15445880fdd8>,
           <matplotlib.axis.XTick at 0x1544588214a8>,
           <matplotlib.axis.XTick at 0x154441e123c8>,
           <matplotlib.axis.XTick at 0x1544588219e8>,
           <matplotlib.axis.XTick at 0x1544585c20b8>,
           <matplotlib.axis.XTick at 0x1544585c2748>,
           <matplotlib.axis.XTick at 0x1544585c2dd8>,
           <matplotlib.axis.XTick at 0x1544584784a8>,
           <matplotlib.axis.XTick at 0x154458478b38>,
           <matplotlib.axis.XTick at 0x15445849c208>,
           <matplotlib.axis.XTick at 0x15445849c898>],
          <a list of 50 Text xticklabel objects>)
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_52_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{Tf-Idf}\label{tf-idf}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}60}]:} \PY{c+c1}{\PYZsh{}TFIDF with (1,2) gram with cleaned data }
         \PY{c+c1}{\PYZsh{}simple cv for train data}
         \PY{c+c1}{\PYZsh{}tfidf vec }
         \PY{n}{tf\PYZus{}idf\PYZus{}vect} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         \PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{X\PYZus{}test\PYZus{}cv} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n+nb}{round}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.70}\PY{p}{)}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{final\PYZus{}counts\PYZus{}train} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}
                 \PY{n}{X\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test}
         \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}61}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{,}\PY{l+m+mi}{13}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{17}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{]}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{DT}\PY{p}{(}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{n}{i}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Depth 1 Train Score 0.8600121046378696 Test Score 0.8293451540352529
Depth 3 Train Score 0.8622481002443344 Test Score 0.8319342015795805
Depth 5 Train Score 0.868266795185044 Test Score 0.8390998483184267
Depth 7 Train Score 0.8752717939521643 Test Score 0.8560201893404467
Depth 9 Train Score 0.8867431799332003 Test Score 0.8646241958261416
Depth 11 Train Score 0.8949250184931967 Test Score 0.8700245828756734
Depth 13 Train Score 0.9030508170630562 Test Score 0.8715283226110152
Depth 15 Train Score 0.9088677680392728 Test Score 0.8721036665097547
Depth 17 Train Score 0.9153459908991056 Test Score 0.8743658141116167
Depth 19 Train Score 0.9211965658694045 Test Score 0.8762487577802186

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{p}{[}\PY{l+m+mi}{23}\PY{p}{,}\PY{l+m+mi}{25}\PY{p}{,}\PY{l+m+mi}{27}\PY{p}{,}\PY{l+m+mi}{35}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{,}\PY{l+m+mi}{45}\PY{p}{]}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{DT}\PY{p}{(}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{n}{i}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}train score}
             \PY{n}{train\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}test score}
             \PY{n}{test\PYZus{}score} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{X\PYZus{}test\PYZus{}cv}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{i}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Depth 23 Train Score 0.9326735558494542 Test Score 0.8789816412992312
Depth 25 Train Score 0.9371511510613975 Test Score 0.8800538731105183
Depth 27 Train Score 0.9402669745130124 Test Score 0.8804069250483811
Depth 35 Train Score 0.9523716123825963 Test Score 0.8829175166065171
Depth 40 Train Score 0.959421443141826 Test Score 0.8833228725351744
Depth 45 Train Score 0.9646275582255498 Test Score 0.8819368167791203

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{n}{param\PYZus{}grid} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{decisiontreeclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                          \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{,}\PY{l+m+mi}{13}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{17}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{,}\PY{l+m+mi}{23}\PY{p}{,}\PY{l+m+mi}{35}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{90}\PY{p}{]}\PY{p}{\PYZcb{}}
         \PY{n}{model\PYZus{}grid\PYZus{}tfidf} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{make\PYZus{}pipeline}\PY{p}{(}
                             \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{DT}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                             \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,}
                                         \PY{n}{cv}\PY{o}{=}\PY{n}{TimeSeriesSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}
                                                              \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{model\PYZus{}grid\PYZus{}tfidf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{final\PYZus{}text}\PY{o}{.}\PY{n}{values}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} \PY{n}{dict\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{idx} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{model\PYZus{}grid\PYZus{}tfidf}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{:}
             \PY{n}{dict\PYZus{}score} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{decisiontreeclassifier\PYZus{}\PYZus{}max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{dict\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}grid\PYZus{}tfidf}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)}
             \PY{n}{dict\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{dict\PYZus{}score}\PY{p}{)}
             \PY{n}{idx} \PY{o}{=} \PY{n}{idx} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{scores\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{dict\PYZus{}scores}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{depth}\PY{p}{,}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{Train\PYZus{}score}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{depth}\PY{p}{,}\PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{Test\PYZus{}score}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Validation curve for Tf\PYZhy{}Idf model with different max\PYZus{}depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}44}]:} <matplotlib.legend.Legend at 0x149213874710>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_59_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{n}{scores\PYZus{}df}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}46}]:}     depth  Test\_score  Test\_std  Train\_score
         12     40    0.884301  0.005215     0.966856
         11     35    0.884120  0.005923     0.960791
         10     23    0.883378  0.008458     0.939165
         9      19    0.881751  0.009670     0.929148
         13     60    0.881384  0.005097     0.981552
         8      17    0.880918  0.010221     0.923587
         7      15    0.879883  0.010582     0.917458
         14     90    0.878903  0.005205     0.990540
         6      13    0.878424  0.011582     0.911619
         5      11    0.876616  0.012583     0.905149
\end{Verbatim}
            
    Better scores is greater than 23 and 23 is good to choose with mean cv
of 0.883378

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{c+c1}{\PYZsh{}test scores}
         \PY{c+c1}{\PYZsh{}TFIDF with (1,2) gram with cleaned data }
         \PY{c+c1}{\PYZsh{}tfidf vec }
         \PY{n}{tf\PYZus{}idf\PYZus{}vect} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{ngram\PYZus{}range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         \PY{n}{final\PYZus{}counts\PYZus{}train} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}
                 \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}test}
         \PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{final\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
         \PY{n}{model} \PY{o}{=} \PY{n}{DT}\PY{p}{(}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{l+m+mi}{23}\PY{p}{,}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{25}\PY{p}{)}
         \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{,}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Predicting training data}
         \PY{n}{train\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{final\PYZus{}counts\PYZus{}train}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}train} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{train\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}predict test cv}
         \PY{n}{test\PYZus{}list} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}Accuracy score}
         \PY{n}{score\PYZus{}test} \PY{o}{=} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{c+c1}{\PYZsh{}precision}
         \PY{n}{test\PYZus{}precision} \PY{o}{=} \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}recall}
         \PY{n}{test\PYZus{}recall} \PY{o}{=} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}confusion matrix}
         \PY{n}{confusion\PYZus{}matrix\PYZus{}test} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{Score}\PY{p}{,}\PY{n}{test\PYZus{}list}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{depth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{23}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}train}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{score\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Precision}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}precision}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Recall}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{test\PYZus{}recall}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test ConfusionMatrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}matrix\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
depth 23
Train Score 0.926549505727287
Test Score 0.8802482357140896
Test Precision 0.9094772179197076
Test Recall 0.9494077984296677
Test ConfusionMatrix [[10558  8521]
 [ 4562 85610]]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{k+kn}{import} \PY{n+nn}{operator}
         \PY{n}{importances} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{feature\PYZus{}importances\PYZus{}}
         \PY{n}{features} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
         \PY{n}{dict\PYZus{}feature} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n}{features}\PY{p}{,}\PY{n}{importances}\PY{p}{)}\PY{p}{)}
         \PY{n}{sorted\PYZus{}feature} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n}{dict\PYZus{}feature}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{key}\PY{o}{=}\PY{n}{operator}\PY{o}{.}\PY{n}{itemgetter}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{reverse}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{c+c1}{\PYZsh{}To 100 features to seperate the data using Bag of words with RF}
         \PY{n}{list\PYZus{}feature} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{sorted\PYZus{}feature}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{100}\PY{p}{]}
         \PY{n}{list\PYZus{}fval} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{sorted\PYZus{}feature}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{100}\PY{p}{]}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{list\PYZus{}feature}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
['ovaltine', 'smartdogs', 'minuscule', 'ambivalence', 'everwhere', 'ob', 'wildeberryaki', 'untraceable', 'wrangling', 'benzyl', 'prima', 'domesticate', 'stroke', 'greediest', 'nawob', 'duetto', 'cloveaload', 'jaudie', 'withing', 'goldenflax', 'hagaman', 'williamsburg', 'ladygrey', 'undisturbed', 'craze', 'bilbo', 'disapproving', 'undercut', 'aa', 'aachen', 'aachener', 'aaf', 'aagghh', 'aah', 'aahhyaa', 'aahing', 'aahs', 'aammaazziinngg', 'aap', 'aardvark', 'aargh', 'aaron', 'aarp', 'aarrgh', 'aarrghh', 'aauw', 'ab', 'aback', 'abacus', 'abada', 'abalone', 'abamectin', 'abandon', 'abandoned', 'abandoning', 'abash', 'abated', 'abates', 'abattoir', 'abb', 'abba', 'abbas', 'abbazabba', 'abbey', 'abbie', 'abbondanza', 'abbot', 'abbott', 'abbreviated', 'abbreviating', 'abbreviation', 'abby', 'abc', 'abcstores', 'abd', 'abdomen', 'abdominal', 'abduct', 'abe', 'abel', 'aberdeen', 'aberfoyle', 'abernook', 'aberrant', 'aberration', 'abetter', 'abhor', 'abhorrent', 'abhors', 'abi', 'abid', 'abide', 'abiding', 'abietate', 'abigirl', 'ability', 'abipon', 'abit', 'abject', 'abjectly']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Feature importances}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{list\PYZus{}feature}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{list\PYZus{}fval}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{,}
                \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{r}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xticks}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{list\PYZus{}feature}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} 
                    \PY{n}{list\PYZus{}feature}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{,}\PY{n}{rotation} \PY{o}{=} \PY{l+m+mi}{90}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}16}]:} ([<matplotlib.axis.XTick at 0x1543f38bef98>,
           <matplotlib.axis.XTick at 0x1543f3b206a0>,
           <matplotlib.axis.XTick at 0x1543f3897940>,
           <matplotlib.axis.XTick at 0x15443f1552b0>,
           <matplotlib.axis.XTick at 0x15443f155940>,
           <matplotlib.axis.XTick at 0x15443f155fd0>,
           <matplotlib.axis.XTick at 0x15444a1cb6a0>,
           <matplotlib.axis.XTick at 0x15444a1cbd30>,
           <matplotlib.axis.XTick at 0x1543f25ca400>,
           <matplotlib.axis.XTick at 0x1543f25caa90>,
           <matplotlib.axis.XTick at 0x1543f2c34160>,
           <matplotlib.axis.XTick at 0x1543f2c347f0>,
           <matplotlib.axis.XTick at 0x1543f2c34e80>,
           <matplotlib.axis.XTick at 0x154441ac4550>,
           <matplotlib.axis.XTick at 0x154441ac4be0>,
           <matplotlib.axis.XTick at 0x15443e8ec2b0>,
           <matplotlib.axis.XTick at 0x15443e8ec940>,
           <matplotlib.axis.XTick at 0x15443e8ecfd0>,
           <matplotlib.axis.XTick at 0x1543ecf286a0>,
           <matplotlib.axis.XTick at 0x1543ecf28d30>,
           <matplotlib.axis.XTick at 0x15443b948400>,
           <matplotlib.axis.XTick at 0x15443b948a90>,
           <matplotlib.axis.XTick at 0x154440b96160>,
           <matplotlib.axis.XTick at 0x154440b967f0>,
           <matplotlib.axis.XTick at 0x154440b96e80>,
           <matplotlib.axis.XTick at 0x1543f0051550>,
           <matplotlib.axis.XTick at 0x1543f0051be0>,
           <matplotlib.axis.XTick at 0x1543ef0da2b0>,
           <matplotlib.axis.XTick at 0x1543ef0da940>,
           <matplotlib.axis.XTick at 0x1543ef0dafd0>,
           <matplotlib.axis.XTick at 0x1543f059d6a0>,
           <matplotlib.axis.XTick at 0x1543f059dd30>,
           <matplotlib.axis.XTick at 0x1543f20fa400>,
           <matplotlib.axis.XTick at 0x1543f20faa90>,
           <matplotlib.axis.XTick at 0x154456f3a160>,
           <matplotlib.axis.XTick at 0x154456f3a7f0>,
           <matplotlib.axis.XTick at 0x154456f3ae80>,
           <matplotlib.axis.XTick at 0x15444cf3b550>,
           <matplotlib.axis.XTick at 0x15444cf3bbe0>,
           <matplotlib.axis.XTick at 0x1544469ab2b0>,
           <matplotlib.axis.XTick at 0x1544469ab940>,
           <matplotlib.axis.XTick at 0x1544469abfd0>,
           <matplotlib.axis.XTick at 0x1543ecefb6a0>,
           <matplotlib.axis.XTick at 0x1543ecefbd30>,
           <matplotlib.axis.XTick at 0x1543f0ed8400>,
           <matplotlib.axis.XTick at 0x1543f0ed8a90>,
           <matplotlib.axis.XTick at 0x1543f267a160>,
           <matplotlib.axis.XTick at 0x1543f267a7f0>,
           <matplotlib.axis.XTick at 0x1543f267ae80>,
           <matplotlib.axis.XTick at 0x154441a01550>],
          <a list of 50 Text xticklabel objects>)
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_65_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{\texorpdfstring{Observations:}{Observations: }}\label{observations}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  For Avg Word2Vec representation of data got best cv at depth = 8 and
  mean cv score is 0.879296.

  \begin{itemize}
  \tightlist
  \item
    Train Score 0.8931115644123646
  \item
    Test Score 0.8619692268262991
  \item
    Test Precision 0.8777263581488933
  \item
    Test Recall 0.9675509027192477
  \item
    Test ConfusionMatrix

    \begin{equation}
    \begin{bmatrix}
    & 6925 & 12154 &  \\
    & 2926 & 87246 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\item
  For Tf-Idf Word2Vec representation got best cv at depth = 9 with cv
  score of 0.872741.

  \begin{itemize}
  \tightlist
  \item
    Train Score 0.8931586380040797
  \item
    Test Score 0.8538869209435154
  \item
    Test Precision 0.8665547048653989
  \item
    Test Recall 0.9727742536485827
  \item
    Test ConfusionMatrix

    \begin{equation}
    \begin{bmatrix}
    & 5571 & 13508 &  \\
    & 2455 & 87717 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\item
  For Bag of Words representation , got best cv at depth = 23 with mean
  cv score of 0.880539.

  \begin{itemize}
  \tightlist
  \item
    Train Score 0.9211909618703907
  \item
    Test Score 0.8762848852642081
  \item
    Test Precision 0.9049873203719357
  \item
    Test Recall 0.9498292152774698
  \item
    Test ConfusionMatrix

    \begin{equation}
    \begin{bmatrix}
    & 10087 & 8992 &  \\
    & 4524 & 85648 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\item
  For Tf-Idf with bi-gram representation, got best cv at depth = 23 is
  with mean cv score of 0.883378.

  \begin{itemize}
  \tightlist
  \item
    Train Score 0.926549505727287
  \item
    Test Score 0.8802482357140896
  \item
    Test Precision 0.9094772179197076
  \item
    Test Recall 0.9494077984296677
  \item
    Test ConfusionMatrix

    \begin{equation}
    \begin{bmatrix}
    & 10558 & 8521 &  \\
    & 4562 & 85610 & 
    \end{bmatrix}
    \end{equation}
  \end{itemize}
\end{enumerate}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
